<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>v8: test/cctest/test-debug.cc Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../v8-logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">v8
   &#160;<span id="projectnumber">3.14.5(node0.10.28)</span>
   </div>
   <div id="projectbrief">V8 is Google&#39;s open source JavaScript engine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dc/d8c/test-debug_8cc_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">test-debug.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dc/d8c/test-debug_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright 2012 the V8 project authors. All rights reserved.</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Redistribution and use in source and binary forms, with or without</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// modification, are permitted provided that the following conditions are</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// met:</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//     * Redistributions of source code must retain the above copyright</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//       notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//     * Redistributions in binary form must reproduce the above</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//       copyright notice, this list of conditions and the following</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//       disclaimer in the documentation and/or other materials provided</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//       with the distribution.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//     * Neither the name of Google Inc. nor the names of its</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//       contributors may be used to endorse or promote products derived</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//       from this software without specific prior written permission.</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#ifdef ENABLE_DEBUGGER_SUPPORT</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;v8.h&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d65/api_8h.html">api.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d84/cctest_8h.html">cctest.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/dea/compilation-cache_8h.html">compilation-cache.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d16/debug_8h.html">debug.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d23/deoptimizer_8h.html">deoptimizer.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d03/platform_8h.html">platform.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/db3/stub-cache_8h.html">stub-cache.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d60/utils_8h.html">utils.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;using ::v8::internal::EmbeddedVector;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a0ff83451bc94a1105976297cc6b68676">using ::v8::internal::Object</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;using ::v8::internal::OS;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;using ::v8::internal::Handle;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;using ::v8::internal::Heap;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;using ::v8::internal::JSGlobalProxy;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;using ::v8::internal::Code;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;using ::v8::internal::Debug;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;using ::v8::internal::Debugger;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;using ::v8::internal::CommandMessage;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;using ::v8::internal::CommandMessageQueue;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;using ::v8::internal::StepAction;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;using ::v8::internal::StepIn;  <span class="comment">// From StepAction enum</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;using ::v8::internal::StepNext;  <span class="comment">// From StepAction enum</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;using ::v8::internal::StepOut;  <span class="comment">// From StepAction enum</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;using ::v8::internal::Vector;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">using ::v8::internal::StrLength</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">// Size of temp buffer for formatting small strings.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#define SMALL_STRING_BUFFER_SIZE 80</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">// --- A d d i t i o n a l   C h e c k   H e l p e r s</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">// Helper function used by the CHECK_EQ function when given Address</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">// arguments.  Should not be called directly.</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/d29/checks_8cc.html#a464402344571c67b7ad8c54387535aab">CheckEqualsHelper</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* file, <span class="keywordtype">int</span> line,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">char</span>* expected_source,</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                     ::<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ac7f0eb0e10bc8bbb03c793ea1256e329">v8::internal::Address</a> expected,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">char</span>* value_source,</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                     ::<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ac7f0eb0e10bc8bbb03c793ea1256e329">v8::internal::Address</a> value) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">if</span> (expected != value) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="../../d8/d29/checks_8cc.html#af00312fd9717ee54d003136140753a32">V8_Fatal</a>(file, line, <span class="stringliteral">&quot;CHECK_EQ(%s, %s) failed\n#   &quot;</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                         <span class="stringliteral">&quot;Expected: %i\n#   Found: %i&quot;</span>,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;             expected_source, value_source, expected, value);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;}</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">// Helper function used by the CHECK_NE function when given Address</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">// arguments.  Should not be called directly.</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/d29/checks_8cc.html#ad384ae4907762693c3cffc9673d1f80a">CheckNonEqualsHelper</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* file, <span class="keywordtype">int</span> line,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">char</span>* unexpected_source,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                                        ::<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ac7f0eb0e10bc8bbb03c793ea1256e329">v8::internal::Address</a> unexpected,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">char</span>* value_source,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                        ::<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ac7f0eb0e10bc8bbb03c793ea1256e329">v8::internal::Address</a> value) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">if</span> (unexpected == value) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="../../d8/d29/checks_8cc.html#af00312fd9717ee54d003136140753a32">V8_Fatal</a>(file, line, <span class="stringliteral">&quot;CHECK_NE(%s, %s) failed\n#   Value: %i&quot;</span>,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;             unexpected_source, value_source, value);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;}</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">// Helper function used by the CHECK function when given code</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">// arguments.  Should not be called directly.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/d29/checks_8cc.html#a464402344571c67b7ad8c54387535aab">CheckEqualsHelper</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* file, <span class="keywordtype">int</span> line,</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">char</span>* expected_source,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                     <span class="keyword">const</span> Code* expected,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">char</span>* value_source,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                     <span class="keyword">const</span> Code* value) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">if</span> (expected != value) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="../../d8/d29/checks_8cc.html#af00312fd9717ee54d003136140753a32">V8_Fatal</a>(file, line, <span class="stringliteral">&quot;CHECK_EQ(%s, %s) failed\n#   &quot;</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                         <span class="stringliteral">&quot;Expected: %p\n#   Found: %p&quot;</span>,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;             expected_source, value_source, expected, value);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/d29/checks_8cc.html#ad384ae4907762693c3cffc9673d1f80a">CheckNonEqualsHelper</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* file, <span class="keywordtype">int</span> line,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">char</span>* expected_source,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                        <span class="keyword">const</span> Code* expected,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">char</span>* value_source,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                        <span class="keyword">const</span> Code* value) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span> (expected == value) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="../../d8/d29/checks_8cc.html#af00312fd9717ee54d003136140753a32">V8_Fatal</a>(file, line, <span class="stringliteral">&quot;CHECK_NE(%s, %s) failed\n#   Value: %p&quot;</span>,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;             expected_source, value_source, value);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">// --- H e l p e r   C l a s s e s</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">// Helper class for creating a V8 enviromnent for running tests</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keyword">class </span>DebugLocalContext {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keyword">inline</span> DebugLocalContext(</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <a class="code" href="../../d2/d03/classv8_1_1_extension_configuration.html">v8::ExtensionConfiguration</a>* extensions = 0,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::ObjectTemplate&gt;</a> global_template =</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::ObjectTemplate&gt;</a>(),</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> global_object = <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a>())</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      : context_(v8::Context::New(extensions, global_template, global_object)) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    context_-&gt;Enter();</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keyword">inline</span> ~DebugLocalContext() {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    context_-&gt;Exit();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    context_.Dispose();</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keyword">inline</span> <a class="code" href="../../df/d69/classv8_1_1_context.html">v8::Context</a>* operator-&gt;() { <span class="keywordflow">return</span> *context_; }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keyword">inline</span> <a class="code" href="../../df/d69/classv8_1_1_context.html">v8::Context</a>* operator*() { <span class="keywordflow">return</span> *context_; }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> IsReady() { <span class="keywordflow">return</span> !context_.IsEmpty(); }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordtype">void</span> ExposeDebug() {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    v8::internal::Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// Expose the debug context global object in the global object for testing.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    debug-&gt;Load();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    debug-&gt;debug_context()-&gt;set_security_token(</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        v8::Utils::OpenHandle(*context_)-&gt;security_token());</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    Handle&lt;JSGlobalProxy&gt; global(Handle&lt;JSGlobalProxy&gt;::cast(</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        v8::Utils::OpenHandle(*context_-&gt;Global())));</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    Handle&lt;v8::internal::String&gt; debug_string =</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="../../d8/d1e/isolate_8h.html#aedf6a97db5aec9c5da4cb045ac40c2df">FACTORY</a>-&gt;LookupAsciiSymbol(<span class="stringliteral">&quot;debug&quot;</span>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a7e9db74e121402bd5e9e584fa9225897">SetProperty</a>(global, debug_string,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        Handle&lt;Object&gt;(debug-&gt;debug_context()-&gt;global_proxy()), <a class="code" href="../../d5/d43/property-details_8h.html#ad8c75160526c9af7c8fa09418542c4e3a25edafa890b5af702b1c6a0b444da0b8">DONT_ENUM</a>,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        ::<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#afe0c8382c7538527acc84c987be6c595a301d3e92bcf2f8986b1eb28c9afeb54e">v8::internal::kNonStrictMode</a>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="../../d2/d78/classv8_1_1_persistent.html">v8::Persistent&lt;v8::Context&gt;</a> context_;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;};</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">// --- H e l p e r   F u n c t i o n s</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">// Compile and run the supplied source and return the fequested function.</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keyword">static</span> <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> CompileFunction(DebugLocalContext* env,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">char</span>* source,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">char</span>* function_name) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(source))-&gt;Run();</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      (*env)-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(function_name)));</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">// Compile and run the supplied source and return the requested function.</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keyword">static</span> <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> CompileFunction(<span class="keyword">const</span> <span class="keywordtype">char</span>* source,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">char</span>* function_name) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(source))-&gt;Run();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="../../df/d69/classv8_1_1_context.html#a9eb1408c458c49ea98d4e3a8f7617f0f">v8::Context::GetCurrent</a>()-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(function_name)));</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;}</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">// Is there any debug info for the function?</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> HasDebugInfo(<a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Function&gt;</a> fun) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  Handle&lt;v8::internal::JSFunction&gt; f = v8::Utils::OpenHandle(*fun);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  Handle&lt;v8::internal::SharedFunctionInfo&gt; shared(f-&gt;shared());</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordflow">return</span> Debug::HasDebugInfo(shared);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;}</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">// Set a break point in a function and return the associated break point</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">// number.</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> SetBreakPoint(Handle&lt;v8::internal::JSFunction&gt; fun, <span class="keywordtype">int</span> position) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> break_point = 0;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  v8::internal::Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  debug-&gt;SetBreakPoint(</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      fun,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      Handle&lt;Object&gt;(<a class="code" href="../../d8/dca/classv8_1_1internal_1_1_smi.html#a53259c85a9a7f54c354c7871cb340073">v8::internal::Smi::FromInt</a>(++break_point)),</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      &amp;position);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">return</span> break_point;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">// Set a break point in a function and return the associated break point</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">// number.</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> SetBreakPoint(<a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Function&gt;</a> fun, <span class="keywordtype">int</span> position) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordflow">return</span> SetBreakPoint(v8::Utils::OpenHandle(*fun), position);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;}</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">// Set a break point in a function using the Debug object and return the</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">// associated break point number.</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> SetBreakPointFromJS(<span class="keyword">const</span> <span class="keywordtype">char</span>* function_name,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                               <span class="keywordtype">int</span> line, <span class="keywordtype">int</span> position) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  EmbeddedVector&lt;char, SMALL_STRING_BUFFER_SIZE&gt; buffer;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  OS::SNPrintF(buffer,</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;               <span class="stringliteral">&quot;debug.Debug.setBreakPoint(%s,%d,%d)&quot;</span>,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;               function_name, line, position);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  buffer[<a class="code" href="../../de/dd6/test-deoptimization_8cc.html#a9b3c273aec2361d19e0449b2a7515e75">SMALL_STRING_BUFFER_SIZE</a> - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> str = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(buffer.start());</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(str)-&gt;Run()-&gt;Int32Value();</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">// Set a break point in a script identified by id using the global Debug object.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> SetScriptBreakPointByIdFromJS(<span class="keywordtype">int</span> script_id, <span class="keywordtype">int</span> line, <span class="keywordtype">int</span> column) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  EmbeddedVector&lt;char, SMALL_STRING_BUFFER_SIZE&gt; buffer;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">if</span> (column &gt;= 0) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// Column specified set script break point on precise location.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    OS::SNPrintF(buffer,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                 <span class="stringliteral">&quot;debug.Debug.setScriptBreakPointById(%d,%d,%d)&quot;</span>,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                 script_id, line, column);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">// Column not specified set script break point on line.</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    OS::SNPrintF(buffer,</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                 <span class="stringliteral">&quot;debug.Debug.setScriptBreakPointById(%d,%d)&quot;</span>,</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                 script_id, line);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  buffer[<a class="code" href="../../de/dd6/test-deoptimization_8cc.html#a9b3c273aec2361d19e0449b2a7515e75">SMALL_STRING_BUFFER_SIZE</a> - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="../../d4/dc6/classv8_1_1_try_catch.html">v8::TryCatch</a> try_catch;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> str = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(buffer.start());</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> value = <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(str)-&gt;Run();</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!try_catch.<a class="code" href="../../d4/dc6/classv8_1_1_try_catch.html#a68f455077e74f15d67c6cc1664dbc266">HasCaught</a>());</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">return</span> value-&gt;Int32Value();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;}</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">// Set a break point in a script identified by name using the global Debug</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">// object.</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> SetScriptBreakPointByNameFromJS(<span class="keyword">const</span> <span class="keywordtype">char</span>* script_name,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                           <span class="keywordtype">int</span> line, <span class="keywordtype">int</span> column) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  EmbeddedVector&lt;char, SMALL_STRING_BUFFER_SIZE&gt; buffer;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">if</span> (column &gt;= 0) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// Column specified set script break point on precise location.</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    OS::SNPrintF(buffer,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                 <span class="stringliteral">&quot;debug.Debug.setScriptBreakPointByName(\&quot;%s\&quot;,%d,%d)&quot;</span>,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                 script_name, line, column);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// Column not specified set script break point on line.</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    OS::SNPrintF(buffer,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                 <span class="stringliteral">&quot;debug.Debug.setScriptBreakPointByName(\&quot;%s\&quot;,%d)&quot;</span>,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                 script_name, line);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  buffer[<a class="code" href="../../de/dd6/test-deoptimization_8cc.html#a9b3c273aec2361d19e0449b2a7515e75">SMALL_STRING_BUFFER_SIZE</a> - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="../../d4/dc6/classv8_1_1_try_catch.html">v8::TryCatch</a> try_catch;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> str = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(buffer.start());</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> value = <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(str)-&gt;Run();</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!try_catch.<a class="code" href="../../d4/dc6/classv8_1_1_try_catch.html#a68f455077e74f15d67c6cc1664dbc266">HasCaught</a>());</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">return</span> value-&gt;Int32Value();</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;}</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">// Clear a break point.</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> ClearBreakPoint(<span class="keywordtype">int</span> break_point) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  v8::internal::Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  debug-&gt;ClearBreakPoint(</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      Handle&lt;Object&gt;(<a class="code" href="../../d8/dca/classv8_1_1internal_1_1_smi.html#a53259c85a9a7f54c354c7871cb340073">v8::internal::Smi::FromInt</a>(break_point)));</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;}</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">// Clear a break point using the global Debug object.</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> ClearBreakPointFromJS(<span class="keywordtype">int</span> break_point_number) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  EmbeddedVector&lt;char, SMALL_STRING_BUFFER_SIZE&gt; buffer;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  OS::SNPrintF(buffer,</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;               <span class="stringliteral">&quot;debug.Debug.clearBreakPoint(%d)&quot;</span>,</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;               break_point_number);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  buffer[<a class="code" href="../../de/dd6/test-deoptimization_8cc.html#a9b3c273aec2361d19e0449b2a7515e75">SMALL_STRING_BUFFER_SIZE</a> - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(buffer.start()))-&gt;Run();</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;}</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> EnableScriptBreakPointFromJS(<span class="keywordtype">int</span> break_point_number) {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  EmbeddedVector&lt;char, SMALL_STRING_BUFFER_SIZE&gt; buffer;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  OS::SNPrintF(buffer,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;               <span class="stringliteral">&quot;debug.Debug.enableScriptBreakPoint(%d)&quot;</span>,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;               break_point_number);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  buffer[<a class="code" href="../../de/dd6/test-deoptimization_8cc.html#a9b3c273aec2361d19e0449b2a7515e75">SMALL_STRING_BUFFER_SIZE</a> - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(buffer.start()))-&gt;Run();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;}</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DisableScriptBreakPointFromJS(<span class="keywordtype">int</span> break_point_number) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  EmbeddedVector&lt;char, SMALL_STRING_BUFFER_SIZE&gt; buffer;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  OS::SNPrintF(buffer,</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;               <span class="stringliteral">&quot;debug.Debug.disableScriptBreakPoint(%d)&quot;</span>,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;               break_point_number);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  buffer[<a class="code" href="../../de/dd6/test-deoptimization_8cc.html#a9b3c273aec2361d19e0449b2a7515e75">SMALL_STRING_BUFFER_SIZE</a> - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(buffer.start()))-&gt;Run();</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> ChangeScriptBreakPointConditionFromJS(<span class="keywordtype">int</span> break_point_number,</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">char</span>* condition) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  EmbeddedVector&lt;char, SMALL_STRING_BUFFER_SIZE&gt; buffer;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  OS::SNPrintF(buffer,</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;               <span class="stringliteral">&quot;debug.Debug.changeScriptBreakPointCondition(%d, \&quot;%s\&quot;)&quot;</span>,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;               break_point_number, condition);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  buffer[<a class="code" href="../../de/dd6/test-deoptimization_8cc.html#a9b3c273aec2361d19e0449b2a7515e75">SMALL_STRING_BUFFER_SIZE</a> - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(buffer.start()))-&gt;Run();</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;}</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> ChangeScriptBreakPointIgnoreCountFromJS(<span class="keywordtype">int</span> break_point_number,</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                                                    <span class="keywordtype">int</span> ignoreCount) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  EmbeddedVector&lt;char, SMALL_STRING_BUFFER_SIZE&gt; buffer;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  OS::SNPrintF(buffer,</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;               <span class="stringliteral">&quot;debug.Debug.changeScriptBreakPointIgnoreCount(%d, %d)&quot;</span>,</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;               break_point_number, ignoreCount);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  buffer[<a class="code" href="../../de/dd6/test-deoptimization_8cc.html#a9b3c273aec2361d19e0449b2a7515e75">SMALL_STRING_BUFFER_SIZE</a> - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(buffer.start()))-&gt;Run();</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;}</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">// Change break on exception.</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> ChangeBreakOnException(<span class="keywordtype">bool</span> caught, <span class="keywordtype">bool</span> uncaught) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  v8::internal::Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  debug-&gt;ChangeBreakOnException(v8::internal::BreakException, caught);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  debug-&gt;ChangeBreakOnException(v8::internal::BreakUncaughtException, uncaught);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">// Change break on exception using the global Debug object.</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> ChangeBreakOnExceptionFromJS(<span class="keywordtype">bool</span> caught, <span class="keywordtype">bool</span> uncaught) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordflow">if</span> (caught) {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;debug.Debug.setBreakOnException()&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;debug.Debug.clearBreakOnException()&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordflow">if</span> (uncaught) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;debug.Debug.setBreakOnUncaughtException()&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;debug.Debug.clearBreakOnUncaughtException()&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;}</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">// Prepare to step to next break location.</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> PrepareStep(StepAction step_action) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  v8::internal::Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  debug-&gt;PrepareStep(step_action, 1);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;}</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">// This function is in namespace v8::internal to be friend with class</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">// v8::internal::Debug.</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="keyword">namespace </span>v8 {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="keyword">namespace </span>internal {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">// Collect the currently debugged functions.</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;Handle&lt;FixedArray&gt; GetDebuggedFunctions() {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  Debug* debug = Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  v8::internal::DebugInfoListNode* node = debug-&gt;debug_info_list_;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">// Find the number of debugged functions.</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">while</span> (node) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    count++;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    node = node-&gt;next();</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">// Allocate array for the debugged functions</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  Handle&lt;FixedArray&gt; debugged_functions =</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <a class="code" href="../../d8/d1e/isolate_8h.html#aedf6a97db5aec9c5da4cb045ac40c2df">FACTORY</a>-&gt;NewFixedArray(count);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">// Run through the debug info objects and collect all functions.</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  count = 0;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keywordflow">while</span> (node) {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    debugged_functions-&gt;set(count++, *node-&gt;debug_info());</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    node = node-&gt;next();</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordflow">return</span> debugged_functions;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;}</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="keyword">static</span> Handle&lt;Code&gt; ComputeCallDebugBreak(<span class="keywordtype">int</span> argc) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordflow">return</span> Isolate::Current()-&gt;stub_cache()-&gt;ComputeCallDebugBreak(argc,</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                                                                 Code::CALL_IC);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;}</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">// Check that the debugger has been fully unloaded.</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="keywordtype">void</span> CheckDebuggerUnloaded(<span class="keywordtype">bool</span> check_functions) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="comment">// Check that the debugger context is cleared and that there is no debug</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">// information stored for the debugger.</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(Isolate::Current()-&gt;debug()-&gt;debug_context().is_null());</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, Isolate::Current()-&gt;debug()-&gt;debug_info_list_);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="comment">// Collect garbage to ensure weak handles are cleared.</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <a class="code" href="../../d8/d1e/isolate_8h.html#a4e8c3dc786eeec70c7c26763ea3d2ef7">HEAP</a>-&gt;CollectAllGarbage(<a class="code" href="../../dd/d58/classv8_1_1internal_1_1_heap.html#a2aed3c801bc981533015db78190333fa">Heap::kNoGCFlags</a>);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <a class="code" href="../../d8/d1e/isolate_8h.html#a4e8c3dc786eeec70c7c26763ea3d2ef7">HEAP</a>-&gt;CollectAllGarbage(<a class="code" href="../../dd/d58/classv8_1_1internal_1_1_heap.html#afbaa9137eb86d66f958fcc41a77c2fea">Heap::kMakeHeapIterableMask</a>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">// Iterate the head and check that there are no debugger related objects left.</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  HeapIterator iterator;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordflow">for</span> (HeapObject* obj = iterator.next(); obj != <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a49435ced13267a613e1d5ba777466b64">NULL</a>; obj = iterator.next()) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!obj-&gt;IsDebugInfo());</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!obj-&gt;IsBreakPointInfo());</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">// If deep check of functions is requested check that no debug break code</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">// is left in all functions.</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">if</span> (check_functions) {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keywordflow">if</span> (obj-&gt;IsJSFunction()) {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        JSFunction* fun = <a class="code" href="../../d0/d2c/classv8_1_1internal_1_1_j_s_function.html#aadcf8f00ff5f932119b67a97c33762da">JSFunction::cast</a>(obj);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">for</span> (RelocIterator it(fun-&gt;shared()-&gt;code()); !it.done(); it.next()) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;          RelocInfo::Mode rmode = it.rinfo()-&gt;rmode();</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;          <span class="keywordflow">if</span> (RelocInfo::IsCodeTarget(rmode)) {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!Debug::IsDebugBreak(it.rinfo()-&gt;target_address()));</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (RelocInfo::IsJSReturn(rmode)) {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!Debug::IsDebugBreakAtReturn(it.rinfo()));</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;          }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;}</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="keywordtype">void</span> ForceUnloadDebugger() {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  Isolate::Current()-&gt;debugger()-&gt;never_unload_debugger_ = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  Isolate::Current()-&gt;debugger()-&gt;UnloadDebugger();</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;}</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;} }  <span class="comment">// namespace v8::internal</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">// Check that the debugger has been fully unloaded.</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> CheckDebuggerUnloaded(<span class="keywordtype">bool</span> check_functions = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="comment">// Let debugger to unload itself synchronously</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a5aaf984433cde031c9e8b8a3da1ed699">v8::Debug::ProcessDebugMessages</a>();</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  v8::internal::CheckDebuggerUnloaded(check_functions);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;}</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">// Inherit from BreakLocationIterator to get access to protected parts for</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">// testing.</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="keyword">class </span>TestBreakLocationIterator: <span class="keyword">public</span> v8::internal::BreakLocationIterator {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keyword">explicit</span> TestBreakLocationIterator(Handle&lt;v8::internal::DebugInfo&gt; debug_info)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    : BreakLocationIterator(debug_info, v8::internal::SOURCE_BREAK_LOCATIONS) {}</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <a class="code" href="../../df/d0c/classv8_1_1internal_1_1_reloc_iterator.html">v8::internal::RelocIterator</a>* it() { <span class="keywordflow">return</span> reloc_iterator_; }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <a class="code" href="../../df/d0c/classv8_1_1internal_1_1_reloc_iterator.html">v8::internal::RelocIterator</a>* it_original() {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">return</span> reloc_iterator_original_;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;};</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">// Compile a function, set a break point and check that the call at the break</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">// location in the code is the expected debug_break function.</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="keywordtype">void</span> CheckDebugBreakFunction(DebugLocalContext* env,</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">char</span>* source, <span class="keyword">const</span> <span class="keywordtype">char</span>* name,</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                             <span class="keywordtype">int</span> position, v8::internal::RelocInfo::Mode mode,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                             Code* debug_break) {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  v8::internal::Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">// Create function and set the break point.</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  Handle&lt;v8::internal::JSFunction&gt; fun = v8::Utils::OpenHandle(</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      *CompileFunction(env, source, name));</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keywordtype">int</span> bp = SetBreakPoint(fun, position);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">// Check that the debug break function is as expected.</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  Handle&lt;v8::internal::SharedFunctionInfo&gt; shared(fun-&gt;shared());</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(Debug::HasDebugInfo(shared));</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  TestBreakLocationIterator it1(Debug::GetDebugInfo(shared));</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  it1.FindBreakLocationFromPosition(position);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  v8::internal::RelocInfo::Mode actual_mode = it1.it()-&gt;rinfo()-&gt;rmode();</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keywordflow">if</span> (actual_mode == v8::internal::RelocInfo::CODE_TARGET_WITH_ID) {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    actual_mode = v8::internal::RelocInfo::CODE_TARGET;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(mode, actual_mode);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordflow">if</span> (mode != v8::internal::RelocInfo::JS_RETURN) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(debug_break,</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        Code::GetCodeFromTargetAddress(it1.it()-&gt;rinfo()-&gt;target_address()));</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(Debug::IsDebugBreakAtReturn(it1.it()-&gt;rinfo()));</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="comment">// Clear the break point and check that the debug break function is no longer</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="comment">// there</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  ClearBreakPoint(bp);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!debug-&gt;HasDebugInfo(shared));</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(debug-&gt;EnsureDebugInfo(shared, fun));</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  TestBreakLocationIterator it2(Debug::GetDebugInfo(shared));</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  it2.FindBreakLocationFromPosition(position);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  actual_mode = it2.it()-&gt;rinfo()-&gt;rmode();</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keywordflow">if</span> (actual_mode == v8::internal::RelocInfo::CODE_TARGET_WITH_ID) {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    actual_mode = v8::internal::RelocInfo::CODE_TARGET;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(mode, actual_mode);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keywordflow">if</span> (mode == v8::internal::RelocInfo::JS_RETURN) {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!Debug::IsDebugBreakAtReturn(it2.it()-&gt;rinfo()));</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;}</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">// --- D e b u g   E v e n t   H a n d l e r s</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">// ---</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">// --- The different tests uses a number of debug event handlers.</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">// ---</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">// Source for the JavaScript function which picks out the function</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">// name of a frame.</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* frame_function_name_source =</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="stringliteral">&quot;function frame_function_name(exec_state, frame_number) {&quot;</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="stringliteral">&quot;  return exec_state.frame(frame_number).func().name();&quot;</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> frame_function_name;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">// Source for the JavaScript function which pick out the name of the</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">// first argument of a frame.</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* frame_argument_name_source =</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="stringliteral">&quot;function frame_argument_name(exec_state, frame_number) {&quot;</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="stringliteral">&quot;  return exec_state.frame(frame_number).argumentName(0);&quot;</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> frame_argument_name;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">// Source for the JavaScript function which pick out the value of the</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">// first argument of a frame.</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* frame_argument_value_source =</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="stringliteral">&quot;function frame_argument_value(exec_state, frame_number) {&quot;</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="stringliteral">&quot;  return exec_state.frame(frame_number).argumentValue(0).value_;&quot;</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> frame_argument_value;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">// Source for the JavaScript function which pick out the name of the</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">// first argument of a frame.</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* frame_local_name_source =</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="stringliteral">&quot;function frame_local_name(exec_state, frame_number) {&quot;</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="stringliteral">&quot;  return exec_state.frame(frame_number).localName(0);&quot;</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> frame_local_name;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">// Source for the JavaScript function which pick out the value of the</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">// first argument of a frame.</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* frame_local_value_source =</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="stringliteral">&quot;function frame_local_value(exec_state, frame_number) {&quot;</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="stringliteral">&quot;  return exec_state.frame(frame_number).localValue(0).value_;&quot;</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> frame_local_value;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">// Source for the JavaScript function which picks out the source line for the</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">// top frame.</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* frame_source_line_source =</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="stringliteral">&quot;function frame_source_line(exec_state) {&quot;</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="stringliteral">&quot;  return exec_state.frame(0).sourceLine();&quot;</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> frame_source_line;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">// Source for the JavaScript function which picks out the source column for the</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">// top frame.</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* frame_source_column_source =</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="stringliteral">&quot;function frame_source_column(exec_state) {&quot;</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="stringliteral">&quot;  return exec_state.frame(0).sourceColumn();&quot;</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> frame_source_column;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">// Source for the JavaScript function which picks out the script name for the</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">// top frame.</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* frame_script_name_source =</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="stringliteral">&quot;function frame_script_name(exec_state) {&quot;</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="stringliteral">&quot;  return exec_state.frame(0).func().script().name();&quot;</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> frame_script_name;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">// Source for the JavaScript function which picks out the script data for the</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">// top frame.</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* frame_script_data_source =</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="stringliteral">&quot;function frame_script_data(exec_state) {&quot;</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="stringliteral">&quot;  return exec_state.frame(0).func().script().data();&quot;</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> frame_script_data;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">// Source for the JavaScript function which picks out the script data from</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">// AfterCompile event</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* compiled_script_data_source =</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="stringliteral">&quot;function compiled_script_data(event_data) {&quot;</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="stringliteral">&quot;  return event_data.script().data();&quot;</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> compiled_script_data;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">// Source for the JavaScript function which returns the number of frames.</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* frame_count_source =</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="stringliteral">&quot;function frame_count(exec_state) {&quot;</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="stringliteral">&quot;  return exec_state.frameCount();&quot;</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Function&gt;</a> frame_count;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">// Global variable to store the last function hit - used by some tests.</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="keywordtype">char</span> last_function_hit[80];</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">// Global variable to store the name and data for last script hit - used by some</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">// tests.</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="keywordtype">char</span> last_script_name_hit[80];</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="keywordtype">char</span> last_script_data_hit[80];</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">// Global variables to store the last source position - used by some tests.</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="keywordtype">int</span> last_source_line = -1;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="keywordtype">int</span> last_source_column = -1;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">// Debug event handler which counts the break points which have been hit.</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="keywordtype">int</span> break_point_hit_count = 0;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="keywordtype">int</span> break_point_hit_count_deoptimize = 0;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventBreakPointHitCount(<a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                                         <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                         <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                                         <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="comment">// When hitting a debug event listener there must be a break set.</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a403854a78bdaff5e42e57b4126bd12f4">CHECK_NE</a>(debug-&gt;break_id(), 0);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="comment">// Count the number of breaks.</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="keywordflow">if</span> (event == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    break_point_hit_count++;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">if</span> (!frame_function_name.<a class="code" href="../../d3/dd5/classv8_1_1_handle.html#aaef62c8761ddd1b95824fc57b1b277b5">IsEmpty</a>()) {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="comment">// Get the name of the function.</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 2;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv[argc] = { exec_state, <a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(0) };</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result = frame_function_name-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(exec_state,</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                                                               argc, argv);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <span class="keywordflow">if</span> (result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a2858c3ff89ed8f4b756b94cbebcfe42f">IsUndefined</a>()) {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        last_function_hit[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#abfee0d12e50e0499ce0e3eac2612b3a2">IsString</a>());</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> function_name(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a91b68fb0b5558f1c9539015c1bbf7af2">ToString</a>());</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        function_name-&gt;WriteAscii(last_function_hit);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">if</span> (!frame_source_line.<a class="code" href="../../d3/dd5/classv8_1_1_handle.html#aaef62c8761ddd1b95824fc57b1b277b5">IsEmpty</a>()) {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <span class="comment">// Get the source line.</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv[argc] = { exec_state };</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result = frame_source_line-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(exec_state,</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                                                             argc, argv);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#aa9d220237cea3d96fe34448d6ec84847">IsNumber</a>());</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      last_source_line = result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a3837d763158f1718969858a513670c62">Int32Value</a>();</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">if</span> (!frame_source_column.<a class="code" href="../../d3/dd5/classv8_1_1_handle.html#aaef62c8761ddd1b95824fc57b1b277b5">IsEmpty</a>()) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <span class="comment">// Get the source column.</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv[argc] = { exec_state };</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result = frame_source_column-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(exec_state,</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                                                               argc, argv);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#aa9d220237cea3d96fe34448d6ec84847">IsNumber</a>());</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      last_source_column = result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a3837d763158f1718969858a513670c62">Int32Value</a>();</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">if</span> (!frame_script_name.<a class="code" href="../../d3/dd5/classv8_1_1_handle.html#aaef62c8761ddd1b95824fc57b1b277b5">IsEmpty</a>()) {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <span class="comment">// Get the script name of the function script.</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv[argc] = { exec_state };</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result = frame_script_name-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(exec_state,</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                                                             argc, argv);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="keywordflow">if</span> (result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a2858c3ff89ed8f4b756b94cbebcfe42f">IsUndefined</a>()) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        last_script_name_hit[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#abfee0d12e50e0499ce0e3eac2612b3a2">IsString</a>());</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> script_name(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a91b68fb0b5558f1c9539015c1bbf7af2">ToString</a>());</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        script_name-&gt;WriteAscii(last_script_name_hit);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">if</span> (!frame_script_data.<a class="code" href="../../d3/dd5/classv8_1_1_handle.html#aaef62c8761ddd1b95824fc57b1b277b5">IsEmpty</a>()) {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <span class="comment">// Get the script data of the function script.</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv[argc] = { exec_state };</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result = frame_script_data-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(exec_state,</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                                                             argc, argv);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <span class="keywordflow">if</span> (result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a2858c3ff89ed8f4b756b94cbebcfe42f">IsUndefined</a>()) {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        last_script_data_hit[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        result = result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a91b68fb0b5558f1c9539015c1bbf7af2">ToString</a>();</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#abfee0d12e50e0499ce0e3eac2612b3a2">IsString</a>());</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> script_data(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a91b68fb0b5558f1c9539015c1bbf7af2">ToString</a>());</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        script_data-&gt;WriteAscii(last_script_data_hit);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      }</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    }</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="comment">// Perform a full deoptimization when the specified number of</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">// breaks have been hit.</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordflow">if</span> (break_point_hit_count == break_point_hit_count_deoptimize) {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      <a class="code" href="../../dd/d9d/classv8_1_1internal_1_1_deoptimizer.html#aa7e0ee7bd6552a499e4d6421cabd8742">i::Deoptimizer::DeoptimizeAll</a>();</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79bace1d56bc37c286ed08718089a72b1419">v8::AfterCompile</a> &amp;&amp; !compiled_script_data.<a class="code" href="../../d3/dd5/classv8_1_1_handle.html#aaef62c8761ddd1b95824fc57b1b277b5">IsEmpty</a>()) {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv[argc] = { event_data };</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result = compiled_script_data-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(exec_state,</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                                                              argc, argv);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">if</span> (result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a2858c3ff89ed8f4b756b94cbebcfe42f">IsUndefined</a>()) {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      last_script_data_hit[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      result = result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a91b68fb0b5558f1c9539015c1bbf7af2">ToString</a>();</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#abfee0d12e50e0499ce0e3eac2612b3a2">IsString</a>());</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> script_data(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a91b68fb0b5558f1c9539015c1bbf7af2">ToString</a>());</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      script_data-&gt;WriteAscii(last_script_data_hit);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;}</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">// Debug event handler which counts a number of events and collects the stack</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">// height if there is a function compiled for that.</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="keywordtype">int</span> exception_hit_count = 0;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="keywordtype">int</span> uncaught_exception_hit_count = 0;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="keywordtype">int</span> last_js_stack_height = -1;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventCounterClear() {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  exception_hit_count = 0;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  uncaught_exception_hit_count = 0;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;}</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventCounter(<a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                              <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                              <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                              <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  v8::internal::Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="comment">// When hitting a debug event listener there must be a break set.</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a403854a78bdaff5e42e57b4126bd12f4">CHECK_NE</a>(debug-&gt;break_id(), 0);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="comment">// Count the number of breaks.</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <span class="keywordflow">if</span> (event == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    break_point_hit_count++;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event == <a class="code" href="../../da/d6a/classv8_1_1_exception.html">v8::Exception</a>) {</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    exception_hit_count++;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="comment">// Check whether the exception was uncaught.</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> fun_name = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;uncaught&quot;</span>);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> fun =</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <a class="code" href="../../d5/d54/classv8_1_1_function.html#a2e69da7035a0d06c61e94dbefe1e866b">v8::Function::Cast</a>(*event_data-&gt;<a class="code" href="../../db/d85/classv8_1_1_object.html#a15d9f2b57d7fc06e12259c976c7d66fc">Get</a>(fun_name));</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Value&gt;</a> result = *fun-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(event_data, 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">if</span> (result-&gt;IsTrue()) {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      uncaught_exception_hit_count++;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    }</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="comment">// Collect the JavsScript stack height if the function frame_count is</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <span class="comment">// compiled.</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="keywordflow">if</span> (!frame_count.<a class="code" href="../../d3/dd5/classv8_1_1_handle.html#aaef62c8761ddd1b95824fc57b1b277b5">IsEmpty</a>()) {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kArgc = 1;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv[kArgc] = { exec_state };</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="comment">// Using exec_state as receiver is just to have a receiver.</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result =  frame_count-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(exec_state, kArgc, argv);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    last_js_stack_height = result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a3837d763158f1718969858a513670c62">Int32Value</a>();</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;}</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">// Debug event handler which evaluates a number of expressions when a break</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">// point is hit. Each evaluated expression is compared with an expected value.</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">// For this debug event handler to work the following two global varaibles</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">// must be initialized.</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">//   checks: An array of expressions and expected results</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">//   evaluate_check_function: A JavaScript function (see below)</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">// Structure for holding checks to do.</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="keyword">struct </span>EvaluateCheck {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* expr;  <span class="comment">// An expression to evaluate when a break point is hit.</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> expected;  <span class="comment">// The expected result.</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;};</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">// Array of checks to do.</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="keyword">struct </span>EvaluateCheck* checks = <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">// Source for The JavaScript function which can do the evaluation when a break</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">// point is hit.</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* evaluate_check_source =</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="stringliteral">&quot;function evaluate_check(exec_state, expr, expected) {&quot;</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="stringliteral">&quot;  return exec_state.frame(0).evaluate(expr).value() === expected;&quot;</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> evaluate_check_function;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">// The actual debug event described by the longer comment above.</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventEvaluate(<a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                               <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                               <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                               <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  v8::internal::Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <span class="comment">// When hitting a debug event listener there must be a break set.</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a403854a78bdaff5e42e57b4126bd12f4">CHECK_NE</a>(debug-&gt;break_id(), 0);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="keywordflow">if</span> (event == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; checks[i].expr != <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>; i++) {</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 3;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv[argc] = { exec_state,</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                                           <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(checks[i].expr),</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                                           checks[i].expected };</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result =</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;          evaluate_check_function-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(exec_state, argc, argv);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <span class="keywordflow">if</span> (!result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a3d46ba6a258e0029819606fe47d50c24">IsTrue</a>()) {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <a class="code" href="../../d8/dcb/classv8_1_1_string_1_1_ascii_value.html">v8::String::AsciiValue</a> ascii(checks[i].expected-&gt;ToString());</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <a class="code" href="../../d8/d29/checks_8cc.html#af00312fd9717ee54d003136140753a32">V8_Fatal</a>(__FILE__, __LINE__, <span class="stringliteral">&quot;%s != %s&quot;</span>, checks[i].expr, *ascii);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;}</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">// This debug event listener removes a breakpoint in a function</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="keywordtype">int</span> debug_event_remove_break_point = 0;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventRemoveBreakPoint(<a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                                       <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                                       <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                                       <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  v8::internal::Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="comment">// When hitting a debug event listener there must be a break set.</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a403854a78bdaff5e42e57b4126bd12f4">CHECK_NE</a>(debug-&gt;break_id(), 0);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="keywordflow">if</span> (event == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    break_point_hit_count++;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(data-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a1510d19d3b776197459ac9da4a0ae64f">IsFunction</a>());</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    ClearBreakPoint(debug_event_remove_break_point);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;}</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">// Debug event handler which counts break points hit and performs a step</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">// afterwards.</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;StepAction step_action = StepIn;  <span class="comment">// Step action to perform when stepping.</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventStep(<a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                           <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                           <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                           <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  v8::internal::Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="comment">// When hitting a debug event listener there must be a break set.</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a403854a78bdaff5e42e57b4126bd12f4">CHECK_NE</a>(debug-&gt;break_id(), 0);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="keywordflow">if</span> (event == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    break_point_hit_count++;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    PrepareStep(step_action);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;}</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">// Debug event handler which counts break points hit and performs a step</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">// afterwards. For each call the expected function is checked.</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">// For this debug event handler to work the following two global varaibles</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">// must be initialized.</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">//   expected_step_sequence: An array of the expected function call sequence.</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">//   frame_function_name: A JavaScript function (see below).</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">// String containing the expected function call sequence. Note: this only works</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">// if functions have name length of one.</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* expected_step_sequence = <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">// The actual debug event described by the longer comment above.</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventStepSequence(<a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                                   <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                                   <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                                   <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  v8::internal::Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="comment">// When hitting a debug event listener there must be a break set.</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a403854a78bdaff5e42e57b4126bd12f4">CHECK_NE</a>(debug-&gt;break_id(), 0);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="keywordflow">if</span> (event == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a> || event == <a class="code" href="../../da/d6a/classv8_1_1_exception.html">v8::Exception</a>) {</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="comment">// Check that the current function is the expected.</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(break_point_hit_count &lt;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;          <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(expected_step_sequence));</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 2;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv[argc] = { exec_state, <a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(0) };</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result = frame_function_name-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(exec_state,</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                                                             argc, argv);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#abfee0d12e50e0499ce0e3eac2612b3a2">IsString</a>());</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <a class="code" href="../../d8/dcb/classv8_1_1_string_1_1_ascii_value.html">v8::String::AsciiValue</a> function_name(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a91b68fb0b5558f1c9539015c1bbf7af2">ToString</a>());</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(*function_name));</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>((*function_name)[0],</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;              expected_step_sequence[break_point_hit_count]);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="comment">// Perform step.</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    break_point_hit_count++;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    PrepareStep(step_action);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;}</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment">// Debug event handler which performs a garbage collection.</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventBreakPointCollectGarbage(</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  v8::internal::Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="comment">// When hitting a debug event listener there must be a break set.</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a403854a78bdaff5e42e57b4126bd12f4">CHECK_NE</a>(debug-&gt;break_id(), 0);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="comment">// Perform a garbage collection when break point is hit and continue. Based</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="comment">// on the number of break points hit either scavenge or mark compact</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="comment">// collector is used.</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="keywordflow">if</span> (event == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    break_point_hit_count++;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">if</span> (break_point_hit_count % 2 == 0) {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      <span class="comment">// Scavenge.</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      <a class="code" href="../../d8/d1e/isolate_8h.html#a4e8c3dc786eeec70c7c26763ea3d2ef7">HEAP</a>-&gt;CollectGarbage(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a5e2ec2be00b3d617582f927ee37878f7a55bf024372af033e86eeb191711b47ca">v8::internal::NEW_SPACE</a>);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <span class="comment">// Mark sweep compact.</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      <a class="code" href="../../d8/d1e/isolate_8h.html#a4e8c3dc786eeec70c7c26763ea3d2ef7">HEAP</a>-&gt;CollectAllGarbage(Heap::kNoGCFlags);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    }</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;}</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">// Debug event handler which re-issues a debug break and calls the garbage</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">// collector to have the heap verified.</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventBreak(<a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                            <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                            <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                            <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  v8::internal::Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="comment">// When hitting a debug event listener there must be a break set.</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a403854a78bdaff5e42e57b4126bd12f4">CHECK_NE</a>(debug-&gt;break_id(), 0);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="keywordflow">if</span> (event == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="comment">// Count the number of breaks.</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    break_point_hit_count++;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="comment">// Run the garbage collector to enforce heap verification if option</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="comment">// --verify-heap is set.</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <a class="code" href="../../d8/d1e/isolate_8h.html#a4e8c3dc786eeec70c7c26763ea3d2ef7">HEAP</a>-&gt;CollectGarbage(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a5e2ec2be00b3d617582f927ee37878f7a55bf024372af033e86eeb191711b47ca">v8::internal::NEW_SPACE</a>);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="comment">// Set the break flag again to come back here as soon as possible.</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  }</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;}</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">// Debug event handler which re-issues a debug break until a limit has been</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">// reached.</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="keywordtype">int</span> max_break_point_hit_count = 0;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="keywordtype">bool</span> terminate_after_max_break_point_hit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventBreakMax(<a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                               <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                               <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                               <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  v8::internal::Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="comment">// When hitting a debug event listener there must be a break set.</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a403854a78bdaff5e42e57b4126bd12f4">CHECK_NE</a>(debug-&gt;break_id(), 0);</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <span class="keywordflow">if</span> (event == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordflow">if</span> (break_point_hit_count &lt; max_break_point_hit_count) {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="comment">// Count the number of breaks.</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      break_point_hit_count++;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      <span class="comment">// Collect the JavsScript stack height if the function frame_count is</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      <span class="comment">// compiled.</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      <span class="keywordflow">if</span> (!frame_count.<a class="code" href="../../d3/dd5/classv8_1_1_handle.html#aaef62c8761ddd1b95824fc57b1b277b5">IsEmpty</a>()) {</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kArgc = 1;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv[kArgc] = { exec_state };</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <span class="comment">// Using exec_state as receiver is just to have a receiver.</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result =</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            frame_count-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(exec_state, kArgc, argv);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        last_js_stack_height = result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a3837d763158f1718969858a513670c62">Int32Value</a>();</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      }</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      <span class="comment">// Set the break flag again to come back here as soon as possible.</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (terminate_after_max_break_point_hit) {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <span class="comment">// Terminate execution after the last break if requested.</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <a class="code" href="../../df/d43/classv8_1_1_v8.html#ae438202e4c169f7e80162bba1e14f83e">v8::V8::TerminateExecution</a>();</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="comment">// Perform a full deoptimization when the specified number of</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="comment">// breaks have been hit.</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="keywordflow">if</span> (break_point_hit_count == break_point_hit_count_deoptimize) {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <a class="code" href="../../dd/d9d/classv8_1_1internal_1_1_deoptimizer.html#aa7e0ee7bd6552a499e4d6421cabd8742">i::Deoptimizer::DeoptimizeAll</a>();</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    }</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  }</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;}</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">// --- M e s s a g e   C a l l b a c k</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">// Message callback which counts the number of messages.</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="keywordtype">int</span> message_callback_count = 0;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> MessageCallbackCountClear() {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  message_callback_count = 0;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;}</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> MessageCallbackCount(<a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Message&gt;</a> <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a52143ab7f8a8ac8ea0cdbe70d282c73a">message</a>,</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                                 <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  message_callback_count++;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;}</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">// --- T h e   A c t u a l   T e s t s</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">// Test that the debug break function is the expected one for different kinds</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">// of break locations.</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStub) {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  using ::v8::internal::Builtins;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  using ::v8::internal::Isolate;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  CheckDebugBreakFunction(&amp;env,</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                          <span class="stringliteral">&quot;function f1(){}&quot;</span>, <span class="stringliteral">&quot;f1&quot;</span>,</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                          0,</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                          v8::internal::RelocInfo::JS_RETURN,</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                          <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  CheckDebugBreakFunction(&amp;env,</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                          <span class="stringliteral">&quot;function f2(){x=1;}&quot;</span>, <span class="stringliteral">&quot;f2&quot;</span>,</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                          0,</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                          v8::internal::RelocInfo::CODE_TARGET_CONTEXT,</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                          Isolate::Current()-&gt;builtins()-&gt;builtin(</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                              Builtins::kStoreIC_DebugBreak));</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  CheckDebugBreakFunction(&amp;env,</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                          <span class="stringliteral">&quot;function f3(){var a=x;}&quot;</span>, <span class="stringliteral">&quot;f3&quot;</span>,</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                          0,</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                          v8::internal::RelocInfo::CODE_TARGET_CONTEXT,</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                          Isolate::Current()-&gt;builtins()-&gt;builtin(</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                              Builtins::kLoadIC_DebugBreak));</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">// TODO(1240753): Make the test architecture independent or split</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">// parts of the debugger into architecture dependent files. This</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">// part currently disabled as it is not portable between IA32/ARM.</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">// Currently on ICs for keyed store/load on ARM.</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="preprocessor">#if !defined (__arm__) &amp;&amp; !defined(__thumb__)</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  CheckDebugBreakFunction(</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      &amp;env,</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      <span class="stringliteral">&quot;function f4(){var index=&#39;propertyName&#39;; var a={}; a[index] = &#39;x&#39;;}&quot;</span>,</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <span class="stringliteral">&quot;f4&quot;</span>,</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      0,</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      v8::internal::RelocInfo::CODE_TARGET,</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      Isolate::Current()-&gt;builtins()-&gt;builtin(</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;          Builtins::kKeyedStoreIC_DebugBreak));</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  CheckDebugBreakFunction(</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      &amp;env,</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      <span class="stringliteral">&quot;function f5(){var index=&#39;propertyName&#39;; var a={}; return a[index];}&quot;</span>,</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      <span class="stringliteral">&quot;f5&quot;</span>,</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      0,</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      v8::internal::RelocInfo::CODE_TARGET,</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      Isolate::Current()-&gt;builtins()-&gt;builtin(</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;          Builtins::kKeyedLoadIC_DebugBreak));</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="comment">// Check the debug break code stubs for call ICs with different number of</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="comment">// parameters.</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  Handle&lt;Code&gt; debug_break_0 = v8::internal::ComputeCallDebugBreak(0);</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  Handle&lt;Code&gt; debug_break_1 = v8::internal::ComputeCallDebugBreak(1);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  Handle&lt;Code&gt; debug_break_4 = v8::internal::ComputeCallDebugBreak(4);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  CheckDebugBreakFunction(&amp;env,</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                          <span class="stringliteral">&quot;function f4_0(){x();}&quot;</span>, <span class="stringliteral">&quot;f4_0&quot;</span>,</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                          0,</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                          v8::internal::RelocInfo::CODE_TARGET_CONTEXT,</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                          *debug_break_0);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  CheckDebugBreakFunction(&amp;env,</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                          <span class="stringliteral">&quot;function f4_1(){x(1);}&quot;</span>, <span class="stringliteral">&quot;f4_1&quot;</span>,</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                          0,</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                          v8::internal::RelocInfo::CODE_TARGET_CONTEXT,</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                          *debug_break_1);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  CheckDebugBreakFunction(&amp;env,</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                          <span class="stringliteral">&quot;function f4_4(){x(1,2,3,4);}&quot;</span>, <span class="stringliteral">&quot;f4_4&quot;</span>,</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                          0,</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                          v8::internal::RelocInfo::CODE_TARGET_CONTEXT,</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                          *debug_break_4);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;}</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">// Test that the debug info in the VM is in sync with the functions being</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">// debugged.</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugInfo) {</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <span class="comment">// Create a couple of functions for the test.</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> <a class="code" href="../../d6/df1/test-accessors_8cc.html#a819b717d29c6c488a332fefeeb3815ba">foo</a> =</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      CompileFunction(&amp;env, <span class="stringliteral">&quot;function foo(){}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> <a class="code" href="../../d6/df1/test-accessors_8cc.html#a2df8914184cddeed49ac0b633472d973">bar</a> =</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      CompileFunction(&amp;env, <span class="stringliteral">&quot;function bar(){}&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  <span class="comment">// Initially no functions are debugged.</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, v8::internal::GetDebuggedFunctions()-&gt;length());</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!HasDebugInfo(foo));</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!HasDebugInfo(bar));</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <span class="comment">// One function (foo) is debugged.</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="keywordtype">int</span> bp1 = SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, v8::internal::GetDebuggedFunctions()-&gt;length());</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(HasDebugInfo(foo));</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!HasDebugInfo(bar));</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="comment">// Two functions are debugged.</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="keywordtype">int</span> bp2 = SetBreakPoint(bar, 0);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, v8::internal::GetDebuggedFunctions()-&gt;length());</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(HasDebugInfo(foo));</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(HasDebugInfo(bar));</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <span class="comment">// One function (bar) is debugged.</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  ClearBreakPoint(bp1);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, v8::internal::GetDebuggedFunctions()-&gt;length());</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!HasDebugInfo(foo));</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(HasDebugInfo(bar));</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <span class="comment">// No functions are debugged.</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  ClearBreakPoint(bp2);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, v8::internal::GetDebuggedFunctions()-&gt;length());</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!HasDebugInfo(foo));</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!HasDebugInfo(bar));</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;}</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment">// Test that a break point can be set at an IC store location.</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(BreakPointICStore) {</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;function foo(){bar=0;}&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo =</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;foo&quot;</span>)));</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="comment">// Run without breakpoints.</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="comment">// Run with breakpoint</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <span class="keywordtype">int</span> bp = SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="comment">// Run without breakpoints.</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  ClearBreakPoint(bp);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;}</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">// Test that a break point can be set at an IC load location.</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(BreakPointICLoad) {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;bar=1&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;function foo(){var x=bar;}&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo =</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;foo&quot;</span>)));</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <span class="comment">// Run without breakpoints.</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="comment">// Run with breakpoint.</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <span class="keywordtype">int</span> bp = SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <span class="comment">// Run without breakpoints.</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  ClearBreakPoint(bp);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;}</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">// Test that a break point can be set at an IC call location.</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(BreakPointICCall) {</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;function bar(){}&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;function foo(){bar();}&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo =</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;foo&quot;</span>)));</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  <span class="comment">// Run without breakpoints.</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <span class="comment">// Run with breakpoint</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="keywordtype">int</span> bp = SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <span class="comment">// Run without breakpoints.</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  ClearBreakPoint(bp);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;}</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">// Test that a break point can be set at an IC call location and survive a GC.</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(BreakPointICCallWithGC) {</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointCollectGarbage,</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;function bar(){return 1;}&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;function foo(){return bar();}&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo =</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;foo&quot;</span>)));</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  <span class="comment">// Run without breakpoints.</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>)-&gt;Int32Value());</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <span class="comment">// Run with breakpoint.</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <span class="keywordtype">int</span> bp = SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>)-&gt;Int32Value());</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>)-&gt;Int32Value());</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="comment">// Run without breakpoints.</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  ClearBreakPoint(bp);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;}</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">// Test that a break point can be set at an IC call location and survive a GC.</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(BreakPointConstructCallWithGC) {</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointCollectGarbage,</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;function bar(){ this.x = 1;}&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="stringliteral">&quot;function foo(){return new bar(1).x;}&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo =</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;foo&quot;</span>)));</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="comment">// Run without breakpoints.</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>)-&gt;Int32Value());</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="comment">// Run with breakpoint.</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <span class="keywordtype">int</span> bp = SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>)-&gt;Int32Value());</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>)-&gt;Int32Value());</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <span class="comment">// Run without breakpoints.</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  ClearBreakPoint(bp);</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;}</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment">// Test that a break point can be set at a return store location.</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(BreakPointReturn) {</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  <span class="comment">// Create a functions for checking the source line and column when hitting</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <span class="comment">// a break point.</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  frame_source_line = CompileFunction(&amp;env,</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                                      frame_source_line_source,</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                                      <span class="stringliteral">&quot;frame_source_line&quot;</span>);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  frame_source_column = CompileFunction(&amp;env,</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                                        frame_source_column_source,</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                                        <span class="stringliteral">&quot;frame_source_column&quot;</span>);</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;function foo(){}&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo =</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;foo&quot;</span>)));</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <span class="comment">// Run without breakpoints.</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  <span class="comment">// Run with breakpoint</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  <span class="keywordtype">int</span> bp = SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, last_source_line);</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(15, last_source_column);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, last_source_line);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(15, last_source_column);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <span class="comment">// Run without breakpoints.</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  ClearBreakPoint(bp);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;}</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> CallWithBreakPoints(<a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Object&gt;</a> recv,</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                                <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f,</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                                <span class="keywordtype">int</span> break_point_count,</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                                <span class="keywordtype">int</span> <a class="code" href="../../d1/deb/test-thread-termination_8cc.html#a5e0f60888f1d0bb3daf99036125b899a">call_count</a>) {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d1/deb/test-thread-termination_8cc.html#a5e0f60888f1d0bb3daf99036125b899a">call_count</a>; i++) {</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(recv, 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>((i + 1) * break_point_count, break_point_hit_count);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  }</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;}</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="comment">// Test GC during break point processing.</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(GCDuringBreakPointProcessing) {</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointCollectGarbage,</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> <a class="code" href="../../d6/df1/test-accessors_8cc.html#a819b717d29c6c488a332fefeeb3815ba">foo</a>;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <span class="comment">// Test IC store break point with garbage collection.</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  foo = CompileFunction(&amp;env, <span class="stringliteral">&quot;function foo(){bar=0;}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;  CallWithBreakPoints(env-&gt;Global(), <a class="code" href="../../d6/df1/test-accessors_8cc.html#a819b717d29c6c488a332fefeeb3815ba">foo</a>, 1, 10);</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <span class="comment">// Test IC load break point with garbage collection.</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  foo = CompileFunction(&amp;env, <span class="stringliteral">&quot;bar=1;function foo(){var x=bar;}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  CallWithBreakPoints(env-&gt;Global(), <a class="code" href="../../d6/df1/test-accessors_8cc.html#a819b717d29c6c488a332fefeeb3815ba">foo</a>, 1, 10);</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  <span class="comment">// Test IC call break point with garbage collection.</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  foo = CompileFunction(&amp;env, <span class="stringliteral">&quot;function bar(){};function foo(){bar();}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  CallWithBreakPoints(env-&gt;Global(), <a class="code" href="../../d6/df1/test-accessors_8cc.html#a819b717d29c6c488a332fefeeb3815ba">foo</a>, 1, 10);</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <span class="comment">// Test return break point with garbage collection.</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  foo = CompileFunction(&amp;env, <span class="stringliteral">&quot;function foo(){}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  CallWithBreakPoints(env-&gt;Global(), <a class="code" href="../../d6/df1/test-accessors_8cc.html#a819b717d29c6c488a332fefeeb3815ba">foo</a>, 1, 25);</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;  <span class="comment">// Test debug break slot break point with garbage collection.</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  foo = CompileFunction(&amp;env, <span class="stringliteral">&quot;function foo(){var a;}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  CallWithBreakPoints(env-&gt;Global(), <a class="code" href="../../d6/df1/test-accessors_8cc.html#a819b717d29c6c488a332fefeeb3815ba">foo</a>, 1, 25);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;}</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment">// Call the function three times with different garbage collections in between</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment">// and make sure that the break point survives.</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> CallAndGC(<a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Object&gt;</a> recv,</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                      <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f) {</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <span class="comment">// Call function.</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(recv, 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1 + i * 3, break_point_hit_count);</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="comment">// Scavenge and call function.</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <a class="code" href="../../d8/d1e/isolate_8h.html#a4e8c3dc786eeec70c7c26763ea3d2ef7">HEAP</a>-&gt;CollectGarbage(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a5e2ec2be00b3d617582f927ee37878f7a55bf024372af033e86eeb191711b47ca">v8::internal::NEW_SPACE</a>);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(recv, 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2 + i * 3, break_point_hit_count);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <span class="comment">// Mark sweep (and perhaps compact) and call function.</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <a class="code" href="../../d8/d1e/isolate_8h.html#a4e8c3dc786eeec70c7c26763ea3d2ef7">HEAP</a>-&gt;CollectAllGarbage(Heap::kNoGCFlags);</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(recv, 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3 + i * 3, break_point_hit_count);</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  }</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;}</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">// Test that a break point can be set at a return store location.</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(BreakPointSurviveGC) {</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> <a class="code" href="../../d6/df1/test-accessors_8cc.html#a819b717d29c6c488a332fefeeb3815ba">foo</a>;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <span class="comment">// Test IC store break point with garbage collection.</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  {</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    CompileFunction(&amp;env, <span class="stringliteral">&quot;function foo(){}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    foo = CompileFunction(&amp;env, <span class="stringliteral">&quot;function foo(){bar=0;}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  }</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  CallAndGC(env-&gt;Global(), <a class="code" href="../../d6/df1/test-accessors_8cc.html#a819b717d29c6c488a332fefeeb3815ba">foo</a>);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  <span class="comment">// Test IC load break point with garbage collection.</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  {</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    CompileFunction(&amp;env, <span class="stringliteral">&quot;function foo(){}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    foo = CompileFunction(&amp;env, <span class="stringliteral">&quot;bar=1;function foo(){var x=bar;}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  }</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  CallAndGC(env-&gt;Global(), <a class="code" href="../../d6/df1/test-accessors_8cc.html#a819b717d29c6c488a332fefeeb3815ba">foo</a>);</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <span class="comment">// Test IC call break point with garbage collection.</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  {</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    CompileFunction(&amp;env, <span class="stringliteral">&quot;function foo(){}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    foo = CompileFunction(&amp;env,</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                          <span class="stringliteral">&quot;function bar(){};function foo(){bar();}&quot;</span>,</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                          <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  }</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  CallAndGC(env-&gt;Global(), <a class="code" href="../../d6/df1/test-accessors_8cc.html#a819b717d29c6c488a332fefeeb3815ba">foo</a>);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  <span class="comment">// Test return break point with garbage collection.</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  {</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    CompileFunction(&amp;env, <span class="stringliteral">&quot;function foo(){}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    foo = CompileFunction(&amp;env, <span class="stringliteral">&quot;function foo(){}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  }</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  CallAndGC(env-&gt;Global(), <a class="code" href="../../d6/df1/test-accessors_8cc.html#a819b717d29c6c488a332fefeeb3815ba">foo</a>);</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="comment">// Test non IC break point with garbage collection.</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  {</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    CompileFunction(&amp;env, <span class="stringliteral">&quot;function foo(){}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    foo = CompileFunction(&amp;env, <span class="stringliteral">&quot;function foo(){var bar=0;}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  }</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  CallAndGC(env-&gt;Global(), <a class="code" href="../../d6/df1/test-accessors_8cc.html#a819b717d29c6c488a332fefeeb3815ba">foo</a>);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;}</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment">// Test that break points can be set using the global Debug object.</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(BreakPointThroughJavaScript) {</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;function bar(){}&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;function foo(){bar();bar();}&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <span class="comment">//                                               012345678901234567890</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  <span class="comment">//                                                         1         2</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  <span class="comment">// Break points are set at position 3 and 9</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Script&gt;</a> foo = <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;foo()&quot;</span>));</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  <span class="comment">// Run without breakpoints.</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  foo-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#ab937ef8dba07a7ef516f11ef83debf92">Run</a>();</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <span class="comment">// Run with one breakpoint</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <span class="keywordtype">int</span> bp1 = SetBreakPointFromJS(<span class="stringliteral">&quot;foo&quot;</span>, 0, 3);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  foo-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#ab937ef8dba07a7ef516f11ef83debf92">Run</a>();</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  foo-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#ab937ef8dba07a7ef516f11ef83debf92">Run</a>();</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  <span class="comment">// Run with two breakpoints</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <span class="keywordtype">int</span> bp2 = SetBreakPointFromJS(<span class="stringliteral">&quot;foo&quot;</span>, 0, 9);</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  foo-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#ab937ef8dba07a7ef516f11ef83debf92">Run</a>();</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(4, break_point_hit_count);</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  foo-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#ab937ef8dba07a7ef516f11ef83debf92">Run</a>();</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(6, break_point_hit_count);</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  <span class="comment">// Run with one breakpoint</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  ClearBreakPointFromJS(bp2);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  foo-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#ab937ef8dba07a7ef516f11ef83debf92">Run</a>();</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(7, break_point_hit_count);</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  foo-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#ab937ef8dba07a7ef516f11ef83debf92">Run</a>();</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(8, break_point_hit_count);</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <span class="comment">// Run without breakpoints.</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  ClearBreakPointFromJS(bp1);</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  foo-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#ab937ef8dba07a7ef516f11ef83debf92">Run</a>();</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(8, break_point_hit_count);</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  <span class="comment">// Make sure that the break point numbers are consecutive.</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, bp1);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, bp2);</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;}</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment">// Test that break points on scripts identified by name can be set using the</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="comment">// global Debug object.</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ScriptBreakPointByNameThroughJavaScript) {</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> script = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <span class="stringliteral">&quot;function f() {\n&quot;</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <span class="stringliteral">&quot;  function h() {\n&quot;</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="stringliteral">&quot;    a = 0;  // line 2\n&quot;</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="stringliteral">&quot;  }\n&quot;</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <span class="stringliteral">&quot;  b = 1;  // line 4\n&quot;</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="stringliteral">&quot;  return h();\n&quot;</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <span class="stringliteral">&quot;}\n&quot;</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <span class="stringliteral">&quot;function g() {\n&quot;</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="stringliteral">&quot;  function h() {\n&quot;</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="stringliteral">&quot;    a = 0;\n&quot;</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="stringliteral">&quot;  }\n&quot;</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="stringliteral">&quot;  b = 2;  // line 12\n&quot;</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <span class="stringliteral">&quot;  h();\n&quot;</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <span class="stringliteral">&quot;  b = 3;  // line 14\n&quot;</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="stringliteral">&quot;  f();    // line 15\n&quot;</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>);</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  <span class="comment">// Compile the script and get the two functions.</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;  <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a> origin =</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;test&quot;</span>));</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin)-&gt;Run();</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f =</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> g =</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;g&quot;</span>)));</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="comment">// Call f and g without break points.</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  <span class="comment">// Call f and g with break point on line 12.</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  <span class="keywordtype">int</span> sbp1 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test&quot;</span>, 12, 0);</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <span class="comment">// Remove the break point again.</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  ClearBreakPointFromJS(sbp1);</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  <span class="comment">// Call f and g with break point on line 2.</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  <span class="keywordtype">int</span> sbp2 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test&quot;</span>, 2, 0);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <span class="comment">// Call f and g with break point on line 2, 4, 12, 14 and 15.</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  <span class="keywordtype">int</span> sbp3 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test&quot;</span>, 4, 0);</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <span class="keywordtype">int</span> sbp4 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test&quot;</span>, 12, 0);</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  <span class="keywordtype">int</span> sbp5 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test&quot;</span>, 14, 0);</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="keywordtype">int</span> sbp6 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test&quot;</span>, 15, 0);</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(7, break_point_hit_count);</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="comment">// Remove all the break points again.</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  ClearBreakPointFromJS(sbp2);</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  ClearBreakPointFromJS(sbp3);</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  ClearBreakPointFromJS(sbp4);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  ClearBreakPointFromJS(sbp5);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  ClearBreakPointFromJS(sbp6);</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <span class="comment">// Make sure that the break point numbers are consecutive.</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, sbp1);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, sbp2);</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, sbp3);</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(4, sbp4);</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(5, sbp5);</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(6, sbp6);</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;}</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ScriptBreakPointByIdThroughJavaScript) {</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> source = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="stringliteral">&quot;function f() {\n&quot;</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <span class="stringliteral">&quot;  function h() {\n&quot;</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <span class="stringliteral">&quot;    a = 0;  // line 2\n&quot;</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <span class="stringliteral">&quot;  }\n&quot;</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="stringliteral">&quot;  b = 1;  // line 4\n&quot;</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="stringliteral">&quot;  return h();\n&quot;</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="stringliteral">&quot;}\n&quot;</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="stringliteral">&quot;function g() {\n&quot;</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="stringliteral">&quot;  function h() {\n&quot;</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="stringliteral">&quot;    a = 0;\n&quot;</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <span class="stringliteral">&quot;  }\n&quot;</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="stringliteral">&quot;  b = 2;  // line 12\n&quot;</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="stringliteral">&quot;  h();\n&quot;</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="stringliteral">&quot;  b = 3;  // line 14\n&quot;</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <span class="stringliteral">&quot;  f();    // line 15\n&quot;</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  <span class="comment">// Compile the script and get the two functions.</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a> origin =</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;test&quot;</span>));</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Script&gt;</a> script = <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(source, &amp;origin);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;  script-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#ab937ef8dba07a7ef516f11ef83debf92">Run</a>();</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f =</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> g =</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;g&quot;</span>)));</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <span class="comment">// Get the script id knowing that internally it is a 32 integer.</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  uint32_t script_id = script-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#ac863f6ddf042f479912dd207d3fd17e0">Id</a>()-&gt;Uint32Value();</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <span class="comment">// Call f and g without break points.</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <span class="comment">// Call f and g with break point on line 12.</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  <span class="keywordtype">int</span> sbp1 = SetScriptBreakPointByIdFromJS(script_id, 12, 0);</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  <span class="comment">// Remove the break point again.</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  ClearBreakPointFromJS(sbp1);</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  <span class="comment">// Call f and g with break point on line 2.</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  <span class="keywordtype">int</span> sbp2 = SetScriptBreakPointByIdFromJS(script_id, 2, 0);</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  <span class="comment">// Call f and g with break point on line 2, 4, 12, 14 and 15.</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  <span class="keywordtype">int</span> sbp3 = SetScriptBreakPointByIdFromJS(script_id, 4, 0);</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <span class="keywordtype">int</span> sbp4 = SetScriptBreakPointByIdFromJS(script_id, 12, 0);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <span class="keywordtype">int</span> sbp5 = SetScriptBreakPointByIdFromJS(script_id, 14, 0);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  <span class="keywordtype">int</span> sbp6 = SetScriptBreakPointByIdFromJS(script_id, 15, 0);</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(7, break_point_hit_count);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  <span class="comment">// Remove all the break points again.</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  ClearBreakPointFromJS(sbp2);</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  ClearBreakPointFromJS(sbp3);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  ClearBreakPointFromJS(sbp4);</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  ClearBreakPointFromJS(sbp5);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  ClearBreakPointFromJS(sbp6);</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  <span class="comment">// Make sure that the break point numbers are consecutive.</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, sbp1);</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, sbp2);</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, sbp3);</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(4, sbp4);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(5, sbp5);</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(6, sbp6);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;}</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="comment">// Test conditional script break points.</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(EnableDisableScriptBreakPoint) {</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> script = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="stringliteral">&quot;function f() {\n&quot;</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    <span class="stringliteral">&quot;  a = 0;  // line 1\n&quot;</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <span class="stringliteral">&quot;};&quot;</span>);</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <span class="comment">// Compile the script and get function f.</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a> origin =</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;      <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;test&quot;</span>));</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin)-&gt;Run();</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f =</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  <span class="comment">// Set script break point on line 1 (in function f).</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  <span class="keywordtype">int</span> sbp = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test&quot;</span>, 1, 0);</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;  <span class="comment">// Call f while enabeling and disabling the script break point.</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  DisableScriptBreakPointFromJS(sbp);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  EnableScriptBreakPointFromJS(sbp);</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  DisableScriptBreakPointFromJS(sbp);</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  <span class="comment">// Reload the script and get f again checking that the disabeling survives.</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin)-&gt;Run();</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  f = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;  EnableScriptBreakPointFromJS(sbp);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, break_point_hit_count);</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;}</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="comment">// Test conditional script break points.</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ConditionalScriptBreakPoint) {</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> script = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="stringliteral">&quot;count = 0;\n&quot;</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="stringliteral">&quot;function f() {\n&quot;</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="stringliteral">&quot;  g(count++);  // line 2\n&quot;</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="stringliteral">&quot;};\n&quot;</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="stringliteral">&quot;function g(x) {\n&quot;</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <span class="stringliteral">&quot;  var a=x;  // line 5\n&quot;</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    <span class="stringliteral">&quot;};&quot;</span>);</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  <span class="comment">// Compile the script and get function f.</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a> origin =</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;      <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;test&quot;</span>));</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin)-&gt;Run();</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f =</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;  <span class="comment">// Set script break point on line 5 (in function g).</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  <span class="keywordtype">int</span> sbp1 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test&quot;</span>, 5, 0);</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  <span class="comment">// Call f with different conditions on the script break point.</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  ChangeScriptBreakPointConditionFromJS(sbp1, <span class="stringliteral">&quot;false&quot;</span>);</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  ChangeScriptBreakPointConditionFromJS(sbp1, <span class="stringliteral">&quot;true&quot;</span>);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  ChangeScriptBreakPointConditionFromJS(sbp1, <span class="stringliteral">&quot;x % 2 == 0&quot;</span>);</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10; i++) {</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  }</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(5, break_point_hit_count);</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;  <span class="comment">// Reload the script and get f again checking that the condition survives.</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin)-&gt;Run();</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;  f = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10; i++) {</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  }</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(5, break_point_hit_count);</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;}</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="comment">// Test ignore count on script break points.</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ScriptBreakPointIgnoreCount) {</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> script = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="stringliteral">&quot;function f() {\n&quot;</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="stringliteral">&quot;  a = 0;  // line 1\n&quot;</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="stringliteral">&quot;};&quot;</span>);</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;  <span class="comment">// Compile the script and get function f.</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;  <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a> origin =</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;test&quot;</span>));</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin)-&gt;Run();</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f =</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  <span class="comment">// Set script break point on line 1 (in function f).</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  <span class="keywordtype">int</span> sbp = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test&quot;</span>, 1, 0);</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  <span class="comment">// Call f with different ignores on the script break point.</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;  ChangeScriptBreakPointIgnoreCountFromJS(sbp, 1);</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  ChangeScriptBreakPointIgnoreCountFromJS(sbp, 5);</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10; i++) {</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;  }</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(5, break_point_hit_count);</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;  <span class="comment">// Reload the script and get f again checking that the ignore survives.</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin)-&gt;Run();</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;  f = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10; i++) {</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  }</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(5, break_point_hit_count);</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;}</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="comment">// Test that script break points survive when a script is reloaded.</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ScriptBreakPointReload) {</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> script = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <span class="stringliteral">&quot;function f() {\n&quot;</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <span class="stringliteral">&quot;  function h() {\n&quot;</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="stringliteral">&quot;    a = 0;  // line 2\n&quot;</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="stringliteral">&quot;  }\n&quot;</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <span class="stringliteral">&quot;  b = 1;  // line 4\n&quot;</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="stringliteral">&quot;  return h();\n&quot;</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a> origin_1 = <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;1&quot;</span>));</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a> origin_2 = <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;2&quot;</span>));</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  <span class="comment">// Set a script break point before the script is loaded.</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;  SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;1&quot;</span>, 2, 0);</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;  <span class="comment">// Compile the script and get the function.</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin_1)-&gt;Run();</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;  f = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  <span class="comment">// Call f and check that the script break point is active.</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;  <span class="comment">// Compile the script again with a different script data and get the</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  <span class="comment">// function.</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin_2)-&gt;Run();</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  f = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  <span class="comment">// Call f and check that no break points are set.</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  <span class="comment">// Compile the script again and get the function.</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin_1)-&gt;Run();</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;  f = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  <span class="comment">// Call f and check that the script break point is active.</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;}</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="comment">// Test when several scripts has the same script data</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ScriptBreakPointMultiple) {</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> script_f = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    <span class="stringliteral">&quot;function f() {\n&quot;</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    <span class="stringliteral">&quot;  a = 0;  // line 1\n&quot;</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>);</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> g;</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> script_g = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <span class="stringliteral">&quot;function g() {\n&quot;</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="stringliteral">&quot;  b = 0;  // line 1\n&quot;</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>);</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a> origin =</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;      <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;test&quot;</span>));</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;  <span class="comment">// Set a script break point before the scripts are loaded.</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  <span class="keywordtype">int</span> sbp = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test&quot;</span>, 1, 0);</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  <span class="comment">// Compile the scripts with same script data and get the functions.</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script_f, &amp;origin)-&gt;Run();</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  f = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script_g, &amp;origin)-&gt;Run();</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  g = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;g&quot;</span>)));</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  <span class="comment">// Call f and g and check that the script break point is active.</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;  <span class="comment">// Clear the script break point.</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;  ClearBreakPointFromJS(sbp);</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;  <span class="comment">// Call f and g and check that the script break point is no longer active.</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;  <span class="comment">// Set script break point with the scripts loaded.</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;  sbp = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test&quot;</span>, 1, 0);</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;  <span class="comment">// Call f and g and check that the script break point is active.</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;}</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="comment">// Test the script origin which has both name and line offset.</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ScriptBreakPointLineOffset) {</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> script = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    <span class="stringliteral">&quot;function f() {\n&quot;</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    <span class="stringliteral">&quot;  a = 0;  // line 8 as this script has line offset 7\n&quot;</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    <span class="stringliteral">&quot;  b = 0;  // line 9 as this script has line offset 7\n&quot;</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>);</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;  <span class="comment">// Create script origin both name and line offset.</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a> origin(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;test.html&quot;</span>),</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                          <a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(7));</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;  <span class="comment">// Set two script break points before the script is loaded.</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  <span class="keywordtype">int</span> sbp1 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test.html&quot;</span>, 8, 0);</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  <span class="keywordtype">int</span> sbp2 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test.html&quot;</span>, 9, 0);</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  <span class="comment">// Compile the script and get the function.</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin)-&gt;Run();</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;  f = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="comment">// Call f and check that the script break point is active.</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  <span class="comment">// Clear the script break points.</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  ClearBreakPointFromJS(sbp1);</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;  ClearBreakPointFromJS(sbp2);</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  <span class="comment">// Call f and check that no script break points are active.</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  <span class="comment">// Set a script break point with the script loaded.</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  sbp1 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test.html&quot;</span>, 9, 0);</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  <span class="comment">// Call f and check that the script break point is active.</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;}</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;<span class="comment">// Test script break points set on lines.</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ScriptBreakPointLine) {</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;  <span class="comment">// Create a function for checking the function when hitting a break point.</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;  frame_function_name = CompileFunction(&amp;env,</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;                                        frame_function_name_source,</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                                        <span class="stringliteral">&quot;frame_function_name&quot;</span>);</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f;</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> g;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> script = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    <span class="stringliteral">&quot;a = 0                      // line 0\n&quot;</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    <span class="stringliteral">&quot;function f() {\n&quot;</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <span class="stringliteral">&quot;  a = 1;                   // line 2\n&quot;</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    <span class="stringliteral">&quot;}\n&quot;</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    <span class="stringliteral">&quot; a = 2;                    // line 4\n&quot;</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    <span class="stringliteral">&quot;  /* xx */ function g() {  // line 5\n&quot;</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;    <span class="stringliteral">&quot;    function h() {         // line 6\n&quot;</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    <span class="stringliteral">&quot;      a = 3;               // line 7\n&quot;</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    <span class="stringliteral">&quot;    }\n&quot;</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    <span class="stringliteral">&quot;    h();                   // line 9\n&quot;</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    <span class="stringliteral">&quot;    a = 4;                 // line 10\n&quot;</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <span class="stringliteral">&quot;  }\n&quot;</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="stringliteral">&quot; a=5;                      // line 12&quot;</span>);</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;  <span class="comment">// Set a couple script break point before the script is loaded.</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  <span class="keywordtype">int</span> sbp1 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test.html&quot;</span>, 0, -1);</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <span class="keywordtype">int</span> sbp2 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test.html&quot;</span>, 1, -1);</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;  <span class="keywordtype">int</span> sbp3 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test.html&quot;</span>, 5, -1);</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  <span class="comment">// Compile the script and get the function.</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a> origin(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;test.html&quot;</span>), <a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(0));</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin)-&gt;Run();</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;  f = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;  g = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;g&quot;</span>)));</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;  <span class="comment">// Check that a break point was hit when the script was run.</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(last_function_hit));</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;  <span class="comment">// Call f and check that the script break point.</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<span class="stringliteral">&quot;f&quot;</span>, last_function_hit);</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;  <span class="comment">// Call g and check that the script break point.</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, break_point_hit_count);</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<span class="stringliteral">&quot;g&quot;</span>, last_function_hit);</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;  <span class="comment">// Clear the script break point on g and set one on h.</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;  ClearBreakPointFromJS(sbp3);</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  <span class="keywordtype">int</span> sbp4 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test.html&quot;</span>, 6, -1);</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;  <span class="comment">// Call g and check that the script break point in h is hit.</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(4, break_point_hit_count);</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<span class="stringliteral">&quot;h&quot;</span>, last_function_hit);</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;  <span class="comment">// Clear break points in f and h. Set a new one in the script between</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;  <span class="comment">// functions f and g and test that there is no break points in f and g any</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;  <span class="comment">// more.</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;  ClearBreakPointFromJS(sbp2);</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;  ClearBreakPointFromJS(sbp4);</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;  <span class="keywordtype">int</span> sbp5 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test.html&quot;</span>, 4, -1);</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;  <span class="comment">// Reload the script which should hit two break points.</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin)-&gt;Run();</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(last_function_hit));</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  <span class="comment">// Set a break point in the code after the last function decleration.</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;  <span class="keywordtype">int</span> sbp6 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test.html&quot;</span>, 12, -1);</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;  <span class="comment">// Reload the script which should hit three break points.</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin)-&gt;Run();</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, break_point_hit_count);</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(last_function_hit));</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;  <span class="comment">// Clear the last break points, and reload the script which should not hit any</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;  <span class="comment">// break points.</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  ClearBreakPointFromJS(sbp1);</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;  ClearBreakPointFromJS(sbp5);</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;  ClearBreakPointFromJS(sbp6);</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin)-&gt;Run();</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;}</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;<span class="comment">// Test top level script break points set on lines.</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ScriptBreakPointLineTopLevel) {</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> script = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    <span class="stringliteral">&quot;function f() {\n&quot;</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    <span class="stringliteral">&quot;  a = 1;                   // line 1\n&quot;</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    <span class="stringliteral">&quot;}\n&quot;</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    <span class="stringliteral">&quot;a = 2;                     // line 3\n&quot;</span>);</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f;</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;  {</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;test.html&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;  }</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;  f = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;  <a class="code" href="../../d8/d1e/isolate_8h.html#a4e8c3dc786eeec70c7c26763ea3d2ef7">HEAP</a>-&gt;CollectAllGarbage(Heap::kNoGCFlags);</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test.html&quot;</span>, 3, -1);</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  <span class="comment">// Call f and check that there was no break points.</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;  <span class="comment">// Recompile and run script and check that break point was hit.</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;test.html&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  <span class="comment">// Call f and check that there are still no break points.</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;  f = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;}</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;<span class="comment">// Test that it is possible to add and remove break points in a top level</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="comment">// function which has no references but has not been collected yet.</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ScriptBreakPointTopLevelCrash) {</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> script_source = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    <span class="stringliteral">&quot;function f() {\n&quot;</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <span class="stringliteral">&quot;  return 0;\n&quot;</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    <span class="stringliteral">&quot;}\n&quot;</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    <span class="stringliteral">&quot;f()&quot;</span>);</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;  <span class="keywordtype">int</span> sbp1 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test.html&quot;</span>, 3, -1);</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;  {</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;    <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    break_point_hit_count = 0;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script_source, <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;test.html&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;  }</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;  <span class="keywordtype">int</span> sbp2 = SetScriptBreakPointByNameFromJS(<span class="stringliteral">&quot;test.html&quot;</span>, 3, -1);</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;  ClearBreakPointFromJS(sbp1);</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;  ClearBreakPointFromJS(sbp2);</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;}</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="comment">// Test that it is possible to remove the last break point for a function</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;<span class="comment">// inside the break handling of that break point.</span></div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(RemoveBreakPointInBreak) {</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo =</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;      CompileFunction(&amp;env, <span class="stringliteral">&quot;function foo(){a=1;}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;  debug_event_remove_break_point = SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;  <span class="comment">// Register the debug event listener pasing the function</span></div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventRemoveBreakPoint, foo);</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;}</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;<span class="comment">// Test that the debugger statement causes a break.</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebuggerStatement) {</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;function bar(){debugger}&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;      <span class="stringliteral">&quot;function foo(){debugger;debugger;}&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo =</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;foo&quot;</span>)));</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> bar =</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;bar&quot;</span>)));</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;  <span class="comment">// Run function with debugger statement</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;  bar-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;  <span class="comment">// Run function with two debugger statement</span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, break_point_hit_count);</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;}</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="comment">// Test setting a breakpoint on the debugger statement.</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebuggerStatementBreakpoint) {</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    break_point_hit_count = 0;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;    <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    DebugLocalContext env;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;                                     <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;function foo(){debugger;}&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo =</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;foo&quot;</span>)));</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    <span class="comment">// The debugger statement triggers breakpint hit</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    <span class="keywordtype">int</span> bp = SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;    <span class="comment">// Set breakpoint does not duplicate hits</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    ClearBreakPoint(bp);</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;}</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;<span class="comment">// Test that the evaluation of expressions when a break point is hit generates</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;<span class="comment">// the correct results.</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugEvaluate) {</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;  <span class="comment">// Create a function for checking the evaluation when hitting a break point.</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;  evaluate_check_function = CompileFunction(&amp;env,</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;                                            evaluate_check_source,</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;                                            <span class="stringliteral">&quot;evaluate_check&quot;</span>);</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;  <span class="comment">// Register the debug event listener</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventEvaluate);</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;  <span class="comment">// Different expected vaules of x and a when in a break point (u = undefined,</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;  <span class="comment">// d = Hello, world!).</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;  <span class="keyword">struct </span>EvaluateCheck checks_uu[] = {</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    {<span class="stringliteral">&quot;x&quot;</span>, <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>()},</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    {<span class="stringliteral">&quot;a&quot;</span>, <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>()},</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    {<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a>()}</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;  };</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;  <span class="keyword">struct </span>EvaluateCheck checks_hu[] = {</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    {<span class="stringliteral">&quot;x&quot;</span>, <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;Hello, world!&quot;</span>)},</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    {<span class="stringliteral">&quot;a&quot;</span>, <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>()},</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    {<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a>()}</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;  };</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;  <span class="keyword">struct </span>EvaluateCheck checks_hh[] = {</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;    {<span class="stringliteral">&quot;x&quot;</span>, <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;Hello, world!&quot;</span>)},</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    {<span class="stringliteral">&quot;a&quot;</span>, <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;Hello, world!&quot;</span>)},</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    {<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a>()}</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;  };</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;  <span class="comment">// Simple test function. The &quot;y=0&quot; is in the function foo to provide a break</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;  <span class="comment">// location. For &quot;y=0&quot; the &quot;y&quot; is at position 15 in the barbar function</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;  <span class="comment">// therefore setting breakpoint at position 15 will break at &quot;y=0&quot; and</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;  <span class="comment">// setting it higher will break after.</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(&amp;env,</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    <span class="stringliteral">&quot;function foo(x) {&quot;</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    <span class="stringliteral">&quot;  var a;&quot;</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    <span class="stringliteral">&quot;  y=0;&quot;</span>  <span class="comment">// To ensure break location 1.</span></div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="stringliteral">&quot;  a=x;&quot;</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    <span class="stringliteral">&quot;  y=0;&quot;</span>  <span class="comment">// To ensure break location 2.</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>,</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> foo_break_position_1 = 15;</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> foo_break_position_2 = 29;</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;  <span class="comment">// Arguments with one parameter &quot;Hello, world!&quot;</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_foo[1] = { <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;Hello, world!&quot;</span>) };</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;  <span class="comment">// Call foo with breakpoint set before a=x and undefined as parameter.</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;  <span class="keywordtype">int</span> bp = SetBreakPoint(foo, foo_break_position_1);</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;  checks = checks_uu;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;  foo-&gt;Call(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;  <span class="comment">// Call foo with breakpoint set before a=x and parameter &quot;Hello, world!&quot;.</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;  checks = checks_hu;</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;  foo-&gt;Call(env-&gt;Global(), 1, argv_foo);</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;  <span class="comment">// Call foo with breakpoint set after a=x and parameter &quot;Hello, world!&quot;.</span></div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;  ClearBreakPoint(bp);</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;  SetBreakPoint(foo, foo_break_position_2);</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;  checks = checks_hh;</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;  foo-&gt;Call(env-&gt;Global(), 1, argv_foo);</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;  <span class="comment">// Test function with an inner function. The &quot;y=0&quot; is in function barbar</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;  <span class="comment">// to provide a break location. For &quot;y=0&quot; the &quot;y&quot; is at position 8 in the</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;  <span class="comment">// barbar function therefore setting breakpoint at position 8 will break at</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;  <span class="comment">// &quot;y=0&quot; and setting it higher will break after.</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> bar = CompileFunction(&amp;env,</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    <span class="stringliteral">&quot;y = 0;&quot;</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    <span class="stringliteral">&quot;x = &#39;Goodbye, world!&#39;;&quot;</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    <span class="stringliteral">&quot;function bar(x, b) {&quot;</span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    <span class="stringliteral">&quot;  var a;&quot;</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    <span class="stringliteral">&quot;  function barbar() {&quot;</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    <span class="stringliteral">&quot;    y=0; /* To ensure break location.*/&quot;</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    <span class="stringliteral">&quot;    a=x;&quot;</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    <span class="stringliteral">&quot;  };&quot;</span></div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <span class="stringliteral">&quot;  debug.Debug.clearAllBreakPoints();&quot;</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    <span class="stringliteral">&quot;  barbar();&quot;</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    <span class="stringliteral">&quot;  y=0;a=x;&quot;</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>,</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <span class="stringliteral">&quot;bar&quot;</span>);</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> barbar_break_position = 8;</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;  <span class="comment">// Call bar setting breakpoint before a=x in barbar and undefined as</span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;  <span class="comment">// parameter.</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;  checks = checks_uu;</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_bar_1[2] = {</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>(),</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(barbar_break_position)</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;  };</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;  bar-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 2, argv_bar_1);</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;  <span class="comment">// Call bar setting breakpoint before a=x in barbar and parameter</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;  <span class="comment">// &quot;Hello, world!&quot;.</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;  checks = checks_hu;</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_bar_2[2] = {</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;Hello, world!&quot;</span>),</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(barbar_break_position)</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;  };</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;  bar-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 2, argv_bar_2);</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;  <span class="comment">// Call bar setting breakpoint after a=x in barbar and parameter</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;  <span class="comment">// &quot;Hello, world!&quot;.</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;  checks = checks_hh;</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_bar_3[2] = {</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;Hello, world!&quot;</span>),</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(barbar_break_position + 1)</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;  };</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;  bar-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 2, argv_bar_3);</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;}</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;<span class="keywordtype">int</span> debugEventCount = 0;</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> CheckDebugEvent(<span class="keyword">const</span> <a class="code" href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html">v8::Debug::EventDetails</a>&amp; eventDetails) {</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;  <span class="keywordflow">if</span> (eventDetails.<a class="code" href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html#a5e8220bed8b3bf7c537711ce6b9653d6">GetEvent</a>() == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) ++debugEventCount;</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;}</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;<span class="comment">// Test that the conditional breakpoints work event if code generation from</span></div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;<span class="comment">// strings is prohibited in the debugee context.</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ConditionalBreakpointWithCodeGenerationDisallowed) {</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a6193450d47c80996b33eeae196c2535d">v8::Debug::SetDebugEventListener2</a>(CheckDebugEvent);</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(&amp;env,</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    <span class="stringliteral">&quot;function foo(x) {\n&quot;</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    <span class="stringliteral">&quot;  var s = &#39;String value2&#39;;\n&quot;</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;    <span class="stringliteral">&quot;  return s + x;\n&quot;</span></div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>,</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;  <span class="comment">// Set conditional breakpoint with condition &#39;true&#39;.</span></div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;  CompileRun(<span class="stringliteral">&quot;debug.Debug.setBreakPoint(foo, 2, 0, &#39;true&#39;)&quot;</span>);</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;  debugEventCount = 0;</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;  env-&gt;AllowCodeGenerationFromStrings(<span class="keyword">false</span>);</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, debugEventCount);</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a6193450d47c80996b33eeae196c2535d">v8::Debug::SetDebugEventListener2</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;}</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;<span class="keywordtype">bool</span> checkedDebugEvals = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;<a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Function&gt;</a> checkGlobalEvalFunction;</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;<a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Function&gt;</a> checkFrameEvalFunction;</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> CheckDebugEval(<span class="keyword">const</span> <a class="code" href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html">v8::Debug::EventDetails</a>&amp; eventDetails) {</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;  <span class="keywordflow">if</span> (eventDetails.<a class="code" href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html#a5e8220bed8b3bf7c537711ce6b9653d6">GetEvent</a>() == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    ++debugEventCount;</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> handleScope;</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> args[] = { eventDetails.<a class="code" href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html#a6c310570684fe353e180846f823a099d">GetExecutionState</a>() };</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(checkGlobalEvalFunction-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;        eventDetails.<a class="code" href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html#ad4a63f4bd528bea4a669152a350a964f">GetEventContext</a>()-&gt;<a class="code" href="../../df/d69/classv8_1_1_context.html#a8fc7f005c25f7ac02e35c8ebf51183b3">Global</a>(), 1, args)-&gt;IsTrue());</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(checkFrameEvalFunction-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;        eventDetails.<a class="code" href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html#ad4a63f4bd528bea4a669152a350a964f">GetEventContext</a>()-&gt;<a class="code" href="../../df/d69/classv8_1_1_context.html#a8fc7f005c25f7ac02e35c8ebf51183b3">Global</a>(), 1, args)-&gt;IsTrue());</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;  }</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;}</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;<span class="comment">// Test that the evaluation of expressions when a break point is hit generates</span></div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;<span class="comment">// the correct results in case code generation from strings is disallowed in the</span></div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;<span class="comment">// debugee context.</span></div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugEvaluateWithCodeGenerationDisallowed) {</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a6193450d47c80996b33eeae196c2535d">v8::Debug::SetDebugEventListener2</a>(CheckDebugEval);</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(&amp;env,</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    <span class="stringliteral">&quot;var global = &#39;Global&#39;;\n&quot;</span></div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    <span class="stringliteral">&quot;function foo(x) {\n&quot;</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    <span class="stringliteral">&quot;  var local = &#39;Local&#39;;\n&quot;</span></div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <span class="stringliteral">&quot;  debugger;\n&quot;</span></div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    <span class="stringliteral">&quot;  return local + x;\n&quot;</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>,</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;  checkGlobalEvalFunction = CompileFunction(&amp;env,</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    <span class="stringliteral">&quot;function checkGlobalEval(exec_state) {\n&quot;</span></div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    <span class="stringliteral">&quot;  return exec_state.evaluateGlobal(&#39;global&#39;).value() === &#39;Global&#39;;\n&quot;</span></div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>,</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    <span class="stringliteral">&quot;checkGlobalEval&quot;</span>);</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;  checkFrameEvalFunction = CompileFunction(&amp;env,</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    <span class="stringliteral">&quot;function checkFrameEval(exec_state) {\n&quot;</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    <span class="stringliteral">&quot;  return exec_state.frame(0).evaluate(&#39;local&#39;).value() === &#39;Local&#39;;\n&quot;</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>,</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    <span class="stringliteral">&quot;checkFrameEval&quot;</span>);</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;  debugEventCount = 0;</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;  env-&gt;AllowCodeGenerationFromStrings(<span class="keyword">false</span>);</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, debugEventCount);</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;  checkGlobalEvalFunction.<a class="code" href="../../d3/dd5/classv8_1_1_handle.html#aa71d36872f416feaa853788a7a7a7ef8">Clear</a>();</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;  checkFrameEvalFunction.<a class="code" href="../../d3/dd5/classv8_1_1_handle.html#aa71d36872f416feaa853788a7a7a7ef8">Clear</a>();</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a6193450d47c80996b33eeae196c2535d">v8::Debug::SetDebugEventListener2</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;}</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;<span class="comment">// Copies a C string to a 16-bit string.  Does not check for buffer overflow.</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;<span class="comment">// Does not use the V8 engine to convert strings, so it can be used</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;<span class="comment">// in any thread.  Returns the length of the string.</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;<span class="keywordtype">int</span> AsciiToUtf16(<span class="keyword">const</span> <span class="keywordtype">char</span>* input_buffer, <a class="code" href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">uint16_t</a>* output_buffer) {</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;  <span class="keywordflow">for</span> (i = 0; input_buffer[i] != <span class="charliteral">&#39;\0&#39;</span>; ++i) {</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    <span class="comment">// ASCII does not use chars &gt; 127, but be careful anyway.</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    output_buffer[i] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span><span class="keyword">&gt;</span>(input_buffer[i]);</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;  }</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;  output_buffer[i] = 0;</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;  <span class="keywordflow">return</span> i;</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;}</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;<span class="comment">// Copies a 16-bit string to a C string by dropping the high byte of</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;<span class="comment">// each character.  Does not check for buffer overflow.</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="comment">// Can be used in any thread.  Requires string length as an input.</span></div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;<span class="keywordtype">int</span> Utf16ToAscii(<span class="keyword">const</span> <a class="code" href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">uint16_t</a>* input_buffer, <span class="keywordtype">int</span> length,</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;                 <span class="keywordtype">char</span>* output_buffer, <span class="keywordtype">int</span> output_len = -1) {</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;  <span class="keywordflow">if</span> (output_len &gt;= 0) {</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;    <span class="keywordflow">if</span> (length &gt; output_len - 1) {</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;      length = output_len - 1;</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    }</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;  }</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length; ++i) {</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    output_buffer[i] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(input_buffer[i]);</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;  }</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;  output_buffer[length] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;  <span class="keywordflow">return</span> length;</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;}</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;<span class="comment">// We match parts of the message to get evaluate result int value.</span></div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;<span class="keywordtype">bool</span> GetEvaluateStringResult(<span class="keywordtype">char</span> *<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a52143ab7f8a8ac8ea0cdbe70d282c73a">message</a>, <span class="keywordtype">char</span>* buffer, <span class="keywordtype">int</span> buffer_size) {</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;  <span class="keywordflow">if</span> (strstr(message, <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;&quot;</span>) == <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>) {</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;  }</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* prefix = <span class="stringliteral">&quot;\&quot;text\&quot;:\&quot;&quot;</span>;</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;  <span class="keywordtype">char</span>* pos1 = strstr(message, prefix);</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;  <span class="keywordflow">if</span> (pos1 == <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>) {</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;  }</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;  pos1 += strlen(prefix);</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;  <span class="keywordtype">char</span>* pos2 = strchr(pos1, <span class="charliteral">&#39;&quot;&#39;</span>);</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;  <span class="keywordflow">if</span> (pos2 == <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>) {</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;  }</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;  Vector&lt;char&gt; buf(buffer, buffer_size);</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;  <span class="keywordtype">int</span> len = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(pos2 - pos1);</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;  <span class="keywordflow">if</span> (len &gt; buffer_size - 1) {</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    len = buffer_size - 1;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;  }</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;  OS::StrNCpy(buf, pos1, len);</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;  buffer[buffer_size - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;}</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;<span class="keyword">struct </span>EvaluateResult {</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kBufferSize = 20;</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;  <span class="keywordtype">char</span> buffer[kBufferSize];</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;};</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;<span class="keyword">struct </span>DebugProcessDebugMessagesData {</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kArraySize = 5;</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;  <span class="keywordtype">int</span> counter;</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;  EvaluateResult results[kArraySize];</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;  <span class="keywordtype">void</span> reset() {</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;    counter = 0;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;  }</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;  EvaluateResult* current() {</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    <span class="keywordflow">return</span> &amp;results[counter % kArraySize];</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;  }</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;  <span class="keywordtype">void</span> next() {</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;    counter++;</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;  }</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;};</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;DebugProcessDebugMessagesData process_debug_messages_data;</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugProcessDebugMessagesHandler(</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">uint16_t</a>* message,</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    <span class="keywordtype">int</span> length,</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    <a class="code" href="../../d9/d18/classv8_1_1_debug_1_1_client_data.html">v8::Debug::ClientData</a>* client_data) {</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kBufferSize = 100000;</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;  <span class="keywordtype">char</span> print_buffer[kBufferSize];</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;  Utf16ToAscii(message, length, print_buffer, kBufferSize);</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;  EvaluateResult* array_item = process_debug_messages_data.current();</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;  <span class="keywordtype">bool</span> res = GetEvaluateStringResult(print_buffer,</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;                                     array_item-&gt;buffer,</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;                                     EvaluateResult::kBufferSize);</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;  <span class="keywordflow">if</span> (res) {</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    process_debug_messages_data.next();</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;  }</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;}</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;<span class="comment">// Test that the evaluation of expressions works even from ProcessDebugMessages</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;<span class="comment">// i.e. with empty stack.</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugEvaluateWithoutStack) {</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a969c9d982bcc1e4219047212bfb64467">v8::Debug::SetMessageHandler</a>(DebugProcessDebugMessagesHandler);</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* source =</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;      <span class="stringliteral">&quot;var v1 = &#39;Pinguin&#39;;\n function getAnimal() { return &#39;Capy&#39; + &#39;bara&#39;; }&quot;</span>;</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(source))-&gt;Run();</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a5aaf984433cde031c9e8b8a3da1ed699">v8::Debug::ProcessDebugMessages</a>();</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kBufferSize = 1000;</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;  <a class="code" href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> buffer[kBufferSize];</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_111 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:111,&quot;</span></div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;      <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;      <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;,&quot;</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;      <span class="stringliteral">&quot;\&quot;arguments\&quot;:{&quot;</span></div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;      <span class="stringliteral">&quot;    \&quot;global\&quot;:true,&quot;</span></div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;      <span class="stringliteral">&quot;    \&quot;expression\&quot;:\&quot;v1\&quot;,\&quot;disable_break\&quot;:true&quot;</span></div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;      <span class="stringliteral">&quot;}}&quot;</span>;</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_111, buffer));</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_112 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:112,&quot;</span></div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;      <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;      <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;,&quot;</span></div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;      <span class="stringliteral">&quot;\&quot;arguments\&quot;:{&quot;</span></div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;      <span class="stringliteral">&quot;    \&quot;global\&quot;:true,&quot;</span></div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;      <span class="stringliteral">&quot;    \&quot;expression\&quot;:\&quot;getAnimal()\&quot;,\&quot;disable_break\&quot;:true&quot;</span></div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;      <span class="stringliteral">&quot;}}&quot;</span>;</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_112, buffer));</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_113 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:113,&quot;</span></div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;     <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;     <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;,&quot;</span></div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;     <span class="stringliteral">&quot;\&quot;arguments\&quot;:{&quot;</span></div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;     <span class="stringliteral">&quot;    \&quot;global\&quot;:true,&quot;</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;     <span class="stringliteral">&quot;    \&quot;expression\&quot;:\&quot;239 + 566\&quot;,\&quot;disable_break\&quot;:true&quot;</span></div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;     <span class="stringliteral">&quot;}}&quot;</span>;</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_113, buffer));</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a5aaf984433cde031c9e8b8a3da1ed699">v8::Debug::ProcessDebugMessages</a>();</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, process_debug_messages_data.counter);</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(strcmp(<span class="stringliteral">&quot;Pinguin&quot;</span>, process_debug_messages_data.results[0].buffer), 0);</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(strcmp(<span class="stringliteral">&quot;Capybara&quot;</span>, process_debug_messages_data.results[1].buffer),</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;           0);</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(strcmp(<span class="stringliteral">&quot;805&quot;</span>, process_debug_messages_data.results[2].buffer), 0);</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a969c9d982bcc1e4219047212bfb64467">v8::Debug::SetMessageHandler</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;}</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;<span class="comment">// Simple test of the stepping mechanism using only store ICs.</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepLinear) {</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;  <span class="comment">// Create a function for testing stepping.</span></div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(&amp;env,</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;                                                <span class="stringliteral">&quot;function foo(){a=1;b=1;c=1;}&quot;</span>,</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;                                                <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;  <span class="comment">// Run foo to allow it to get optimized.</span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;  CompileRun(<span class="stringliteral">&quot;a=0; b=0; c=0; foo();&quot;</span>);</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;  SetBreakPoint(foo, 3);</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;  <span class="comment">// With stepping all break locations are hit.</span></div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(4, break_point_hit_count);</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;  <span class="comment">// Register a debug event listener which just counts.</span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount);</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;  SetBreakPoint(foo, 3);</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;  <span class="comment">// Without stepping only active break points are hit.</span></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;}</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;<span class="comment">// Test of the stepping mechanism for keyed load in a loop.</span></div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepKeyedLoadLoop) {</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;  <span class="comment">// Create a function for testing stepping of keyed load. The statement &#39;y=1&#39;</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;  <span class="comment">// is there to have more than one breakable statement in the loop, TODO(315).</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;      &amp;env,</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;      <span class="stringliteral">&quot;function foo(a) {\n&quot;</span></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;      <span class="stringliteral">&quot;  var x;\n&quot;</span></div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;      <span class="stringliteral">&quot;  var len = a.length;\n&quot;</span></div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;      <span class="stringliteral">&quot;  for (var i = 0; i &lt; len; i++) {\n&quot;</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;      <span class="stringliteral">&quot;    y = 1;\n&quot;</span></div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;      <span class="stringliteral">&quot;    x = a[i];\n&quot;</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;      <span class="stringliteral">&quot;  }\n&quot;</span></div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;      <span class="stringliteral">&quot;}\n&quot;</span></div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;      <span class="stringliteral">&quot;y=0\n&quot;</span>,</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;      <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;  <span class="comment">// Create array [0,1,2,3,4,5,6,7,8,9]</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Array&gt;</a> a = <a class="code" href="../../db/d85/classv8_1_1_object.html#aa5f1e3dc29693910853bcb6ae1d14f84">v8::Array::New</a>(10);</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10; i++) {</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;    a-&gt;<a class="code" href="../../db/d85/classv8_1_1_object.html#aa5e6d5c3ca70b2a1d52415eac4d528f2">Set</a>(<a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(i), <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(i));</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;  }</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;  <span class="comment">// Call function without any break points to ensure inlining is in place.</span></div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kArgc = 1;</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> args[kArgc] = { a };</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), kArgc, args);</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;  <span class="comment">// Set up break point and step through the function.</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;  SetBreakPoint(foo, 3);</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;  step_action = StepNext;</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), kArgc, args);</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;  <span class="comment">// With stepping all break locations are hit.</span></div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(34, break_point_hit_count);</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;}</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;<span class="comment">// Test of the stepping mechanism for keyed store in a loop.</span></div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepKeyedStoreLoop) {</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;  <span class="comment">// Create a function for testing stepping of keyed store. The statement &#39;y=1&#39;</span></div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;  <span class="comment">// is there to have more than one breakable statement in the loop, TODO(315).</span></div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;      &amp;env,</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;      <span class="stringliteral">&quot;function foo(a) {\n&quot;</span></div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;      <span class="stringliteral">&quot;  var len = a.length;\n&quot;</span></div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;      <span class="stringliteral">&quot;  for (var i = 0; i &lt; len; i++) {\n&quot;</span></div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;      <span class="stringliteral">&quot;    y = 1;\n&quot;</span></div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;      <span class="stringliteral">&quot;    a[i] = 42;\n&quot;</span></div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;      <span class="stringliteral">&quot;  }\n&quot;</span></div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;      <span class="stringliteral">&quot;}\n&quot;</span></div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;      <span class="stringliteral">&quot;y=0\n&quot;</span>,</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;      <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;  <span class="comment">// Create array [0,1,2,3,4,5,6,7,8,9]</span></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Array&gt;</a> a = <a class="code" href="../../db/d85/classv8_1_1_object.html#aa5f1e3dc29693910853bcb6ae1d14f84">v8::Array::New</a>(10);</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10; i++) {</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    a-&gt;<a class="code" href="../../db/d85/classv8_1_1_object.html#aa5e6d5c3ca70b2a1d52415eac4d528f2">Set</a>(<a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(i), <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(i));</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;  }</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;  <span class="comment">// Call function without any break points to ensure inlining is in place.</span></div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kArgc = 1;</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> args[kArgc] = { a };</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), kArgc, args);</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;  <span class="comment">// Set up break point and step through the function.</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;  SetBreakPoint(foo, 3);</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;  step_action = StepNext;</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), kArgc, args);</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;  <span class="comment">// With stepping all break locations are hit.</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(33, break_point_hit_count);</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;}</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;<span class="comment">// Test of the stepping mechanism for named load in a loop.</span></div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepNamedLoadLoop) {</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;  <span class="comment">// Create a function for testing stepping of named load.</span></div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;      &amp;env,</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;      <span class="stringliteral">&quot;function foo() {\n&quot;</span></div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;          <span class="stringliteral">&quot;  var a = [];\n&quot;</span></div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;          <span class="stringliteral">&quot;  var s = \&quot;\&quot;;\n&quot;</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;          <span class="stringliteral">&quot;  for (var i = 0; i &lt; 10; i++) {\n&quot;</span></div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;          <span class="stringliteral">&quot;    var v = new V(i, i + 1);\n&quot;</span></div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;          <span class="stringliteral">&quot;    v.y;\n&quot;</span></div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;          <span class="stringliteral">&quot;    a.length;\n&quot;</span>  <span class="comment">// Special case: array length.</span></div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;          <span class="stringliteral">&quot;    s.length;\n&quot;</span>  <span class="comment">// Special case: string length.</span></div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;          <span class="stringliteral">&quot;  }\n&quot;</span></div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;          <span class="stringliteral">&quot;}\n&quot;</span></div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;          <span class="stringliteral">&quot;function V(x, y) {\n&quot;</span></div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;          <span class="stringliteral">&quot;  this.x = x;\n&quot;</span></div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;          <span class="stringliteral">&quot;  this.y = y;\n&quot;</span></div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;          <span class="stringliteral">&quot;}\n&quot;</span>,</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;          <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;  <span class="comment">// Call function without any break points to ensure inlining is in place.</span></div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;  <span class="comment">// Set up break point and step through the function.</span></div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;  SetBreakPoint(foo, 4);</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;  step_action = StepNext;</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;  <span class="comment">// With stepping all break locations are hit.</span></div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(54, break_point_hit_count);</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;}</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DoDebugStepNamedStoreLoop(<span class="keywordtype">int</span> expected) {</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;  <span class="comment">// Create a function for testing stepping of named store.</span></div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;      &amp;env,</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;      <span class="stringliteral">&quot;function foo() {\n&quot;</span></div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;          <span class="stringliteral">&quot;  var a = {a:1};\n&quot;</span></div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;          <span class="stringliteral">&quot;  for (var i = 0; i &lt; 10; i++) {\n&quot;</span></div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;          <span class="stringliteral">&quot;    a.a = 2\n&quot;</span></div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;          <span class="stringliteral">&quot;  }\n&quot;</span></div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;          <span class="stringliteral">&quot;}\n&quot;</span>,</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;          <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;  <span class="comment">// Call function without any break points to ensure inlining is in place.</span></div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;  <span class="comment">// Set up break point and step through the function.</span></div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;  SetBreakPoint(foo, 3);</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;  step_action = StepNext;</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;  <span class="comment">// With stepping all expected break locations are hit.</span></div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(expected, break_point_hit_count);</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;}</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;<span class="comment">// Test of the stepping mechanism for named load in a loop.</span></div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepNamedStoreLoop) {</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;  DoDebugStepNamedStoreLoop(23);</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;}</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;<span class="comment">// Test the stepping mechanism with different ICs.</span></div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepLinearMixedICs) {</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;  <span class="comment">// Create a function for testing stepping.</span></div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(&amp;env,</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;      <span class="stringliteral">&quot;function bar() {};&quot;</span></div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;      <span class="stringliteral">&quot;function foo() {&quot;</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;      <span class="stringliteral">&quot;  var x;&quot;</span></div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;      <span class="stringliteral">&quot;  var index=&#39;name&#39;;&quot;</span></div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;      <span class="stringliteral">&quot;  var y = {};&quot;</span></div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;      <span class="stringliteral">&quot;  a=1;b=2;x=a;y[index]=3;x=y[index];bar();}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;  <span class="comment">// Run functions to allow them to get optimized.</span></div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;  CompileRun(<span class="stringliteral">&quot;a=0; b=0; bar(); foo();&quot;</span>);</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;  SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;  <span class="comment">// With stepping all break locations are hit.</span></div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(11, break_point_hit_count);</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;  <span class="comment">// Register a debug event listener which just counts.</span></div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount);</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;  SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;  <span class="comment">// Without stepping only active break points are hit.</span></div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;}</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepDeclarations) {</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;  <span class="comment">// Create a function for testing stepping. Run it to allow it to get</span></div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;  <span class="comment">// optimized.</span></div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function foo() { &quot;</span></div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;                    <span class="stringliteral">&quot;  var a;&quot;</span></div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;                    <span class="stringliteral">&quot;  var b = 1;&quot;</span></div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;                    <span class="stringliteral">&quot;  var c = foo;&quot;</span></div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;                    <span class="stringliteral">&quot;  var d = Math.floor;&quot;</span></div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;                    <span class="stringliteral">&quot;  var e = b + d(1.2);&quot;</span></div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;                    <span class="stringliteral">&quot;}&quot;</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;                    <span class="stringliteral">&quot;foo()&quot;</span>;</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;  SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;  <span class="comment">// Stepping through the declarations.</span></div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(6, break_point_hit_count);</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;}</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepLocals) {</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;  <span class="comment">// Create a function for testing stepping. Run it to allow it to get</span></div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;  <span class="comment">// optimized.</span></div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function foo() { &quot;</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;                    <span class="stringliteral">&quot;  var a,b;&quot;</span></div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;                    <span class="stringliteral">&quot;  a = 1;&quot;</span></div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;                    <span class="stringliteral">&quot;  b = a + 2;&quot;</span></div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;                    <span class="stringliteral">&quot;  b = 1 + 2 + 3;&quot;</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;                    <span class="stringliteral">&quot;  a = Math.floor(b);&quot;</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;                    <span class="stringliteral">&quot;}&quot;</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;                    <span class="stringliteral">&quot;foo()&quot;</span>;</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;  SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;  <span class="comment">// Stepping through the declarations.</span></div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(6, break_point_hit_count);</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;}</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepIf) {</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;  <span class="comment">// Create a function for testing stepping. Run it to allow it to get</span></div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;  <span class="comment">// optimized.</span></div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function foo(x) { &quot;</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;                    <span class="stringliteral">&quot;  a = 1;&quot;</span></div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;                    <span class="stringliteral">&quot;  if (x) {&quot;</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;                    <span class="stringliteral">&quot;    b = 1;&quot;</span></div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;                    <span class="stringliteral">&quot;  } else {&quot;</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;                    <span class="stringliteral">&quot;    c = 1;&quot;</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;                    <span class="stringliteral">&quot;    d = 1;&quot;</span></div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;                    <span class="stringliteral">&quot;  }&quot;</span></div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;                    <span class="stringliteral">&quot;}&quot;</span></div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;                    <span class="stringliteral">&quot;a=0; b=0; c=0; d=0; foo()&quot;</span>;</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;  SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;  <span class="comment">// Stepping through the true part.</span></div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_true[argc] = { <a class="code" href="../../d2/dc3/namespacev8.html#a50252b3ef3537127f61f73c2d3888092">v8::True</a>() };</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv_true);</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(4, break_point_hit_count);</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;  <span class="comment">// Stepping through the false part.</span></div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_false[argc] = { <a class="code" href="../../d2/dc3/namespacev8.html#a6d946d0599c405a057cb4a1b446c3662">v8::False</a>() };</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv_false);</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(5, break_point_hit_count);</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;}</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepSwitch) {</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;  <span class="comment">// Create a function for testing stepping. Run it to allow it to get</span></div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;  <span class="comment">// optimized.</span></div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function foo(x) { &quot;</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;                    <span class="stringliteral">&quot;  a = 1;&quot;</span></div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;                    <span class="stringliteral">&quot;  switch (x) {&quot;</span></div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;                    <span class="stringliteral">&quot;    case 1:&quot;</span></div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;                    <span class="stringliteral">&quot;      b = 1;&quot;</span></div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;                    <span class="stringliteral">&quot;    case 2:&quot;</span></div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;                    <span class="stringliteral">&quot;      c = 1;&quot;</span></div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;                    <span class="stringliteral">&quot;      break;&quot;</span></div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;                    <span class="stringliteral">&quot;    case 3:&quot;</span></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;                    <span class="stringliteral">&quot;      d = 1;&quot;</span></div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;                    <span class="stringliteral">&quot;      e = 1;&quot;</span></div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;                    <span class="stringliteral">&quot;      f = 1;&quot;</span></div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;                    <span class="stringliteral">&quot;      break;&quot;</span></div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;                    <span class="stringliteral">&quot;  }&quot;</span></div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;                    <span class="stringliteral">&quot;}&quot;</span></div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;                    <span class="stringliteral">&quot;a=0; b=0; c=0; d=0; e=0; f=0; foo()&quot;</span>;</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;  SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;  <span class="comment">// One case with fall-through.</span></div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_1[argc] = { <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(1) };</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv_1);</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(6, break_point_hit_count);</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;  <span class="comment">// Another case.</span></div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_2[argc] = { <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(2) };</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv_2);</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(5, break_point_hit_count);</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;  <span class="comment">// Last case.</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_3[argc] = { <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(3) };</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv_3);</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(7, break_point_hit_count);</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;}</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepWhile) {</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;  <span class="comment">// Create a function for testing stepping. Run it to allow it to get</span></div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;  <span class="comment">// optimized.</span></div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function foo(x) { &quot;</span></div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;                    <span class="stringliteral">&quot;  var a = 0;&quot;</span></div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;                    <span class="stringliteral">&quot;  while (a &lt; x) {&quot;</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;                    <span class="stringliteral">&quot;    a++;&quot;</span></div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;                    <span class="stringliteral">&quot;  }&quot;</span></div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;                    <span class="stringliteral">&quot;}&quot;</span></div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;                    <span class="stringliteral">&quot;foo()&quot;</span>;</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;  SetBreakPoint(foo, 8);  <span class="comment">// &quot;var a = 0;&quot;</span></div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;  <span class="comment">// Looping 10 times.</span></div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_10[argc] = { <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(10) };</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv_10);</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(22, break_point_hit_count);</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;  <span class="comment">// Looping 100 times.</span></div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_100[argc] = { <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(100) };</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv_100);</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(202, break_point_hit_count);</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;}</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepDoWhile) {</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;  <span class="comment">// Create a function for testing stepping. Run it to allow it to get</span></div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;  <span class="comment">// optimized.</span></div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function foo(x) { &quot;</span></div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;                    <span class="stringliteral">&quot;  var a = 0;&quot;</span></div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;                    <span class="stringliteral">&quot;  do {&quot;</span></div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;                    <span class="stringliteral">&quot;    a++;&quot;</span></div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;                    <span class="stringliteral">&quot;  } while (a &lt; x)&quot;</span></div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;                    <span class="stringliteral">&quot;}&quot;</span></div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;                    <span class="stringliteral">&quot;foo()&quot;</span>;</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;  SetBreakPoint(foo, 8);  <span class="comment">// &quot;var a = 0;&quot;</span></div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;  <span class="comment">// Looping 10 times.</span></div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_10[argc] = { <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(10) };</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv_10);</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(22, break_point_hit_count);</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;  <span class="comment">// Looping 100 times.</span></div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_100[argc] = { <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(100) };</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv_100);</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(202, break_point_hit_count);</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;}</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepFor) {</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;  <span class="comment">// Create a function for testing stepping. Run it to allow it to get</span></div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;  <span class="comment">// optimized.</span></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function foo(x) { &quot;</span></div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;                    <span class="stringliteral">&quot;  a = 1;&quot;</span></div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;                    <span class="stringliteral">&quot;  for (i = 0; i &lt; x; i++) {&quot;</span></div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;                    <span class="stringliteral">&quot;    b = 1;&quot;</span></div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;                    <span class="stringliteral">&quot;  }&quot;</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;                    <span class="stringliteral">&quot;}&quot;</span></div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;                    <span class="stringliteral">&quot;a=0; b=0; i=0; foo()&quot;</span>;</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;  SetBreakPoint(foo, 8);  <span class="comment">// &quot;a = 1;&quot;</span></div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;  <span class="comment">// Looping 10 times.</span></div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_10[argc] = { <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(10) };</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv_10);</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(23, break_point_hit_count);</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;  <span class="comment">// Looping 100 times.</span></div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_100[argc] = { <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(100) };</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv_100);</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(203, break_point_hit_count);</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;}</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepForContinue) {</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;  <span class="comment">// Create a function for testing stepping. Run it to allow it to get</span></div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;  <span class="comment">// optimized.</span></div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function foo(x) { &quot;</span></div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;                    <span class="stringliteral">&quot;  var a = 0;&quot;</span></div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;                    <span class="stringliteral">&quot;  var b = 0;&quot;</span></div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;                    <span class="stringliteral">&quot;  var c = 0;&quot;</span></div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;                    <span class="stringliteral">&quot;  for (var i = 0; i &lt; x; i++) {&quot;</span></div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;                    <span class="stringliteral">&quot;    a++;&quot;</span></div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;                    <span class="stringliteral">&quot;    if (a % 2 == 0) continue;&quot;</span></div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;                    <span class="stringliteral">&quot;    b++;&quot;</span></div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;                    <span class="stringliteral">&quot;    c++;&quot;</span></div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;                    <span class="stringliteral">&quot;  }&quot;</span></div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;                    <span class="stringliteral">&quot;  return b;&quot;</span></div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;                    <span class="stringliteral">&quot;}&quot;</span></div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;                    <span class="stringliteral">&quot;foo()&quot;</span>;</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result;</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;  SetBreakPoint(foo, 8);  <span class="comment">// &quot;var a = 0;&quot;</span></div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;  <span class="comment">// Each loop generates 4 or 5 steps depending on whether a is equal.</span></div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;  <span class="comment">// Looping 10 times.</span></div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_10[argc] = { <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(10) };</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;  result = foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv_10);</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(5, result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a3837d763158f1718969858a513670c62">Int32Value</a>());</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(51, break_point_hit_count);</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;  <span class="comment">// Looping 100 times.</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_100[argc] = { <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(100) };</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;  result = foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv_100);</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(50, result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a3837d763158f1718969858a513670c62">Int32Value</a>());</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(456, break_point_hit_count);</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;}</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepForBreak) {</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;  <span class="comment">// Create a function for testing stepping. Run it to allow it to get</span></div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;  <span class="comment">// optimized.</span></div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function foo(x) { &quot;</span></div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;                    <span class="stringliteral">&quot;  var a = 0;&quot;</span></div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;                    <span class="stringliteral">&quot;  var b = 0;&quot;</span></div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;                    <span class="stringliteral">&quot;  var c = 0;&quot;</span></div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;                    <span class="stringliteral">&quot;  for (var i = 0; i &lt; 1000; i++) {&quot;</span></div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;                    <span class="stringliteral">&quot;    a++;&quot;</span></div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;                    <span class="stringliteral">&quot;    if (a == x) break;&quot;</span></div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;                    <span class="stringliteral">&quot;    b++;&quot;</span></div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;                    <span class="stringliteral">&quot;    c++;&quot;</span></div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;                    <span class="stringliteral">&quot;  }&quot;</span></div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;                    <span class="stringliteral">&quot;  return b;&quot;</span></div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;                    <span class="stringliteral">&quot;}&quot;</span></div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;                    <span class="stringliteral">&quot;foo()&quot;</span>;</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result;</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;  SetBreakPoint(foo, 8);  <span class="comment">// &quot;var a = 0;&quot;</span></div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;  <span class="comment">// Each loop generates 5 steps except for the last (when break is executed)</span></div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;  <span class="comment">// which only generates 4.</span></div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;  <span class="comment">// Looping 10 times.</span></div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_10[argc] = { <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(10) };</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;  result = foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv_10);</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(9, result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a3837d763158f1718969858a513670c62">Int32Value</a>());</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(54, break_point_hit_count);</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;  <span class="comment">// Looping 100 times.</span></div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_100[argc] = { <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(100) };</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;  result = foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv_100);</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(99, result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a3837d763158f1718969858a513670c62">Int32Value</a>());</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(504, break_point_hit_count);</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;}</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepForIn) {</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;  <span class="comment">// Create a function for testing stepping. Run it to allow it to get</span></div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;  <span class="comment">// optimized.</span></div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> <a class="code" href="../../d6/df1/test-accessors_8cc.html#a819b717d29c6c488a332fefeeb3815ba">foo</a>;</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src_1 = <span class="stringliteral">&quot;function foo() { &quot;</span></div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;                      <span class="stringliteral">&quot;  var a = [1, 2];&quot;</span></div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;                      <span class="stringliteral">&quot;  for (x in a) {&quot;</span></div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;                      <span class="stringliteral">&quot;    b = 0;&quot;</span></div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;                      <span class="stringliteral">&quot;  }&quot;</span></div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;                      <span class="stringliteral">&quot;}&quot;</span></div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;                      <span class="stringliteral">&quot;foo()&quot;</span>;</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;  foo = CompileFunction(&amp;env, src_1, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;  SetBreakPoint(foo, 0);  <span class="comment">// &quot;var a = ...&quot;</span></div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(6, break_point_hit_count);</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;  <span class="comment">// Create a function for testing stepping. Run it to allow it to get</span></div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;  <span class="comment">// optimized.</span></div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src_2 = <span class="stringliteral">&quot;function foo() { &quot;</span></div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;                      <span class="stringliteral">&quot;  var a = {a:[1, 2, 3]};&quot;</span></div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;                      <span class="stringliteral">&quot;  for (x in a.a) {&quot;</span></div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;                      <span class="stringliteral">&quot;    b = 0;&quot;</span></div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;                      <span class="stringliteral">&quot;  }&quot;</span></div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;                      <span class="stringliteral">&quot;}&quot;</span></div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;                      <span class="stringliteral">&quot;foo()&quot;</span>;</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;  foo = CompileFunction(&amp;env, src_2, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;  SetBreakPoint(foo, 0);  <span class="comment">// &quot;var a = ...&quot;</span></div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(8, break_point_hit_count);</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;}</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepWith) {</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;  <span class="comment">// Create a function for testing stepping. Run it to allow it to get</span></div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;  <span class="comment">// optimized.</span></div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function foo(x) { &quot;</span></div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;                    <span class="stringliteral">&quot;  var a = {};&quot;</span></div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;                    <span class="stringliteral">&quot;  with (a) {}&quot;</span></div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;                    <span class="stringliteral">&quot;  with (b) {}&quot;</span></div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;                    <span class="stringliteral">&quot;}&quot;</span></div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;                    <span class="stringliteral">&quot;foo()&quot;</span>;</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;  env-&gt;Global()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;b&quot;</span>), <a class="code" href="../../db/d85/classv8_1_1_object.html#aa5f1e3dc29693910853bcb6ae1d14f84">v8::Object::New</a>());</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result;</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;  SetBreakPoint(foo, 8);  <span class="comment">// &quot;var a = {};&quot;</span></div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(4, break_point_hit_count);</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;}</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugConditional) {</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;  <span class="comment">// Create a function for testing stepping. Run it to allow it to get</span></div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;  <span class="comment">// optimized.</span></div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function foo(x) { &quot;</span></div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;                    <span class="stringliteral">&quot;  var a;&quot;</span></div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;                    <span class="stringliteral">&quot;  a = x ? 1 : 2;&quot;</span></div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;                    <span class="stringliteral">&quot;  return a;&quot;</span></div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;                    <span class="stringliteral">&quot;}&quot;</span></div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;                    <span class="stringliteral">&quot;foo()&quot;</span>;</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;  SetBreakPoint(foo, 0);  <span class="comment">// &quot;var a;&quot;</span></div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(5, break_point_hit_count);</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv_true[argc] = { <a class="code" href="../../d2/dc3/namespacev8.html#a50252b3ef3537127f61f73c2d3888092">v8::True</a>() };</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv_true);</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(5, break_point_hit_count);</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;}</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(StepInOutSimple) {</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;  <span class="comment">// Create a function for checking the function when hitting a break point.</span></div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;  frame_function_name = CompileFunction(&amp;env,</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;                                        frame_function_name_source,</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;                                        <span class="stringliteral">&quot;frame_function_name&quot;</span>);</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStepSequence);</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;  <span class="comment">// Create a function for testing stepping. Run it to allow it to get</span></div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;  <span class="comment">// optimized.</span></div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function a() {b();c();}; &quot;</span></div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;                    <span class="stringliteral">&quot;function b() {c();}; &quot;</span></div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;                    <span class="stringliteral">&quot;function c() {}; &quot;</span></div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;                    <span class="stringliteral">&quot;a(); b(); c()&quot;</span>;</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> a = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;a&quot;</span>);</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;  SetBreakPoint(a, 0);</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;  <span class="comment">// Step through invocation of a with step in.</span></div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;  expected_step_sequence = <span class="stringliteral">&quot;abcbaca&quot;</span>;</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;  a-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(expected_step_sequence),</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;           break_point_hit_count);</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;  <span class="comment">// Step through invocation of a with step next.</span></div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;  step_action = StepNext;</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;  expected_step_sequence = <span class="stringliteral">&quot;aaa&quot;</span>;</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;  a-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(expected_step_sequence),</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;           break_point_hit_count);</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;  <span class="comment">// Step through invocation of a with step out.</span></div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;  step_action = StepOut;</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;  expected_step_sequence = <span class="stringliteral">&quot;a&quot;</span>;</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;  a-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(expected_step_sequence),</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;           break_point_hit_count);</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;}</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(StepInOutTree) {</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;  <span class="comment">// Create a function for checking the function when hitting a break point.</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;  frame_function_name = CompileFunction(&amp;env,</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;                                        frame_function_name_source,</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;                                        <span class="stringliteral">&quot;frame_function_name&quot;</span>);</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStepSequence);</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;  <span class="comment">// Create a function for testing stepping. Run it to allow it to get</span></div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;  <span class="comment">// optimized.</span></div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function a() {b(c(d()),d());c(d());d()}; &quot;</span></div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;                    <span class="stringliteral">&quot;function b(x,y) {c();}; &quot;</span></div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;                    <span class="stringliteral">&quot;function c(x) {}; &quot;</span></div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;                    <span class="stringliteral">&quot;function d() {}; &quot;</span></div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;                    <span class="stringliteral">&quot;a(); b(); c(); d()&quot;</span>;</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> a = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;a&quot;</span>);</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;  SetBreakPoint(a, 0);</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;  <span class="comment">// Step through invocation of a with step in.</span></div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;  expected_step_sequence = <span class="stringliteral">&quot;adacadabcbadacada&quot;</span>;</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;  a-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(expected_step_sequence),</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;           break_point_hit_count);</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;  <span class="comment">// Step through invocation of a with step next.</span></div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;  step_action = StepNext;</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;  expected_step_sequence = <span class="stringliteral">&quot;aaaa&quot;</span>;</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;  a-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(expected_step_sequence),</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;           break_point_hit_count);</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;  <span class="comment">// Step through invocation of a with step out.</span></div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;  step_action = StepOut;</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;  expected_step_sequence = <span class="stringliteral">&quot;a&quot;</span>;</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;  a-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(expected_step_sequence),</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;           break_point_hit_count);</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;  CheckDebuggerUnloaded(<span class="keyword">true</span>);</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;}</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(StepInOutBranch) {</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;  <span class="comment">// Create a function for checking the function when hitting a break point.</span></div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;  frame_function_name = CompileFunction(&amp;env,</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;                                        frame_function_name_source,</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;                                        <span class="stringliteral">&quot;frame_function_name&quot;</span>);</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStepSequence);</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;  <span class="comment">// Create a function for testing stepping. Run it to allow it to get</span></div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;  <span class="comment">// optimized.</span></div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function a() {b(false);c();}; &quot;</span></div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;                    <span class="stringliteral">&quot;function b(x) {if(x){c();};}; &quot;</span></div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;                    <span class="stringliteral">&quot;function c() {}; &quot;</span></div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;                    <span class="stringliteral">&quot;a(); b(); c()&quot;</span>;</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> a = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;a&quot;</span>);</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;  SetBreakPoint(a, 0);</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;  <span class="comment">// Step through invocation of a.</span></div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;  expected_step_sequence = <span class="stringliteral">&quot;abbaca&quot;</span>;</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;  a-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(expected_step_sequence),</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;           break_point_hit_count);</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;}</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;<span class="comment">// Test that step in does not step into native functions.</span></div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepNatives) {</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;  <span class="comment">// Create a function for testing stepping.</span></div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;      &amp;env,</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;      <span class="stringliteral">&quot;function foo(){debugger;Math.sin(1);}&quot;</span>,</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;      <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;  <span class="comment">// With stepping all break locations are hit.</span></div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, break_point_hit_count);</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;  <span class="comment">// Register a debug event listener which just counts.</span></div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount);</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;  <span class="comment">// Without stepping only active break points are hit.</span></div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;}</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;<span class="comment">// Test that step in works with function.apply.</span></div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepFunctionApply) {</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;  <span class="comment">// Create a function for testing stepping.</span></div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;      &amp;env,</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;      <span class="stringliteral">&quot;function bar(x, y, z) { if (x == 1) { a = y; b = z; } }&quot;</span></div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;      <span class="stringliteral">&quot;function foo(){ debugger; bar.apply(this, [1,2,3]); }&quot;</span>,</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;      <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;  <span class="comment">// With stepping all break locations are hit.</span></div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(7, break_point_hit_count);</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;  <span class="comment">// Register a debug event listener which just counts.</span></div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount);</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;  <span class="comment">// Without stepping only the debugger statement is hit.</span></div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;}</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;<span class="comment">// Test that step in works with function.call.</span></div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugStepFunctionCall) {</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;  <span class="comment">// Create a function for testing stepping.</span></div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;      &amp;env,</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;      <span class="stringliteral">&quot;function bar(x, y, z) { if (x == 1) { a = y; b = z; } }&quot;</span></div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;      <span class="stringliteral">&quot;function foo(a){ debugger;&quot;</span></div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;      <span class="stringliteral">&quot;                 if (a) {&quot;</span></div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;      <span class="stringliteral">&quot;                   bar.call(this, 1, 2, 3);&quot;</span></div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;      <span class="stringliteral">&quot;                 } else {&quot;</span></div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;      <span class="stringliteral">&quot;                   bar.call(this, 0);&quot;</span></div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;      <span class="stringliteral">&quot;                 }&quot;</span></div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;      <span class="stringliteral">&quot;}&quot;</span>,</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;      <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStep);</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;  <span class="comment">// Check stepping where the if condition in bar is false.</span></div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(6, break_point_hit_count);</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;  <span class="comment">// Check stepping where the if condition in bar is true.</span></div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv[argc] = { <a class="code" href="../../d2/dc3/namespacev8.html#a50252b3ef3537127f61f73c2d3888092">v8::True</a>() };</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv);</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(8, break_point_hit_count);</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;  <span class="comment">// Register a debug event listener which just counts.</span></div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount);</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;  <span class="comment">// Without stepping only the debugger statement is hit.</span></div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;}</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;<span class="comment">// Tests that breakpoint will be hit if it&#39;s set in script.</span></div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(PauseInScript) {</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;  <span class="comment">// Register a debug event listener which counts.</span></div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventCounter);</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;  <span class="comment">// Create a script that returns a function.</span></div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;(function (evt) {})&quot;</span>;</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* script_name = <span class="stringliteral">&quot;StepInHandlerTest&quot;</span>;</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;  <span class="comment">// Set breakpoint in the script.</span></div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;  SetScriptBreakPointByNameFromJS(script_name, 0, -1);</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;  <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a> origin(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(script_name), <a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(0));</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Script&gt;</a> script = <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(src),</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;                                                      &amp;origin);</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Value&gt;</a> r = script-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#ab937ef8dba07a7ef516f11ef83debf92">Run</a>();</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(r-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a1510d19d3b776197459ac9da4a0ae64f">IsFunction</a>());</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;}</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;<span class="comment">// Test break on exceptions. For each exception break combination the number</span></div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;<span class="comment">// of debug event exception callbacks and message callbacks are collected. The</span></div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;<span class="comment">// number of debug event exception callbacks are used to check that the</span></div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;<span class="comment">// debugger is called correctly and the number of message callbacks is used to</span></div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;<span class="comment">// check that uncaught exceptions are still returned even if there is a break</span></div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;<span class="comment">// for them.</span></div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(BreakOnException) {</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;  v8::internal::Isolate::Current()-&gt;TraceException(<span class="keyword">false</span>);</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;  <span class="comment">// Create functions for testing break on exception.</span></div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;  CompileFunction(&amp;env, <span class="stringliteral">&quot;function throws(){throw 1;}&quot;</span>, <span class="stringliteral">&quot;throws&quot;</span>);</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> caught =</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;      CompileFunction(&amp;env,</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;                      <span class="stringliteral">&quot;function caught(){try {throws();} catch(e) {};}&quot;</span>,</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;                      <span class="stringliteral">&quot;caught&quot;</span>);</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> notCaught =</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;      CompileFunction(&amp;env, <span class="stringliteral">&quot;function notCaught(){throws();}&quot;</span>, <span class="stringliteral">&quot;notCaught&quot;</span>);</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;  <a class="code" href="../../df/d43/classv8_1_1_v8.html#a07aa85791067a2785e0ba6c0f31c67c6">v8::V8::AddMessageListener</a>(MessageCallbackCount);</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventCounter);</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;  <span class="comment">// Initial state should be no break on exceptions.</span></div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;  DebugEventCounterClear();</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;  MessageCallbackCountClear();</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;  caught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, exception_hit_count);</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, message_callback_count);</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;  notCaught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, exception_hit_count);</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, message_callback_count);</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;  <span class="comment">// No break on exception</span></div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;  DebugEventCounterClear();</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;  MessageCallbackCountClear();</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;  ChangeBreakOnException(<span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;  caught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, exception_hit_count);</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, message_callback_count);</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;  notCaught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, exception_hit_count);</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, message_callback_count);</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;  <span class="comment">// Break on uncaught exception</span></div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;  DebugEventCounterClear();</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;  MessageCallbackCountClear();</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;  ChangeBreakOnException(<span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;  caught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, exception_hit_count);</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, message_callback_count);</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;  notCaught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, exception_hit_count);</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, message_callback_count);</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;  <span class="comment">// Break on exception and uncaught exception</span></div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;  DebugEventCounterClear();</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;  MessageCallbackCountClear();</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;  ChangeBreakOnException(<span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;  caught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, exception_hit_count);</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, message_callback_count);</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;  notCaught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, exception_hit_count);</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, message_callback_count);</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;  <span class="comment">// Break on exception</span></div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;  DebugEventCounterClear();</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;  MessageCallbackCountClear();</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;  ChangeBreakOnException(<span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;  caught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, exception_hit_count);</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, message_callback_count);</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;  notCaught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, exception_hit_count);</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, message_callback_count);</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;  <span class="comment">// No break on exception using JavaScript</span></div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;  DebugEventCounterClear();</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;  MessageCallbackCountClear();</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;  ChangeBreakOnExceptionFromJS(<span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;  caught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, exception_hit_count);</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, message_callback_count);</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;  notCaught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, exception_hit_count);</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, message_callback_count);</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;  <span class="comment">// Break on uncaught exception using JavaScript</span></div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;  DebugEventCounterClear();</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;  MessageCallbackCountClear();</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;  ChangeBreakOnExceptionFromJS(<span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;  caught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, exception_hit_count);</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, message_callback_count);</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;  notCaught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, exception_hit_count);</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, message_callback_count);</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;  <span class="comment">// Break on exception and uncaught exception using JavaScript</span></div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;  DebugEventCounterClear();</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;  MessageCallbackCountClear();</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;  ChangeBreakOnExceptionFromJS(<span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;  caught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, exception_hit_count);</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, message_callback_count);</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;  notCaught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, exception_hit_count);</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, message_callback_count);</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;  <span class="comment">// Break on exception using JavaScript</span></div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;  DebugEventCounterClear();</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;  MessageCallbackCountClear();</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;  ChangeBreakOnExceptionFromJS(<span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;  caught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, exception_hit_count);</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, message_callback_count);</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;  notCaught-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, exception_hit_count);</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, message_callback_count);</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;  <a class="code" href="../../df/d43/classv8_1_1_v8.html#ae61ffdc4886d3057e578e4e39420deb6">v8::V8::RemoveMessageListeners</a>(MessageCallbackCount);</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;}</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;<span class="comment">// Test break on exception from compiler errors. When compiling using</span></div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;<span class="comment">// v8::Script::Compile there is no JavaScript stack whereas when compiling using</span></div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;<span class="comment">// eval there are JavaScript frames.</span></div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(BreakOnCompileException) {</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;  <span class="comment">// For this test, we want to break on uncaught exceptions:</span></div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;  ChangeBreakOnException(<span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;  v8::internal::Isolate::Current()-&gt;TraceException(<span class="keyword">false</span>);</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;  <span class="comment">// Create a function for checking the function when hitting a break point.</span></div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;  frame_count = CompileFunction(&amp;env, frame_count_source, <span class="stringliteral">&quot;frame_count&quot;</span>);</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;  <a class="code" href="../../df/d43/classv8_1_1_v8.html#a07aa85791067a2785e0ba6c0f31c67c6">v8::V8::AddMessageListener</a>(MessageCallbackCount);</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventCounter);</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;  DebugEventCounterClear();</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;  MessageCallbackCountClear();</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;  <span class="comment">// Check initial state.</span></div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, exception_hit_count);</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, uncaught_exception_hit_count);</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, message_callback_count);</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(-1, last_js_stack_height);</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;  <span class="comment">// Throws SyntaxError: Unexpected end of input</span></div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;+++&quot;</span>));</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, exception_hit_count);</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, uncaught_exception_hit_count);</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, message_callback_count);</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, last_js_stack_height);  <span class="comment">// No JavaScript stack.</span></div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;  <span class="comment">// Throws SyntaxError: Unexpected identifier</span></div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;x x&quot;</span>));</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, exception_hit_count);</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, uncaught_exception_hit_count);</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, message_callback_count);</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, last_js_stack_height);  <span class="comment">// No JavaScript stack.</span></div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;  <span class="comment">// Throws SyntaxError: Unexpected end of input</span></div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;eval(&#39;+++&#39;)&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, exception_hit_count);</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, uncaught_exception_hit_count);</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, message_callback_count);</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, last_js_stack_height);</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;  <span class="comment">// Throws SyntaxError: Unexpected identifier</span></div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;eval(&#39;x x&#39;)&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(4, exception_hit_count);</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(4, uncaught_exception_hit_count);</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(4, message_callback_count);</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, last_js_stack_height);</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;}</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(StepWithException) {</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;  <span class="comment">// For this test, we want to break on uncaught exceptions:</span></div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;  ChangeBreakOnException(<span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;  <span class="comment">// Create a function for checking the function when hitting a break point.</span></div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;  frame_function_name = CompileFunction(&amp;env,</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;                                        frame_function_name_source,</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;                                        <span class="stringliteral">&quot;frame_function_name&quot;</span>);</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStepSequence);</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;  <span class="comment">// Create functions for testing stepping.</span></div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function a() { n(); }; &quot;</span></div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;                    <span class="stringliteral">&quot;function b() { c(); }; &quot;</span></div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;                    <span class="stringliteral">&quot;function c() { n(); }; &quot;</span></div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;                    <span class="stringliteral">&quot;function d() { x = 1; try { e(); } catch(x) { x = 2; } }; &quot;</span></div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;                    <span class="stringliteral">&quot;function e() { n(); }; &quot;</span></div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;                    <span class="stringliteral">&quot;function f() { x = 1; try { g(); } catch(x) { x = 2; } }; &quot;</span></div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;                    <span class="stringliteral">&quot;function g() { h(); }; &quot;</span></div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;                    <span class="stringliteral">&quot;function h() { x = 1; throw 1; }; &quot;</span>;</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;  <span class="comment">// Step through invocation of a.</span></div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> a = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;a&quot;</span>);</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;  SetBreakPoint(a, 0);</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;  expected_step_sequence = <span class="stringliteral">&quot;aa&quot;</span>;</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;  a-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(expected_step_sequence),</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;           break_point_hit_count);</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;  <span class="comment">// Step through invocation of b + c.</span></div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> b = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;b&quot;</span>);</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;  SetBreakPoint(b, 0);</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;  expected_step_sequence = <span class="stringliteral">&quot;bcc&quot;</span>;</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;  b-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(expected_step_sequence),</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;           break_point_hit_count);</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;  <span class="comment">// Step through invocation of d + e.</span></div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> d = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;d&quot;</span>);</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;  SetBreakPoint(d, 0);</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;  ChangeBreakOnException(<span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;  expected_step_sequence = <span class="stringliteral">&quot;ddedd&quot;</span>;</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;  d-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(expected_step_sequence),</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;           break_point_hit_count);</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;  <span class="comment">// Step through invocation of d + e now with break on caught exceptions.</span></div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;  ChangeBreakOnException(<span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;  expected_step_sequence = <span class="stringliteral">&quot;ddeedd&quot;</span>;</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;  d-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(expected_step_sequence),</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;           break_point_hit_count);</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;  <span class="comment">// Step through invocation of f + g + h.</span></div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;  SetBreakPoint(f, 0);</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;  ChangeBreakOnException(<span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;  expected_step_sequence = <span class="stringliteral">&quot;ffghhff&quot;</span>;</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(expected_step_sequence),</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;           break_point_hit_count);</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;  <span class="comment">// Step through invocation of f + g + h now with break on caught exceptions.</span></div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;  ChangeBreakOnException(<span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;  step_action = StepIn;</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;  expected_step_sequence = <span class="stringliteral">&quot;ffghhhff&quot;</span>;</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(expected_step_sequence),</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;           break_point_hit_count);</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;}</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugBreak) {</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;<span class="preprocessor">#ifdef VERIFY_HEAP</span></div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;  i::FLAG_verify_heap = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;  <span class="comment">// Register a debug event listener which sets the break flag and counts.</span></div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreak);</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;  <span class="comment">// Create a function for testing stepping.</span></div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function f0() {}&quot;</span></div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;                    <span class="stringliteral">&quot;function f1(x1) {}&quot;</span></div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;                    <span class="stringliteral">&quot;function f2(x1,x2) {}&quot;</span></div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;                    <span class="stringliteral">&quot;function f3(x1,x2,x3) {}&quot;</span>;</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a15abb08e993176799070e492e920cbd5">f0</a> = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;f0&quot;</span>);</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a62faa0b827a826722636f447051be4af">f1</a> = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;f1&quot;</span>);</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a61f71fa44dbac342ed3919921c4fc95b">f2</a> = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;f2&quot;</span>);</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a21939e1b7e98ec2dd612be4a0223d73f">f3</a> = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;f3&quot;</span>);</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;  <span class="comment">// Call the function to make sure it is compiled.</span></div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv[] = { <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(1),</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;                                   <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(1),</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;                                   <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(1),</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;                                   <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(1) };</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;  <span class="comment">// Call all functions to make sure that they are compiled.</span></div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;  f0-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;  f1-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;  f2-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;  f3-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;  <span class="comment">// Set the debug break flag.</span></div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;  <span class="comment">// Call all functions with different argument count.</span></div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d5/d87/globals_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(argv); i++) {</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;    f0-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), i, argv);</div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;    f1-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), i, argv);</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;    f2-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), i, argv);</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;    f3-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), i, argv);</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;  }</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;  <span class="comment">// One break for each function called.</span></div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(4 * <a class="code" href="../../d5/d87/globals_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(argv), break_point_hit_count);</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;}</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;<span class="comment">// Test to ensure that JavaScript code keeps running while the debug break</span></div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;<span class="comment">// through the stack limit flag is set but breaks are disabled.</span></div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DisableBreak) {</div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;  <span class="comment">// Register a debug event listener which sets the break flag and counts.</span></div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventCounter);</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;  <span class="comment">// Create a function for testing stepping.</span></div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function f() {g()};function g(){i=0; while(i&lt;10){i++}}&quot;</span>;</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;  <span class="comment">// Set the debug break flag.</span></div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;  <span class="comment">// Call all functions with different argument count.</span></div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;  {</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;    <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;    v8::internal::DisableBreak disable_break(<span class="keyword">true</span>);</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;    f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;  }</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;}</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* kSimpleExtensionSource =</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;  <span class="stringliteral">&quot;(function Foo() {&quot;</span></div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;  <span class="stringliteral">&quot;  return 4;&quot;</span></div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;  <span class="stringliteral">&quot;})() &quot;</span>;</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;<span class="comment">// http://crbug.com/28933</span></div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;<span class="comment">// Test that debug break is disabled when bootstrapper is active.</span></div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(NoBreakWhenBootstrapping) {</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;  <span class="comment">// Register a debug event listener which sets the break flag and counts.</span></div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventCounter);</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;  <span class="comment">// Set the debug break flag.</span></div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;  {</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;    <span class="comment">// Create a context with an extension to make sure that some JavaScript</span></div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;    <span class="comment">// code is executed during bootstrapping.</span></div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;    <a class="code" href="../../d2/dc3/namespacev8.html#a28fb95f8f3ce5a9f3ff7fc78bd2fd812">v8::RegisterExtension</a>(<span class="keyword">new</span> <a class="code" href="../../d9/da9/classv8_1_1_extension.html">v8::Extension</a>(<span class="stringliteral">&quot;simpletest&quot;</span>,</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;                                            kSimpleExtensionSource));</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* extension_names[] = { <span class="stringliteral">&quot;simpletest&quot;</span> };</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;    <a class="code" href="../../d2/d03/classv8_1_1_extension_configuration.html">v8::ExtensionConfiguration</a> extensions(1, extension_names);</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;    <a class="code" href="../../d2/d78/classv8_1_1_persistent.html">v8::Persistent&lt;v8::Context&gt;</a> context = <a class="code" href="../../df/d69/classv8_1_1_context.html#a860f2fec28426ee65e5aec8cbcb43478">v8::Context::New</a>(&amp;extensions);</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;    context.<a class="code" href="../../d2/d78/classv8_1_1_persistent.html#a6e2d745cdb7a7b983f861ed6a9a541a7">Dispose</a>();</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;  }</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;  <span class="comment">// Check that no DebugBreak events occured during the context creation.</span></div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;}</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Array&gt;</a> NamedEnum(<span class="keyword">const</span> <a class="code" href="../../da/d41/classv8_1_1_accessor_info.html">v8::AccessorInfo</a>&amp;) {</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Array&gt;</a> result = <a class="code" href="../../db/d85/classv8_1_1_object.html#aa5f1e3dc29693910853bcb6ae1d14f84">v8::Array::New</a>(3);</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;  result-&gt;<a class="code" href="../../db/d85/classv8_1_1_object.html#aa5e6d5c3ca70b2a1d52415eac4d528f2">Set</a>(<a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(0), <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;a&quot;</span>));</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;  result-&gt;<a class="code" href="../../db/d85/classv8_1_1_object.html#aa5e6d5c3ca70b2a1d52415eac4d528f2">Set</a>(<a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(1), <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;b&quot;</span>));</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;  result-&gt;<a class="code" href="../../db/d85/classv8_1_1_object.html#aa5e6d5c3ca70b2a1d52415eac4d528f2">Set</a>(<a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(2), <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;c&quot;</span>));</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;}</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Array&gt;</a> IndexedEnum(<span class="keyword">const</span> <a class="code" href="../../da/d41/classv8_1_1_accessor_info.html">v8::AccessorInfo</a>&amp;) {</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Array&gt;</a> result = <a class="code" href="../../db/d85/classv8_1_1_object.html#aa5f1e3dc29693910853bcb6ae1d14f84">v8::Array::New</a>(2);</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;  result-&gt;<a class="code" href="../../db/d85/classv8_1_1_object.html#aa5e6d5c3ca70b2a1d52415eac4d528f2">Set</a>(<a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(0), <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(1));</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;  result-&gt;<a class="code" href="../../db/d85/classv8_1_1_object.html#aa5e6d5c3ca70b2a1d52415eac4d528f2">Set</a>(<a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(1), <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(10));</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;}</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> NamedGetter(<a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> name,</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;                                         <span class="keyword">const</span> <a class="code" href="../../da/d41/classv8_1_1_accessor_info.html">v8::AccessorInfo</a>&amp; info) {</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;  <a class="code" href="../../d8/dcb/classv8_1_1_string_1_1_ascii_value.html">v8::String::AsciiValue</a> n(name);</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;  <span class="keywordflow">if</span> (strcmp(*n, <span class="stringliteral">&quot;a&quot;</span>) == 0) {</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;AA&quot;</span>);</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(*n, <span class="stringliteral">&quot;b&quot;</span>) == 0) {</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;BB&quot;</span>);</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(*n, <span class="stringliteral">&quot;c&quot;</span>) == 0) {</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;CC&quot;</span>);</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>();</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;  }</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;  <span class="keywordflow">return</span> name;</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;}</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> IndexedGetter(uint32_t index,</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;                                           <span class="keyword">const</span> <a class="code" href="../../da/d41/classv8_1_1_accessor_info.html">v8::AccessorInfo</a>&amp; info) {</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(index + 1);</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;}</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(InterceptorPropertyMirror) {</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;  <span class="comment">// Create a V8 environment with debug access.</span></div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;  <span class="comment">// Create object with named interceptor.</span></div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::ObjectTemplate&gt;</a> named = <a class="code" href="../../db/d5f/classv8_1_1_object_template.html#ada5e0fda7225c6a63c54f1d07bdc718c">v8::ObjectTemplate::New</a>();</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;  named-&gt;<a class="code" href="../../db/d5f/classv8_1_1_object_template.html#a21edabb159db29683a37ea2eef37f20c">SetNamedPropertyHandler</a>(NamedGetter, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, NamedEnum);</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;  env-&gt;Global()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;intercepted_named&quot;</span>),</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;                     named-&gt;<a class="code" href="../../db/d5f/classv8_1_1_object_template.html#afcc882983702100ce4f5550102b04ef4">NewInstance</a>());</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;  <span class="comment">// Create object with indexed interceptor.</span></div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::ObjectTemplate&gt;</a> indexed = <a class="code" href="../../db/d5f/classv8_1_1_object_template.html#ada5e0fda7225c6a63c54f1d07bdc718c">v8::ObjectTemplate::New</a>();</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;  indexed-&gt;<a class="code" href="../../db/d5f/classv8_1_1_object_template.html#ad3baf9d0959cbc49663a33718d7dd8a3">SetIndexedPropertyHandler</a>(IndexedGetter,</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;                                     <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>,</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;                                     <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>,</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;                                     <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>,</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;                                     IndexedEnum);</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;  env-&gt;Global()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;intercepted_indexed&quot;</span>),</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;                     indexed-&gt;<a class="code" href="../../db/d5f/classv8_1_1_object_template.html#afcc882983702100ce4f5550102b04ef4">NewInstance</a>());</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;  <span class="comment">// Create object with both named and indexed interceptor.</span></div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::ObjectTemplate&gt;</a> both = <a class="code" href="../../db/d5f/classv8_1_1_object_template.html#ada5e0fda7225c6a63c54f1d07bdc718c">v8::ObjectTemplate::New</a>();</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;  both-&gt;<a class="code" href="../../db/d5f/classv8_1_1_object_template.html#a21edabb159db29683a37ea2eef37f20c">SetNamedPropertyHandler</a>(NamedGetter, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, NamedEnum);</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;  both-&gt;<a class="code" href="../../db/d5f/classv8_1_1_object_template.html#ad3baf9d0959cbc49663a33718d7dd8a3">SetIndexedPropertyHandler</a>(IndexedGetter, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, IndexedEnum);</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;  env-&gt;Global()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;intercepted_both&quot;</span>), both-&gt;<a class="code" href="../../db/d5f/classv8_1_1_object_template.html#afcc882983702100ce4f5550102b04ef4">NewInstance</a>());</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;  <span class="comment">// Get mirrors for the three objects with interceptor.</span></div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;  CompileRun(</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;      <span class="stringliteral">&quot;var named_mirror = debug.MakeMirror(intercepted_named);&quot;</span></div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;      <span class="stringliteral">&quot;var indexed_mirror = debug.MakeMirror(intercepted_indexed);&quot;</span></div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;      <span class="stringliteral">&quot;var both_mirror = debug.MakeMirror(intercepted_both)&quot;</span>);</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;       <span class="stringliteral">&quot;named_mirror instanceof debug.ObjectMirror&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;        <span class="stringliteral">&quot;indexed_mirror instanceof debug.ObjectMirror&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;        <span class="stringliteral">&quot;both_mirror instanceof debug.ObjectMirror&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;  <span class="comment">// Get the property names from the interceptors</span></div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;  CompileRun(</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;      <span class="stringliteral">&quot;named_names = named_mirror.propertyNames();&quot;</span></div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;      <span class="stringliteral">&quot;indexed_names = indexed_mirror.propertyNames();&quot;</span></div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;      <span class="stringliteral">&quot;both_names = both_mirror.propertyNames()&quot;</span>);</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, CompileRun(<span class="stringliteral">&quot;named_names.length&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, CompileRun(<span class="stringliteral">&quot;indexed_names.length&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(5, CompileRun(<span class="stringliteral">&quot;both_names.length&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;  <span class="comment">// Check the expected number of properties.</span></div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* source;</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;  source = <span class="stringliteral">&quot;named_mirror.properties().length&quot;</span>;</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, CompileRun(source)-&gt;Int32Value());</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;  source = <span class="stringliteral">&quot;indexed_mirror.properties().length&quot;</span>;</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, CompileRun(source)-&gt;Int32Value());</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;  source = <span class="stringliteral">&quot;both_mirror.properties().length&quot;</span>;</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(5, CompileRun(source)-&gt;Int32Value());</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;  <span class="comment">// 1 is PropertyKind.Named;</span></div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;  source = <span class="stringliteral">&quot;both_mirror.properties(1).length&quot;</span>;</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, CompileRun(source)-&gt;Int32Value());</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;  <span class="comment">// 2 is PropertyKind.Indexed;</span></div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;  source = <span class="stringliteral">&quot;both_mirror.properties(2).length&quot;</span>;</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, CompileRun(source)-&gt;Int32Value());</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;  <span class="comment">// 3 is PropertyKind.Named  | PropertyKind.Indexed;</span></div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;  source = <span class="stringliteral">&quot;both_mirror.properties(3).length&quot;</span>;</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(5, CompileRun(source)-&gt;Int32Value());</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;  <span class="comment">// Get the interceptor properties for the object with only named interceptor.</span></div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;  CompileRun(<span class="stringliteral">&quot;var named_values = named_mirror.properties()&quot;</span>);</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;  <span class="comment">// Check that the properties are interceptor properties.</span></div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;    EmbeddedVector&lt;char, SMALL_STRING_BUFFER_SIZE&gt; buffer;</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;    OS::SNPrintF(buffer,</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;                 <span class="stringliteral">&quot;named_values[%d] instanceof debug.PropertyMirror&quot;</span>, i);</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(buffer.start())-&gt;BooleanValue());</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;    OS::SNPrintF(buffer, <span class="stringliteral">&quot;named_values[%d].propertyType()&quot;</span>, i);</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a7ff5a5c54f182b86d1cd993cf4512c87a65a864c610bdf664db1a858a3baa22d8">v8::internal::INTERCEPTOR</a>,</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;             CompileRun(buffer.start())-&gt;Int32Value());</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;    OS::SNPrintF(buffer, <span class="stringliteral">&quot;named_values[%d].isNative()&quot;</span>, i);</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(buffer.start())-&gt;BooleanValue());</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;  }</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;  <span class="comment">// Get the interceptor properties for the object with only indexed</span></div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;  <span class="comment">// interceptor.</span></div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;  CompileRun(<span class="stringliteral">&quot;var indexed_values = indexed_mirror.properties()&quot;</span>);</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;  <span class="comment">// Check that the properties are interceptor properties.</span></div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++) {</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;    EmbeddedVector&lt;char, SMALL_STRING_BUFFER_SIZE&gt; buffer;</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;    OS::SNPrintF(buffer,</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;                 <span class="stringliteral">&quot;indexed_values[%d] instanceof debug.PropertyMirror&quot;</span>, i);</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(buffer.start())-&gt;BooleanValue());</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;  }</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;  <span class="comment">// Get the interceptor properties for the object with both types of</span></div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;  <span class="comment">// interceptors.</span></div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;  CompileRun(<span class="stringliteral">&quot;var both_values = both_mirror.properties()&quot;</span>);</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;  <span class="comment">// Check that the properties are interceptor properties.</span></div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 5; i++) {</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;    EmbeddedVector&lt;char, SMALL_STRING_BUFFER_SIZE&gt; buffer;</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;    OS::SNPrintF(buffer, <span class="stringliteral">&quot;both_values[%d] instanceof debug.PropertyMirror&quot;</span>, i);</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(buffer.start())-&gt;BooleanValue());</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;  }</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;  <span class="comment">// Check the property names.</span></div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;  source = <span class="stringliteral">&quot;both_values[0].name() == &#39;a&#39;&quot;</span>;</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(source)-&gt;BooleanValue());</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;  source = <span class="stringliteral">&quot;both_values[1].name() == &#39;b&#39;&quot;</span>;</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(source)-&gt;BooleanValue());</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;  source = <span class="stringliteral">&quot;both_values[2].name() == &#39;c&#39;&quot;</span>;</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(source)-&gt;BooleanValue());</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;  source = <span class="stringliteral">&quot;both_values[3].name() == 1&quot;</span>;</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(source)-&gt;BooleanValue());</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;  source = <span class="stringliteral">&quot;both_values[4].name() == 10&quot;</span>;</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(source)-&gt;BooleanValue());</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;}</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(HiddenPrototypePropertyMirror) {</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;  <span class="comment">// Create a V8 environment with debug access.</span></div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::FunctionTemplate&gt;</a> t0 = <a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a3b5a2868860b0414c3607f6cf1567b78">v8::FunctionTemplate::New</a>();</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;  t0-&gt;<a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a7f38518da88507c8f2580b7ecb35317c">InstanceTemplate</a>()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;x&quot;</span>), <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(0));</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::FunctionTemplate&gt;</a> t1 = <a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a3b5a2868860b0414c3607f6cf1567b78">v8::FunctionTemplate::New</a>();</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;  t1-&gt;<a class="code" href="../../d8/d83/classv8_1_1_function_template.html#ac7b86dfd4d1ed73a4a6aac7d2de8a20b">SetHiddenPrototype</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;  t1-&gt;<a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a7f38518da88507c8f2580b7ecb35317c">InstanceTemplate</a>()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;y&quot;</span>), <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(1));</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::FunctionTemplate&gt;</a> t2 = <a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a3b5a2868860b0414c3607f6cf1567b78">v8::FunctionTemplate::New</a>();</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;  t2-&gt;<a class="code" href="../../d8/d83/classv8_1_1_function_template.html#ac7b86dfd4d1ed73a4a6aac7d2de8a20b">SetHiddenPrototype</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;  t2-&gt;<a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a7f38518da88507c8f2580b7ecb35317c">InstanceTemplate</a>()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;z&quot;</span>), <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(2));</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::FunctionTemplate&gt;</a> t3 = <a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a3b5a2868860b0414c3607f6cf1567b78">v8::FunctionTemplate::New</a>();</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;  t3-&gt;<a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a7f38518da88507c8f2580b7ecb35317c">InstanceTemplate</a>()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;u&quot;</span>), <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(3));</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;  <span class="comment">// Create object and set them on the global object.</span></div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> o0 = t0-&gt;<a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a7d1eef8a098a7467763f8c17f37b2d0d">GetFunction</a>()-&gt;NewInstance();</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;  env-&gt;Global()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;o0&quot;</span>), o0);</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> o1 = t1-&gt;<a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a7d1eef8a098a7467763f8c17f37b2d0d">GetFunction</a>()-&gt;NewInstance();</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;  env-&gt;Global()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;o1&quot;</span>), o1);</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> o2 = t2-&gt;<a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a7d1eef8a098a7467763f8c17f37b2d0d">GetFunction</a>()-&gt;NewInstance();</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;  env-&gt;Global()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;o2&quot;</span>), o2);</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> o3 = t3-&gt;<a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a7d1eef8a098a7467763f8c17f37b2d0d">GetFunction</a>()-&gt;NewInstance();</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;  env-&gt;Global()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;o3&quot;</span>), o3);</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;  <span class="comment">// Get mirrors for the four objects.</span></div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;  CompileRun(</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;      <span class="stringliteral">&quot;var o0_mirror = debug.MakeMirror(o0);&quot;</span></div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;      <span class="stringliteral">&quot;var o1_mirror = debug.MakeMirror(o1);&quot;</span></div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;      <span class="stringliteral">&quot;var o2_mirror = debug.MakeMirror(o2);&quot;</span></div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;      <span class="stringliteral">&quot;var o3_mirror = debug.MakeMirror(o3)&quot;</span>);</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(<span class="stringliteral">&quot;o0_mirror instanceof debug.ObjectMirror&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(<span class="stringliteral">&quot;o1_mirror instanceof debug.ObjectMirror&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(<span class="stringliteral">&quot;o2_mirror instanceof debug.ObjectMirror&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(<span class="stringliteral">&quot;o3_mirror instanceof debug.ObjectMirror&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;  <span class="comment">// Check that each object has one property.</span></div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, CompileRun(</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;              <span class="stringliteral">&quot;o0_mirror.propertyNames().length&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, CompileRun(</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;              <span class="stringliteral">&quot;o1_mirror.propertyNames().length&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, CompileRun(</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;              <span class="stringliteral">&quot;o2_mirror.propertyNames().length&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, CompileRun(</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;              <span class="stringliteral">&quot;o3_mirror.propertyNames().length&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;  <span class="comment">// Set o1 as prototype for o0. o1 has the hidden prototype flag so all</span></div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;  <span class="comment">// properties on o1 should be seen on o0.</span></div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;  o0-&gt;<a class="code" href="../../db/d85/classv8_1_1_object.html#aa5e6d5c3ca70b2a1d52415eac4d528f2">Set</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;__proto__&quot;</span>), o1);</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, CompileRun(</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;              <span class="stringliteral">&quot;o0_mirror.propertyNames().length&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, CompileRun(</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;              <span class="stringliteral">&quot;o0_mirror.property(&#39;x&#39;).value().value()&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, CompileRun(</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;              <span class="stringliteral">&quot;o0_mirror.property(&#39;y&#39;).value().value()&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;  <span class="comment">// Set o2 as prototype for o0 (it will end up after o1 as o1 has the hidden</span></div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;  <span class="comment">// prototype flag. o2 also has the hidden prototype flag so all properties</span></div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;  <span class="comment">// on o2 should be seen on o0 as well as properties on o1.</span></div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;  o0-&gt;<a class="code" href="../../db/d85/classv8_1_1_object.html#aa5e6d5c3ca70b2a1d52415eac4d528f2">Set</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;__proto__&quot;</span>), o2);</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, CompileRun(</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;              <span class="stringliteral">&quot;o0_mirror.propertyNames().length&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, CompileRun(</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;              <span class="stringliteral">&quot;o0_mirror.property(&#39;x&#39;).value().value()&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, CompileRun(</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;              <span class="stringliteral">&quot;o0_mirror.property(&#39;y&#39;).value().value()&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, CompileRun(</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;              <span class="stringliteral">&quot;o0_mirror.property(&#39;z&#39;).value().value()&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;  <span class="comment">// Set o3 as prototype for o0 (it will end up after o1 and o2 as both o1 and</span></div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;  <span class="comment">// o2 has the hidden prototype flag. o3 does not have the hidden prototype</span></div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;  <span class="comment">// flag so properties on o3 should not be seen on o0 whereas the properties</span></div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;  <span class="comment">// from o1 and o2 should still be seen on o0.</span></div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;  <span class="comment">// Final prototype chain: o0 -&gt; o1 -&gt; o2 -&gt; o3</span></div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;  <span class="comment">// Hidden prototypes:           ^^    ^^</span></div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;  o0-&gt;<a class="code" href="../../db/d85/classv8_1_1_object.html#aa5e6d5c3ca70b2a1d52415eac4d528f2">Set</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;__proto__&quot;</span>), o3);</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, CompileRun(</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;              <span class="stringliteral">&quot;o0_mirror.propertyNames().length&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, CompileRun(</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;              <span class="stringliteral">&quot;o3_mirror.propertyNames().length&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, CompileRun(</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;              <span class="stringliteral">&quot;o0_mirror.property(&#39;x&#39;).value().value()&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, CompileRun(</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;              <span class="stringliteral">&quot;o0_mirror.property(&#39;y&#39;).value().value()&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, CompileRun(</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;              <span class="stringliteral">&quot;o0_mirror.property(&#39;z&#39;).value().value()&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(<span class="stringliteral">&quot;o0_mirror.property(&#39;u&#39;).isUndefined()&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;  <span class="comment">// The prototype (__proto__) for o0 should be o3 as o1 and o2 are hidden.</span></div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(<span class="stringliteral">&quot;o0_mirror.protoObject() == o3_mirror&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;}</div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;</div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;</div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> ProtperyXNativeGetter(</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;    <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> property, <span class="keyword">const</span> <a class="code" href="../../da/d41/classv8_1_1_accessor_info.html">v8::AccessorInfo</a>&amp; info) {</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(10);</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;}</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(NativeGetterPropertyMirror) {</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;  <span class="comment">// Create a V8 environment with debug access.</span></div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;</div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> name = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;x&quot;</span>);</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;  <span class="comment">// Create object with named accessor.</span></div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::ObjectTemplate&gt;</a> named = <a class="code" href="../../db/d5f/classv8_1_1_object_template.html#ada5e0fda7225c6a63c54f1d07bdc718c">v8::ObjectTemplate::New</a>();</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;  named-&gt;<a class="code" href="../../db/d5f/classv8_1_1_object_template.html#a15549aa25e1ad60c23f086170841c482">SetAccessor</a>(name, &amp;ProtperyXNativeGetter, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>,</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a>(), <a class="code" href="../../d2/dc3/namespacev8.html#a2e9a0288e6c2df2ecebc50944c3ff9faa88ec7d5086d2469ba843c7fcceade8a6">v8::DEFAULT</a>, <a class="code" href="../../d2/dc3/namespacev8.html#aa944500afca8000fffef41951b9f2660ac9d3e887722f2bc482bcca9d41c512af">v8::None</a>);</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;  <span class="comment">// Create object with named property getter.</span></div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;  env-&gt;Global()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;instance&quot;</span>), named-&gt;<a class="code" href="../../db/d5f/classv8_1_1_object_template.html#afcc882983702100ce4f5550102b04ef4">NewInstance</a>());</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(10, CompileRun(<span class="stringliteral">&quot;instance.x&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;  <span class="comment">// Get mirror for the object with property getter.</span></div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;  CompileRun(<span class="stringliteral">&quot;var instance_mirror = debug.MakeMirror(instance);&quot;</span>);</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;      <span class="stringliteral">&quot;instance_mirror instanceof debug.ObjectMirror&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;  CompileRun(<span class="stringliteral">&quot;var named_names = instance_mirror.propertyNames();&quot;</span>);</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, CompileRun(<span class="stringliteral">&quot;named_names.length&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(<span class="stringliteral">&quot;named_names[0] == &#39;x&#39;&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;      <span class="stringliteral">&quot;instance_mirror.property(&#39;x&#39;).value().isNumber()&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;      <span class="stringliteral">&quot;instance_mirror.property(&#39;x&#39;).value().value() == 10&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;}</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> ProtperyXNativeGetterThrowingError(</div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;    <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> property, <span class="keyword">const</span> <a class="code" href="../../da/d41/classv8_1_1_accessor_info.html">v8::AccessorInfo</a>&amp; info) {</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;  <span class="keywordflow">return</span> CompileRun(<span class="stringliteral">&quot;throw new Error(&#39;Error message&#39;);&quot;</span>);</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;}</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(NativeGetterThrowingErrorPropertyMirror) {</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;  <span class="comment">// Create a V8 environment with debug access.</span></div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> name = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;x&quot;</span>);</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;  <span class="comment">// Create object with named accessor.</span></div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::ObjectTemplate&gt;</a> named = <a class="code" href="../../db/d5f/classv8_1_1_object_template.html#ada5e0fda7225c6a63c54f1d07bdc718c">v8::ObjectTemplate::New</a>();</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;  named-&gt;<a class="code" href="../../db/d5f/classv8_1_1_object_template.html#a15549aa25e1ad60c23f086170841c482">SetAccessor</a>(name, &amp;ProtperyXNativeGetterThrowingError, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>,</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a>(), <a class="code" href="../../d2/dc3/namespacev8.html#a2e9a0288e6c2df2ecebc50944c3ff9faa88ec7d5086d2469ba843c7fcceade8a6">v8::DEFAULT</a>, <a class="code" href="../../d2/dc3/namespacev8.html#aa944500afca8000fffef41951b9f2660ac9d3e887722f2bc482bcca9d41c512af">v8::None</a>);</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;  <span class="comment">// Create object with named property getter.</span></div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;  env-&gt;Global()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;instance&quot;</span>), named-&gt;<a class="code" href="../../db/d5f/classv8_1_1_object_template.html#afcc882983702100ce4f5550102b04ef4">NewInstance</a>());</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;  <span class="comment">// Get mirror for the object with property getter.</span></div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;  CompileRun(<span class="stringliteral">&quot;var instance_mirror = debug.MakeMirror(instance);&quot;</span>);</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(</div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;      <span class="stringliteral">&quot;instance_mirror instanceof debug.ObjectMirror&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;  CompileRun(<span class="stringliteral">&quot;named_names = instance_mirror.propertyNames();&quot;</span>);</div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, CompileRun(<span class="stringliteral">&quot;named_names.length&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(<span class="stringliteral">&quot;named_names[0] == &#39;x&#39;&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;      <span class="stringliteral">&quot;instance_mirror.property(&#39;x&#39;).value().isError()&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;  <span class="comment">// Check that the message is that passed to the Error constructor.</span></div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(</div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;      <span class="stringliteral">&quot;instance_mirror.property(&#39;x&#39;).value().message() == &#39;Error message&#39;&quot;</span>)-&gt;</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;          BooleanValue());</div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;}</div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;</div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;<span class="comment">// Test that hidden properties object is not returned as an unnamed property</span></div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;<span class="comment">// among regular properties.</span></div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;<span class="comment">// See http://crbug.com/26491</span></div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(NoHiddenProperties) {</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;  <span class="comment">// Create a V8 environment with debug access.</span></div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;  <span class="comment">// Create an object in the global scope.</span></div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* source = <span class="stringliteral">&quot;var obj = {a: 1};&quot;</span>;</div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(source))-&gt;Run();</div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Object&gt;</a> obj = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Object&gt;::Cast</a>(</div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;      env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;obj&quot;</span>)));</div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;  <span class="comment">// Set a hidden property on the object.</span></div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;  obj-&gt;<a class="code" href="../../db/d85/classv8_1_1_object.html#a98ad2e2a82b457a733bee13e4c2ba876">SetHiddenValue</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;v8::test-debug::a&quot;</span>),</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;                      <a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Int32::New</a>(11));</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;  <span class="comment">// Get mirror for the object with property getter.</span></div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;  CompileRun(<span class="stringliteral">&quot;var obj_mirror = debug.MakeMirror(obj);&quot;</span>);</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(</div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;      <span class="stringliteral">&quot;obj_mirror instanceof debug.ObjectMirror&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;  CompileRun(<span class="stringliteral">&quot;var named_names = obj_mirror.propertyNames();&quot;</span>);</div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;  <span class="comment">// There should be exactly one property. But there is also an unnamed</span></div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;  <span class="comment">// property whose value is hidden properties dictionary. The latter</span></div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;  <span class="comment">// property should not be in the list of reguar properties.</span></div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, CompileRun(<span class="stringliteral">&quot;named_names.length&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(<span class="stringliteral">&quot;named_names[0] == &#39;a&#39;&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(</div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;      <span class="stringliteral">&quot;obj_mirror.property(&#39;a&#39;).value().value() == 1&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;</div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;  <span class="comment">// Object created by t0 will become hidden prototype of object &#39;obj&#39;.</span></div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::FunctionTemplate&gt;</a> t0 = <a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a3b5a2868860b0414c3607f6cf1567b78">v8::FunctionTemplate::New</a>();</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;  t0-&gt;<a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a7f38518da88507c8f2580b7ecb35317c">InstanceTemplate</a>()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;b&quot;</span>), <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(2));</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;  t0-&gt;<a class="code" href="../../d8/d83/classv8_1_1_function_template.html#ac7b86dfd4d1ed73a4a6aac7d2de8a20b">SetHiddenPrototype</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::FunctionTemplate&gt;</a> t1 = <a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a3b5a2868860b0414c3607f6cf1567b78">v8::FunctionTemplate::New</a>();</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;  t1-&gt;<a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a7f38518da88507c8f2580b7ecb35317c">InstanceTemplate</a>()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;c&quot;</span>), <a class="code" href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a>(3));</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;  <span class="comment">// Create proto objects, add hidden properties to them and set them on</span></div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;  <span class="comment">// the global object.</span></div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> protoObj = t0-&gt;<a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a7d1eef8a098a7467763f8c17f37b2d0d">GetFunction</a>()-&gt;NewInstance();</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;  protoObj-&gt;<a class="code" href="../../db/d85/classv8_1_1_object.html#a98ad2e2a82b457a733bee13e4c2ba876">SetHiddenValue</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;v8::test-debug::b&quot;</span>),</div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;                           <a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Int32::New</a>(12));</div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;  env-&gt;Global()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;protoObj&quot;</span>), protoObj);</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> grandProtoObj = t1-&gt;<a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a7d1eef8a098a7467763f8c17f37b2d0d">GetFunction</a>()-&gt;NewInstance();</div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;  grandProtoObj-&gt;<a class="code" href="../../db/d85/classv8_1_1_object.html#a98ad2e2a82b457a733bee13e4c2ba876">SetHiddenValue</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;v8::test-debug::c&quot;</span>),</div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;                                <a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Int32::New</a>(13));</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;  env-&gt;Global()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;grandProtoObj&quot;</span>), grandProtoObj);</div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;</div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;  <span class="comment">// Setting prototypes: obj-&gt;protoObj-&gt;grandProtoObj</span></div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;  protoObj-&gt;<a class="code" href="../../db/d85/classv8_1_1_object.html#aa5e6d5c3ca70b2a1d52415eac4d528f2">Set</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;__proto__&quot;</span>), grandProtoObj);</div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;  obj-&gt;<a class="code" href="../../db/d85/classv8_1_1_object.html#aa5e6d5c3ca70b2a1d52415eac4d528f2">Set</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;__proto__&quot;</span>), protoObj);</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;</div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;  <span class="comment">// Get mirror for the object with property getter.</span></div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;  CompileRun(<span class="stringliteral">&quot;var obj_mirror = debug.MakeMirror(obj);&quot;</span>);</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(</div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;      <span class="stringliteral">&quot;obj_mirror instanceof debug.ObjectMirror&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;  CompileRun(<span class="stringliteral">&quot;var named_names = obj_mirror.propertyNames();&quot;</span>);</div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;  <span class="comment">// There should be exactly two properties - one from the object itself and</span></div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;  <span class="comment">// another from its hidden prototype.</span></div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, CompileRun(<span class="stringliteral">&quot;named_names.length&quot;</span>)-&gt;Int32Value());</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(<span class="stringliteral">&quot;named_names.sort(); named_names[0] == &#39;a&#39; &amp;&amp;&quot;</span></div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;                   <span class="stringliteral">&quot;named_names[1] == &#39;b&#39;&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(</div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;      <span class="stringliteral">&quot;obj_mirror.property(&#39;a&#39;).value().value() == 1&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(CompileRun(</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;      <span class="stringliteral">&quot;obj_mirror.property(&#39;b&#39;).value().value() == 2&quot;</span>)-&gt;BooleanValue());</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;}</div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;</div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;<span class="comment">// Multithreaded tests of JSON debugger protocol</span></div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;<span class="comment">// Support classes</span></div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;</div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;<span class="comment">// Provides synchronization between k threads, where k is an input to the</span></div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;<span class="comment">// constructor.  The Wait() call blocks a thread until it is called for the</span></div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;<span class="comment">// k&#39;th time, then all calls return.  Each ThreadBarrier object can only</span></div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;<span class="comment">// be used once.</span></div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;<span class="keyword">class </span>ThreadBarrier {</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;  <span class="keyword">explicit</span> ThreadBarrier(<span class="keywordtype">int</span> num_threads);</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;  ~ThreadBarrier();</div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;  <span class="keywordtype">void</span> Wait();</div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;  <span class="keywordtype">int</span> num_threads_;</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;  <span class="keywordtype">int</span> num_blocked_;</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;  <a class="code" href="../../de/dfb/classv8_1_1internal_1_1_mutex.html">v8::internal::Mutex</a>* lock_;</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;  <a class="code" href="../../dd/d6f/classv8_1_1internal_1_1_semaphore.html">v8::internal::Semaphore</a>* sem_;</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;  <span class="keywordtype">bool</span> invalid_;</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;};</div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;ThreadBarrier::ThreadBarrier(<span class="keywordtype">int</span> num_threads)</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;    : num_threads_(num_threads), num_blocked_(0) {</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;  lock_ = OS::CreateMutex();</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;  sem_ = OS::CreateSemaphore(0);</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;  invalid_ = <span class="keyword">false</span>;  <span class="comment">// A barrier may only be used once.  Then it is invalid.</span></div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;}</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;</div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;<span class="comment">// Do not call, due to race condition with Wait().</span></div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;<span class="comment">// Could be resolved with Pthread condition variables.</span></div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;ThreadBarrier::~ThreadBarrier() {</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;  lock_-&gt;Lock();</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;  <span class="keyword">delete</span> lock_;</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;  <span class="keyword">delete</span> sem_;</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;}</div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;</div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;<span class="keywordtype">void</span> ThreadBarrier::Wait() {</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;  lock_-&gt;Lock();</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!invalid_);</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;  <span class="keywordflow">if</span> (num_blocked_ == num_threads_ - 1) {</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;    <span class="comment">// Signal and unblock all waiting threads.</span></div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_threads_ - 1; ++i) {</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;      sem_-&gt;Signal();</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;    }</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;    invalid_ = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;    printf(<span class="stringliteral">&quot;BARRIER\n\n&quot;</span>);</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;    fflush(stdout);</div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;    lock_-&gt;Unlock();</div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;  } <span class="keywordflow">else</span> {  <span class="comment">// Wait for the semaphore.</span></div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;    ++num_blocked_;</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;    lock_-&gt;Unlock();  <span class="comment">// Potential race condition with destructor because</span></div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;    sem_-&gt;Wait();  <span class="comment">// these two lines are not atomic.</span></div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;  }</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;}</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;</div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;<span class="comment">// A set containing enough barriers and semaphores for any of the tests.</span></div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;<span class="keyword">class </span>Barriers {</div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;  Barriers();</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;  <span class="keywordtype">void</span> Initialize();</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;  ThreadBarrier barrier_1;</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;  ThreadBarrier barrier_2;</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;  ThreadBarrier barrier_3;</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;  ThreadBarrier barrier_4;</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;  ThreadBarrier barrier_5;</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;  <a class="code" href="../../dd/d6f/classv8_1_1internal_1_1_semaphore.html">v8::internal::Semaphore</a>* semaphore_1;</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;  <a class="code" href="../../dd/d6f/classv8_1_1internal_1_1_semaphore.html">v8::internal::Semaphore</a>* semaphore_2;</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;};</div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;Barriers::Barriers() : barrier_1(2), barrier_2(2),</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;    barrier_3(2), barrier_4(2), barrier_5(2) {}</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;<span class="keywordtype">void</span> Barriers::Initialize() {</div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;  semaphore_1 = OS::CreateSemaphore(0);</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;  semaphore_2 = OS::CreateSemaphore(0);</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;}</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;<span class="comment">// We match parts of the message to decide if it is a break message.</span></div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;<span class="keywordtype">bool</span> IsBreakEventMessage(<span class="keywordtype">char</span> *message) {</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* type_event = <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;event\&quot;&quot;</span>;</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* event_break = <span class="stringliteral">&quot;\&quot;event\&quot;:\&quot;break\&quot;&quot;</span>;</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;  <span class="comment">// Does the message contain both type:event and event:break?</span></div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;  <span class="keywordflow">return</span> strstr(message, type_event) != <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a> &amp;&amp;</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;         strstr(message, event_break) != <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>;</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;}</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;<span class="comment">// We match parts of the message to decide if it is a exception message.</span></div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;<span class="keywordtype">bool</span> IsExceptionEventMessage(<span class="keywordtype">char</span> *message) {</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* type_event = <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;event\&quot;&quot;</span>;</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* event_exception = <span class="stringliteral">&quot;\&quot;event\&quot;:\&quot;exception\&quot;&quot;</span>;</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;  <span class="comment">// Does the message contain both type:event and event:exception?</span></div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;  <span class="keywordflow">return</span> strstr(message, type_event) != <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a> &amp;&amp;</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;      strstr(message, event_exception) != <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>;</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;}</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;</div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;<span class="comment">// We match the message wether it is an evaluate response message.</span></div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;<span class="keywordtype">bool</span> IsEvaluateResponseMessage(<span class="keywordtype">char</span>* message) {</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* type_response = <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;response\&quot;&quot;</span>;</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_evaluate = <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;&quot;</span>;</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;  <span class="comment">// Does the message contain both type:response and command:evaluate?</span></div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;  <span class="keywordflow">return</span> strstr(message, type_response) != <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a> &amp;&amp;</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;         strstr(message, command_evaluate) != <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>;</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;}</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;</div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a31cef5fa9835a15a28b6e650d4a724d4">StringToInt</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* s) {</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;  <span class="keywordflow">return</span> atoi(s);  <span class="comment">// NOLINT</span></div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;}</div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;<span class="comment">// We match parts of the message to get evaluate result int value.</span></div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;<span class="keywordtype">int</span> GetEvaluateIntResult(<span class="keywordtype">char</span> *message) {</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* value = <span class="stringliteral">&quot;\&quot;value\&quot;:&quot;</span>;</div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;  <span class="keywordtype">char</span>* pos = strstr(message, value);</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;  <span class="keywordflow">if</span> (pos == <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>) {</div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;  }</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;  <span class="keywordtype">int</span> res = -1;</div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;  res = <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a31cef5fa9835a15a28b6e650d4a724d4">StringToInt</a>(pos + strlen(value));</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;  <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;}</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;<span class="comment">// We match parts of the message to get hit breakpoint id.</span></div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;<span class="keywordtype">int</span> GetBreakpointIdFromBreakEventMessage(<span class="keywordtype">char</span> *message) {</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* breakpoints = <span class="stringliteral">&quot;\&quot;breakpoints\&quot;:[&quot;</span>;</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;  <span class="keywordtype">char</span>* pos = strstr(message, breakpoints);</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;  <span class="keywordflow">if</span> (pos == <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>) {</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;  }</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;  <span class="keywordtype">int</span> res = -1;</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;  res = <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a31cef5fa9835a15a28b6e650d4a724d4">StringToInt</a>(pos + strlen(breakpoints));</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;  <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;}</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;</div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;</div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;<span class="comment">// We match parts of the message to get total frames number.</span></div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;<span class="keywordtype">int</span> GetTotalFramesInt(<span class="keywordtype">char</span> *message) {</div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* prefix = <span class="stringliteral">&quot;\&quot;totalFrames\&quot;:&quot;</span>;</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;  <span class="keywordtype">char</span>* pos = strstr(message, prefix);</div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;  <span class="keywordflow">if</span> (pos == <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>) {</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;  }</div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;  pos += strlen(prefix);</div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;  <span class="keywordtype">int</span> res = <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a31cef5fa9835a15a28b6e650d4a724d4">StringToInt</a>(pos);</div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;  <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;}</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;<span class="comment">// We match parts of the message to get source line.</span></div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;<span class="keywordtype">int</span> GetSourceLineFromBreakEventMessage(<span class="keywordtype">char</span> *message) {</div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* source_line = <span class="stringliteral">&quot;\&quot;sourceLine\&quot;:&quot;</span>;</div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;  <span class="keywordtype">char</span>* pos = strstr(message, source_line);</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;  <span class="keywordflow">if</span> (pos == <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>) {</div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;  }</div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;  <span class="keywordtype">int</span> res = -1;</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;  res = <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a31cef5fa9835a15a28b6e650d4a724d4">StringToInt</a>(pos + strlen(source_line));</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;  <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;}</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;<span class="comment">/* Test MessageQueues */</span></div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;<span class="comment">/* Tests the message queues that hold debugger commands and</span></div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;<span class="comment"> * response messages to the debugger.  Fills queues and makes</span></div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;<span class="comment"> * them grow.</span></div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;Barriers message_queue_barriers;</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;</div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;<span class="comment">// This is the debugger thread, that executes no v8 calls except</span></div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;<span class="comment">// placing JSON debugger commands in the queue.</span></div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;<span class="keyword">class </span>MessageQueueDebuggerThread : <span class="keyword">public</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html">v8::internal::Thread</a> {</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;  MessageQueueDebuggerThread()</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;      : Thread(<span class="stringliteral">&quot;MessageQueueDebuggerThread&quot;</span>) { }</div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html#adc27ee0d7b66b8795db722f47a615cfe">Run</a>();</div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;};</div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> MessageHandler(<span class="keyword">const</span> <a class="code" href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">uint16_t</a>* message, <span class="keywordtype">int</span> length,</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;                           <a class="code" href="../../d9/d18/classv8_1_1_debug_1_1_client_data.html">v8::Debug::ClientData</a>* client_data) {</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> print_buffer[1000];</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;  Utf16ToAscii(message, length, print_buffer);</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;  <span class="keywordflow">if</span> (IsBreakEventMessage(print_buffer)) {</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;    <span class="comment">// Lets test script wait until break occurs to send commands.</span></div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;    <span class="comment">// Signals when a break is reported.</span></div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;    message_queue_barriers.semaphore_2-&gt;Signal();</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;  }</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;  <span class="comment">// Allow message handler to block on a semaphore, to test queueing of</span></div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;  <span class="comment">// messages while blocked.</span></div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;  message_queue_barriers.semaphore_1-&gt;Wait();</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;}</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;<span class="keywordtype">void</span> MessageQueueDebuggerThread::Run() {</div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kBufferSize = 1000;</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;  <a class="code" href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> buffer_1[kBufferSize];</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;  <a class="code" href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> buffer_2[kBufferSize];</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_1 =</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;      <span class="stringliteral">&quot;{\&quot;seq\&quot;:117,&quot;</span></div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;       <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;       <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;,&quot;</span></div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;       <span class="stringliteral">&quot;\&quot;arguments\&quot;:{\&quot;expression\&quot;:\&quot;1+2\&quot;}}&quot;</span>;</div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_2 =</div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;    <span class="stringliteral">&quot;{\&quot;seq\&quot;:118,&quot;</span></div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;     <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;     <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;,&quot;</span></div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;     <span class="stringliteral">&quot;\&quot;arguments\&quot;:{\&quot;expression\&quot;:\&quot;1+a\&quot;}}&quot;</span>;</div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_3 =</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;    <span class="stringliteral">&quot;{\&quot;seq\&quot;:119,&quot;</span></div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;     <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;     <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;,&quot;</span></div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;     <span class="stringliteral">&quot;\&quot;arguments\&quot;:{\&quot;expression\&quot;:\&quot;c.d * b\&quot;}}&quot;</span>;</div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_continue =</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;    <span class="stringliteral">&quot;{\&quot;seq\&quot;:106,&quot;</span></div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;     <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;     <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;continue\&quot;}&quot;</span>;</div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_single_step =</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;    <span class="stringliteral">&quot;{\&quot;seq\&quot;:107,&quot;</span></div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;     <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;     <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;continue\&quot;,&quot;</span></div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;     <span class="stringliteral">&quot;\&quot;arguments\&quot;:{\&quot;stepaction\&quot;:\&quot;next\&quot;}}&quot;</span>;</div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;</div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;  <span class="comment">/* Interleaved sequence of actions by the two threads:*/</span></div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;  <span class="comment">// Main thread compiles and runs source_1</span></div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;  message_queue_barriers.semaphore_1-&gt;Signal();</div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;  message_queue_barriers.barrier_1.Wait();</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;  <span class="comment">// Post 6 commands, filling the command queue and making it expand.</span></div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;  <span class="comment">// These calls return immediately, but the commands stay on the queue</span></div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;  <span class="comment">// until the execution of source_2.</span></div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;  <span class="comment">// Note: AsciiToUtf16 executes before SendCommand, so command is copied</span></div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;  <span class="comment">// to buffer before buffer is sent to SendCommand.</span></div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer_1, AsciiToUtf16(command_1, buffer_1));</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer_2, AsciiToUtf16(command_2, buffer_2));</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer_2, AsciiToUtf16(command_3, buffer_2));</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer_2, AsciiToUtf16(command_3, buffer_2));</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer_2, AsciiToUtf16(command_3, buffer_2));</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;  message_queue_barriers.barrier_2.Wait();</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;  <span class="comment">// Main thread compiles and runs source_2.</span></div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;  <span class="comment">// Queued commands are executed at the start of compilation of source_2(</span></div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;  <span class="comment">// beforeCompile event).</span></div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;  <span class="comment">// Free the message handler to process all the messages from the queue. 7</span></div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;  <span class="comment">// messages are expected: 2 afterCompile events and 5 responses.</span></div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;  <span class="comment">// All the commands added so far will fail to execute as long as call stack</span></div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;  <span class="comment">// is empty on beforeCompile event.</span></div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6 ; ++i) {</div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;    message_queue_barriers.semaphore_1-&gt;Signal();</div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;  }</div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;  message_queue_barriers.barrier_3.Wait();</div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;  <span class="comment">// Main thread compiles and runs source_3.</span></div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;  <span class="comment">// Don&#39;t stop in the afterCompile handler.</span></div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;  message_queue_barriers.semaphore_1-&gt;Signal();</div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;  <span class="comment">// source_3 includes a debugger statement, which causes a break event.</span></div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;  <span class="comment">// Wait on break event from hitting &quot;debugger&quot; statement</span></div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;  message_queue_barriers.semaphore_2-&gt;Wait();</div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;  <span class="comment">// These should execute after the &quot;debugger&quot; statement in source_2</span></div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer_1, AsciiToUtf16(command_1, buffer_1));</div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer_2, AsciiToUtf16(command_2, buffer_2));</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer_2, AsciiToUtf16(command_3, buffer_2));</div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer_2, AsciiToUtf16(command_single_step, buffer_2));</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;  <span class="comment">// Run after 2 break events, 4 responses.</span></div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6 ; ++i) {</div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;    message_queue_barriers.semaphore_1-&gt;Signal();</div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;  }</div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;  <span class="comment">// Wait on break event after a single step executes.</span></div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;  message_queue_barriers.semaphore_2-&gt;Wait();</div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer_1, AsciiToUtf16(command_2, buffer_1));</div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer_2, AsciiToUtf16(command_continue, buffer_2));</div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;  <span class="comment">// Run after 2 responses.</span></div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2 ; ++i) {</div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;    message_queue_barriers.semaphore_1-&gt;Signal();</div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;  }</div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;  <span class="comment">// Main thread continues running source_3 to end, waits for this thread.</span></div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;}</div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;</div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;</div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;<span class="comment">// This thread runs the v8 engine.</span></div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(MessageQueues) {</div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;  MessageQueueDebuggerThread message_queue_debugger_thread;</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;</div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;  <span class="comment">// Create a V8 environment</span></div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;  message_queue_barriers.Initialize();</div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a969c9d982bcc1e4219047212bfb64467">v8::Debug::SetMessageHandler</a>(MessageHandler);</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;  message_queue_debugger_thread.Start();</div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;</div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* source_1 = <span class="stringliteral">&quot;a = 3; b = 4; c = new Object(); c.d = 5;&quot;</span>;</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* source_2 = <span class="stringliteral">&quot;e = 17;&quot;</span>;</div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* source_3 = <span class="stringliteral">&quot;a = 4; debugger; a = 5; a = 6; a = 7;&quot;</span>;</div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;</div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;  <span class="comment">// See MessageQueueDebuggerThread::Run for interleaved sequence of</span></div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;  <span class="comment">// API calls and events in the two threads.</span></div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;  CompileRun(source_1);</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;  message_queue_barriers.barrier_1.Wait();</div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;  message_queue_barriers.barrier_2.Wait();</div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;  CompileRun(source_2);</div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;  message_queue_barriers.barrier_3.Wait();</div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;  CompileRun(source_3);</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;  message_queue_debugger_thread.Join();</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;  fflush(stdout);</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;}</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;</div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;<span class="keyword">class </span>TestClientData : <span class="keyword">public</span> <a class="code" href="../../d9/d18/classv8_1_1_debug_1_1_client_data.html">v8::Debug::ClientData</a> {</div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;  TestClientData() {</div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;    constructor_call_counter++;</div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;  }</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;  <span class="keyword">virtual</span> ~TestClientData() {</div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;    destructor_call_counter++;</div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;  }</div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> ResetCounters() {</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;    constructor_call_counter = 0;</div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;    destructor_call_counter = 0;</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;  }</div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> constructor_call_counter;</div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> destructor_call_counter;</div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;};</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;<span class="keywordtype">int</span> TestClientData::constructor_call_counter = 0;</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;<span class="keywordtype">int</span> TestClientData::destructor_call_counter = 0;</div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;</div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;<span class="comment">// Tests that MessageQueue doesn&#39;t destroy client data when expands and</span></div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;<span class="comment">// does destroy when it dies.</span></div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(MessageQueueExpandAndDestroy) {</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;  TestClientData::ResetCounters();</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;  { <span class="comment">// Create a scope for the queue.</span></div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;    CommandMessageQueue queue(1);</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;    queue.Put(CommandMessage::New(Vector&lt;uint16_t&gt;::empty(),</div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;                                  <span class="keyword">new</span> TestClientData()));</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;    queue.Put(CommandMessage::New(Vector&lt;uint16_t&gt;::empty(),</div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;                                  <span class="keyword">new</span> TestClientData()));</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;    queue.Put(CommandMessage::New(Vector&lt;uint16_t&gt;::empty(),</div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;                                  <span class="keyword">new</span> TestClientData()));</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, TestClientData::destructor_call_counter);</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;    queue.Get().Dispose();</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, TestClientData::destructor_call_counter);</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;    queue.Put(CommandMessage::New(Vector&lt;uint16_t&gt;::empty(),</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;                                  <span class="keyword">new</span> TestClientData()));</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;    queue.Put(CommandMessage::New(Vector&lt;uint16_t&gt;::empty(),</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;                                  <span class="keyword">new</span> TestClientData()));</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;    queue.Put(CommandMessage::New(Vector&lt;uint16_t&gt;::empty(),</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;                                  <span class="keyword">new</span> TestClientData()));</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;    queue.Put(CommandMessage::New(Vector&lt;uint16_t&gt;::empty(),</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;                                  <span class="keyword">new</span> TestClientData()));</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;    queue.Put(CommandMessage::New(Vector&lt;uint16_t&gt;::empty(),</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;                                  <span class="keyword">new</span> TestClientData()));</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, TestClientData::destructor_call_counter);</div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;    queue.Get().Dispose();</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, TestClientData::destructor_call_counter);</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;  }</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;  <span class="comment">// All the client data should be destroyed when the queue is destroyed.</span></div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(TestClientData::destructor_call_counter,</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;           TestClientData::destructor_call_counter);</div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;}</div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;</div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;</div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> handled_client_data_instances_count = 0;</div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> MessageHandlerCountingClientData(</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a>&amp; message) {</div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;  <span class="keywordflow">if</span> (message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a7761bfded060dc3978fc2150f9ad0e63">GetClientData</a>() != <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>) {</div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;    handled_client_data_instances_count++;</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;  }</div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;}</div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;</div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;</div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;<span class="comment">// Tests that all client data passed to the debugger are sent to the handler.</span></div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(SendClientDataToHandler) {</div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;  <span class="comment">// Create a V8 environment</span></div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;  TestClientData::ResetCounters();</div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;  handled_client_data_instances_count = 0;</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(MessageHandlerCountingClientData);</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* source_1 = <span class="stringliteral">&quot;a = 3; b = 4; c = new Object(); c.d = 5;&quot;</span>;</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kBufferSize = 1000;</div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;  <a class="code" href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> buffer[kBufferSize];</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_1 =</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;      <span class="stringliteral">&quot;{\&quot;seq\&quot;:117,&quot;</span></div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;       <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;       <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;,&quot;</span></div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;       <span class="stringliteral">&quot;\&quot;arguments\&quot;:{\&quot;expression\&quot;:\&quot;1+2\&quot;}}&quot;</span>;</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_2 =</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;    <span class="stringliteral">&quot;{\&quot;seq\&quot;:118,&quot;</span></div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;     <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;     <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;,&quot;</span></div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;     <span class="stringliteral">&quot;\&quot;arguments\&quot;:{\&quot;expression\&quot;:\&quot;1+a\&quot;}}&quot;</span>;</div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_continue =</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;    <span class="stringliteral">&quot;{\&quot;seq\&quot;:106,&quot;</span></div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;     <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;     <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;continue\&quot;}&quot;</span>;</div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;</div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_1, buffer),</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;                         <span class="keyword">new</span> TestClientData());</div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_2, buffer), <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_2, buffer),</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;                         <span class="keyword">new</span> TestClientData());</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_2, buffer),</div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;                         <span class="keyword">new</span> TestClientData());</div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;  <span class="comment">// All the messages will be processed on beforeCompile event.</span></div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;  CompileRun(source_1);</div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_continue, buffer));</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, TestClientData::constructor_call_counter);</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(TestClientData::constructor_call_counter,</div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;           handled_client_data_instances_count);</div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(TestClientData::constructor_call_counter,</div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;           TestClientData::destructor_call_counter);</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;}</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;</div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;</div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;<span class="comment">/* Test ThreadedDebugging */</span></div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;<span class="comment">/* This test interrupts a running infinite loop that is</span></div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;<span class="comment"> * occupying the v8 thread by a break command from the</span></div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;<span class="comment"> * debugger thread.  It then changes the value of a</span></div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;<span class="comment"> * global object, to make the loop terminate.</span></div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;</div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;Barriers threaded_debugging_barriers;</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;</div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;<span class="keyword">class </span>V8Thread : <span class="keyword">public</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html">v8::internal::Thread</a> {</div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;  V8Thread() : Thread(<span class="stringliteral">&quot;V8Thread&quot;</span>) { }</div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html#adc27ee0d7b66b8795db722f47a615cfe">Run</a>();</div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;};</div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;</div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;<span class="keyword">class </span>DebuggerThread : <span class="keyword">public</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html">v8::internal::Thread</a> {</div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;  DebuggerThread() : Thread(<span class="stringliteral">&quot;DebuggerThread&quot;</span>) { }</div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html#adc27ee0d7b66b8795db722f47a615cfe">Run</a>();</div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;};</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;</div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;</div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> ThreadedAtBarrier1(<span class="keyword">const</span> <a class="code" href="../../df/d31/classv8_1_1_arguments.html">v8::Arguments</a>&amp; args) {</div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;  threaded_debugging_barriers.barrier_1.Wait();</div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>();</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;}</div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;</div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> ThreadedMessageHandler(<span class="keyword">const</span> <a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a>&amp; message) {</div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> print_buffer[1000];</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;  <a class="code" href="../../d0/d6b/classv8_1_1_string_1_1_value.html">v8::String::Value</a> json(message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a1aa4b5cc7d83218c3a361692bcdce007">GetJSON</a>());</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;  Utf16ToAscii(*json, json.length(), print_buffer);</div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;  <span class="keywordflow">if</span> (IsBreakEventMessage(print_buffer)) {</div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;    <span class="comment">// Check that we are inside the while loop.</span></div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;    <span class="keywordtype">int</span> source_line = GetSourceLineFromBreakEventMessage(print_buffer);</div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;    <span class="comment">// TODO(2047): This should really be 8 &lt;= source_line &lt;= 13; but we</span></div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;    <span class="comment">// currently have an off-by-one error when calculating the source</span></div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;    <span class="comment">// position corresponding to the program counter at the debug break.</span></div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(7 &lt;= source_line &amp;&amp; source_line &lt;= 13);</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;    threaded_debugging_barriers.barrier_2.Wait();</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;  }</div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;}</div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;</div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;</div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;<span class="keywordtype">void</span> V8Thread::Run() {</div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* source =</div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;      <span class="stringliteral">&quot;flag = true;\n&quot;</span></div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;      <span class="stringliteral">&quot;function bar( new_value ) {\n&quot;</span></div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;      <span class="stringliteral">&quot;  flag = new_value;\n&quot;</span></div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;      <span class="stringliteral">&quot;  return \&quot;Return from bar(\&quot; + new_value + \&quot;)\&quot;;\n&quot;</span></div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;      <span class="stringliteral">&quot;}\n&quot;</span></div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;      <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;      <span class="stringliteral">&quot;function foo() {\n&quot;</span></div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;      <span class="stringliteral">&quot;  var x = 1;\n&quot;</span></div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;      <span class="stringliteral">&quot;  while ( flag == true ) {\n&quot;</span></div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;      <span class="stringliteral">&quot;    if ( x == 1 ) {\n&quot;</span></div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;      <span class="stringliteral">&quot;      ThreadedAtBarrier1();\n&quot;</span></div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;      <span class="stringliteral">&quot;    }\n&quot;</span></div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;      <span class="stringliteral">&quot;    x = x + 1;\n&quot;</span></div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;      <span class="stringliteral">&quot;  }\n&quot;</span></div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;      <span class="stringliteral">&quot;}\n&quot;</span></div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;      <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;      <span class="stringliteral">&quot;foo();\n&quot;</span>;</div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;</div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;  <a class="code" href="../../df/d43/classv8_1_1_v8.html#a248c764067ee60c03ee370784c49f353">v8::V8::Initialize</a>();</div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(&amp;ThreadedMessageHandler);</div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::ObjectTemplate&gt;</a> global_template = <a class="code" href="../../db/d5f/classv8_1_1_object_template.html#ada5e0fda7225c6a63c54f1d07bdc718c">v8::ObjectTemplate::New</a>();</div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;  global_template-&gt;<a class="code" href="../../db/df7/classv8_1_1_template.html#ae26f56c0bce13aa1815c5c50617fc791">Set</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;ThreadedAtBarrier1&quot;</span>),</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;                       <a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a3b5a2868860b0414c3607f6cf1567b78">v8::FunctionTemplate::New</a>(ThreadedAtBarrier1));</div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Context&gt;</a> context = <a class="code" href="../../df/d69/classv8_1_1_context.html#a860f2fec28426ee65e5aec8cbcb43478">v8::Context::New</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, global_template);</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;  <a class="code" href="../../de/d41/classv8_1_1_context_1_1_scope.html">v8::Context::Scope</a> context_scope(context);</div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;</div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;  CompileRun(source);</div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;}</div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;</div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;<span class="keywordtype">void</span> DebuggerThread::Run() {</div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kBufSize = 1000;</div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;  <a class="code" href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> buffer[kBufSize];</div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;</div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_1 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:102,&quot;</span></div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;      <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;      <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;,&quot;</span></div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;      <span class="stringliteral">&quot;\&quot;arguments\&quot;:{\&quot;expression\&quot;:\&quot;bar(false)\&quot;}}&quot;</span>;</div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_2 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:103,&quot;</span></div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;      <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;      <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;continue\&quot;}&quot;</span>;</div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;</div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;  threaded_debugging_barriers.barrier_1.Wait();</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;  threaded_debugging_barriers.barrier_2.Wait();</div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_1, buffer));</div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_2, buffer));</div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;}</div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;</div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ThreadedDebugging) {</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;  DebuggerThread debugger_thread;</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;  V8Thread v8_thread;</div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;</div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;  <span class="comment">// Create a V8 environment</span></div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;  threaded_debugging_barriers.Initialize();</div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;  v8_thread.Start();</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;  debugger_thread.Start();</div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;  v8_thread.Join();</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;  debugger_thread.Join();</div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;}</div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;</div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;<span class="comment">/* Test RecursiveBreakpoints */</span></div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;<span class="comment">/* In this test, the debugger evaluates a function with a breakpoint, after</span></div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;<span class="comment"> * hitting a breakpoint in another function.  We do this with both values</span></div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;<span class="comment"> * of the flag enabling recursive breakpoints, and verify that the second</span></div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;<span class="comment"> * breakpoint is hit when enabled, and missed when disabled.</span></div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;</div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;<span class="keyword">class </span>BreakpointsV8Thread : <span class="keyword">public</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html">v8::internal::Thread</a> {</div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;  BreakpointsV8Thread() : Thread(<span class="stringliteral">&quot;BreakpointsV8Thread&quot;</span>) { }</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html#adc27ee0d7b66b8795db722f47a615cfe">Run</a>();</div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;};</div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;</div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;<span class="keyword">class </span>BreakpointsDebuggerThread : <span class="keyword">public</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html">v8::internal::Thread</a> {</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;  <span class="keyword">explicit</span> BreakpointsDebuggerThread(<span class="keywordtype">bool</span> global_evaluate)</div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;      : Thread(<span class="stringliteral">&quot;BreakpointsDebuggerThread&quot;</span>),</div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;        global_evaluate_(global_evaluate) {}</div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html#adc27ee0d7b66b8795db722f47a615cfe">Run</a>();</div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;</div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;  <span class="keywordtype">bool</span> global_evaluate_;</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;};</div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;</div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;</div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;Barriers* breakpoints_barriers;</div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;<span class="keywordtype">int</span> break_event_breakpoint_id;</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;<span class="keywordtype">int</span> evaluate_int_result;</div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;</div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> BreakpointsMessageHandler(<span class="keyword">const</span> <a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a>&amp; message) {</div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> print_buffer[1000];</div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;  <a class="code" href="../../d0/d6b/classv8_1_1_string_1_1_value.html">v8::String::Value</a> json(message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a1aa4b5cc7d83218c3a361692bcdce007">GetJSON</a>());</div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;  Utf16ToAscii(*json, json.length(), print_buffer);</div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;</div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;  <span class="keywordflow">if</span> (IsBreakEventMessage(print_buffer)) {</div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;    break_event_breakpoint_id =</div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;        GetBreakpointIdFromBreakEventMessage(print_buffer);</div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;    breakpoints_barriers-&gt;semaphore_1-&gt;Signal();</div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IsEvaluateResponseMessage(print_buffer)) {</div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;    evaluate_int_result = GetEvaluateIntResult(print_buffer);</div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;    breakpoints_barriers-&gt;semaphore_1-&gt;Signal();</div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;  }</div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;}</div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;</div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;</div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;<span class="keywordtype">void</span> BreakpointsV8Thread::Run() {</div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* source_1 = <span class="stringliteral">&quot;var y_global = 3;\n&quot;</span></div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;    <span class="stringliteral">&quot;function cat( new_value ) {\n&quot;</span></div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;    <span class="stringliteral">&quot;  var x = new_value;\n&quot;</span></div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;    <span class="stringliteral">&quot;  y_global = y_global + 4;\n&quot;</span></div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;    <span class="stringliteral">&quot;  x = 3 * x + 1;\n&quot;</span></div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;    <span class="stringliteral">&quot;  y_global = y_global + 5;\n&quot;</span></div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;    <span class="stringliteral">&quot;  return x;\n&quot;</span></div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;    <span class="stringliteral">&quot;}\n&quot;</span></div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;    <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;    <span class="stringliteral">&quot;function dog() {\n&quot;</span></div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;    <span class="stringliteral">&quot;  var x = 1;\n&quot;</span></div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;    <span class="stringliteral">&quot;  x = y_global;&quot;</span></div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;    <span class="stringliteral">&quot;  var z = 3;&quot;</span></div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;    <span class="stringliteral">&quot;  x += 100;\n&quot;</span></div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;    <span class="stringliteral">&quot;  return x;\n&quot;</span></div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;    <span class="stringliteral">&quot;}\n&quot;</span></div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;    <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* source_2 = <span class="stringliteral">&quot;cat(17);\n&quot;</span></div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;    <span class="stringliteral">&quot;cat(19);\n&quot;</span>;</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;  <a class="code" href="../../df/d43/classv8_1_1_v8.html#a248c764067ee60c03ee370784c49f353">v8::V8::Initialize</a>();</div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(&amp;BreakpointsMessageHandler);</div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;</div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;  CompileRun(source_1);</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;  breakpoints_barriers-&gt;barrier_1.Wait();</div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;  breakpoints_barriers-&gt;barrier_2.Wait();</div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;  CompileRun(source_2);</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;}</div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;</div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;<span class="keywordtype">void</span> BreakpointsDebuggerThread::Run() {</div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kBufSize = 1000;</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;  <a class="code" href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> buffer[kBufSize];</div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;</div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_1 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:101,&quot;</span></div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;      <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;      <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;setbreakpoint\&quot;,&quot;</span></div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;      <span class="stringliteral">&quot;\&quot;arguments\&quot;:{\&quot;type\&quot;:\&quot;function\&quot;,\&quot;target\&quot;:\&quot;cat\&quot;,\&quot;line\&quot;:3}}&quot;</span>;</div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_2 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:102,&quot;</span></div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;      <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;      <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;setbreakpoint\&quot;,&quot;</span></div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;      <span class="stringliteral">&quot;\&quot;arguments\&quot;:{\&quot;type\&quot;:\&quot;function\&quot;,\&quot;target\&quot;:\&quot;dog\&quot;,\&quot;line\&quot;:3}}&quot;</span>;</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_3;</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;  <span class="keywordflow">if</span> (this-&gt;global_evaluate_) {</div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;    command_3 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:103,&quot;</span></div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;        <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;        <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;,&quot;</span></div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;        <span class="stringliteral">&quot;\&quot;arguments\&quot;:{\&quot;expression\&quot;:\&quot;dog()\&quot;,\&quot;disable_break\&quot;:false,&quot;</span></div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;        <span class="stringliteral">&quot;\&quot;global\&quot;:true}}&quot;</span>;</div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;    command_3 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:103,&quot;</span></div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;        <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;        <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;,&quot;</span></div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;        <span class="stringliteral">&quot;\&quot;arguments\&quot;:{\&quot;expression\&quot;:\&quot;dog()\&quot;,\&quot;disable_break\&quot;:false}}&quot;</span>;</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;  }</div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_4;</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;  <span class="keywordflow">if</span> (this-&gt;global_evaluate_) {</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;    command_4 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:104,&quot;</span></div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;        <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;        <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;,&quot;</span></div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;        <span class="stringliteral">&quot;\&quot;arguments\&quot;:{\&quot;expression\&quot;:\&quot;100 + 8\&quot;,\&quot;disable_break\&quot;:true,&quot;</span></div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;        <span class="stringliteral">&quot;\&quot;global\&quot;:true}}&quot;</span>;</div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;    command_4 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:104,&quot;</span></div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;        <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;        <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;,&quot;</span></div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;        <span class="stringliteral">&quot;\&quot;arguments\&quot;:{\&quot;expression\&quot;:\&quot;x + 1\&quot;,\&quot;disable_break\&quot;:true}}&quot;</span>;</div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;  }</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_5 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:105,&quot;</span></div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;      <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;      <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;continue\&quot;}&quot;</span>;</div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_6 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:106,&quot;</span></div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;      <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;      <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;continue\&quot;}&quot;</span>;</div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_7;</div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;  <span class="keywordflow">if</span> (this-&gt;global_evaluate_) {</div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;    command_7 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:107,&quot;</span></div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;        <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;        <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;,&quot;</span></div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;        <span class="stringliteral">&quot;\&quot;arguments\&quot;:{\&quot;expression\&quot;:\&quot;dog()\&quot;,\&quot;disable_break\&quot;:true,&quot;</span></div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;        <span class="stringliteral">&quot;\&quot;global\&quot;:true}}&quot;</span>;</div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;    command_7 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:107,&quot;</span></div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;        <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;        <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;,&quot;</span></div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;        <span class="stringliteral">&quot;\&quot;arguments\&quot;:{\&quot;expression\&quot;:\&quot;dog()\&quot;,\&quot;disable_break\&quot;:true}}&quot;</span>;</div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;  }</div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_8 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:108,&quot;</span></div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;      <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;      <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;continue\&quot;}&quot;</span>;</div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;</div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;  <span class="comment">// v8 thread initializes, runs source_1</span></div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;  breakpoints_barriers-&gt;barrier_1.Wait();</div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;  <span class="comment">// 1:Set breakpoint in cat() (will get id 1).</span></div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_1, buffer));</div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;  <span class="comment">// 2:Set breakpoint in dog() (will get id 2).</span></div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_2, buffer));</div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;  breakpoints_barriers-&gt;barrier_2.Wait();</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;  <span class="comment">// V8 thread starts compiling source_2.</span></div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;  <span class="comment">// Automatic break happens, to run queued commands</span></div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;  <span class="comment">// breakpoints_barriers-&gt;semaphore_1-&gt;Wait();</span></div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;  <span class="comment">// Commands 1 through 3 run, thread continues.</span></div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;  <span class="comment">// v8 thread runs source_2 to breakpoint in cat().</span></div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;  <span class="comment">// message callback receives break event.</span></div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;  breakpoints_barriers-&gt;semaphore_1-&gt;Wait();</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;  <span class="comment">// Must have hit breakpoint #1.</span></div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_event_breakpoint_id);</div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;  <span class="comment">// 4:Evaluate dog() (which has a breakpoint).</span></div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_3, buffer));</div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;  <span class="comment">// V8 thread hits breakpoint in dog().</span></div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;  breakpoints_barriers-&gt;semaphore_1-&gt;Wait();  <span class="comment">// wait for break event</span></div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;  <span class="comment">// Must have hit breakpoint #2.</span></div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_event_breakpoint_id);</div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;  <span class="comment">// 5:Evaluate (x + 1).</span></div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_4, buffer));</div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;  <span class="comment">// Evaluate (x + 1) finishes.</span></div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;  breakpoints_barriers-&gt;semaphore_1-&gt;Wait();</div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;  <span class="comment">// Must have result 108.</span></div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(108, evaluate_int_result);</div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;  <span class="comment">// 6:Continue evaluation of dog().</span></div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_5, buffer));</div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;  <span class="comment">// Evaluate dog() finishes.</span></div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;  breakpoints_barriers-&gt;semaphore_1-&gt;Wait();</div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;  <span class="comment">// Must have result 107.</span></div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(107, evaluate_int_result);</div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;  <span class="comment">// 7:Continue evaluation of source_2, finish cat(17), hit breakpoint</span></div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;  <span class="comment">// in cat(19).</span></div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_6, buffer));</div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;  <span class="comment">// Message callback gets break event.</span></div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;  breakpoints_barriers-&gt;semaphore_1-&gt;Wait();  <span class="comment">// wait for break event</span></div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;  <span class="comment">// Must have hit breakpoint #1.</span></div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_event_breakpoint_id);</div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;  <span class="comment">// 8: Evaluate dog() with breaks disabled.</span></div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_7, buffer));</div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;  <span class="comment">// Evaluate dog() finishes.</span></div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;  breakpoints_barriers-&gt;semaphore_1-&gt;Wait();</div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;  <span class="comment">// Must have result 116.</span></div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(116, evaluate_int_result);</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;  <span class="comment">// 9: Continue evaluation of source2, reach end.</span></div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_8, buffer));</div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;}</div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;</div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;<span class="keywordtype">void</span> TestRecursiveBreakpointsGeneric(<span class="keywordtype">bool</span> global_evaluate) {</div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;  i::FLAG_debugger_auto_break = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;</div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;  BreakpointsDebuggerThread breakpoints_debugger_thread(global_evaluate);</div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;  BreakpointsV8Thread breakpoints_v8_thread;</div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;</div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;  <span class="comment">// Create a V8 environment</span></div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;  Barriers stack_allocated_breakpoints_barriers;</div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;  stack_allocated_breakpoints_barriers.Initialize();</div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;  breakpoints_barriers = &amp;stack_allocated_breakpoints_barriers;</div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;</div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;  breakpoints_v8_thread.Start();</div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;  breakpoints_debugger_thread.Start();</div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;</div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;  breakpoints_v8_thread.Join();</div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;  breakpoints_debugger_thread.Join();</div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;}</div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;</div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(RecursiveBreakpoints) {</div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;  TestRecursiveBreakpointsGeneric(<span class="keyword">false</span>);</div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;}</div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;</div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(RecursiveBreakpointsGlobal) {</div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;  TestRecursiveBreakpointsGeneric(<span class="keyword">true</span>);</div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;}</div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;</div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;</div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DummyDebugEventListener(<a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;                                    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;                                    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;                                    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;}</div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;</div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;</div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(SetDebugEventListenerOnUninitializedVM) {</div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DummyDebugEventListener);</div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;}</div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;</div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DummyMessageHandler(<span class="keyword">const</span> <a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a>&amp; message) {</div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;}</div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;</div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;</div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(SetMessageHandlerOnUninitializedVM) {</div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(DummyMessageHandler);</div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;}</div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;</div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;</div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugBreakOnUninitializedVM) {</div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;}</div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;</div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;</div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(SendCommandToUninitializedVM) {</div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* dummy_command = <span class="stringliteral">&quot;{}&quot;</span>;</div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;  <a class="code" href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> dummy_buffer[80];</div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;  <span class="keywordtype">int</span> dummy_length = AsciiToUtf16(dummy_command, dummy_buffer);</div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(dummy_buffer, dummy_length);</div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;}</div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;</div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;</div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;<span class="comment">// Source for a JavaScript function which returns the data parameter of a</span></div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;<span class="comment">// function called in the context of the debugger. If no data parameter is</span></div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;<span class="comment">// passed it throws an exception.</span></div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* debugger_call_with_data_source =</div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;    <span class="stringliteral">&quot;function debugger_call_with_data(exec_state, data) {&quot;</span></div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;    <span class="stringliteral">&quot;  if (data) return data;&quot;</span></div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;    <span class="stringliteral">&quot;  throw &#39;No data!&#39;&quot;</span></div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;    <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;<a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Function&gt;</a> debugger_call_with_data;</div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;</div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;</div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;<span class="comment">// Source for a JavaScript function which returns the data parameter of a</span></div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;<span class="comment">// function called in the context of the debugger. If no data parameter is</span></div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;<span class="comment">// passed it throws an exception.</span></div>
<div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* debugger_call_with_closure_source =</div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;    <span class="stringliteral">&quot;var x = 3;&quot;</span></div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;    <span class="stringliteral">&quot;(function (exec_state) {&quot;</span></div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;    <span class="stringliteral">&quot;  if (exec_state.y) return x - 1;&quot;</span></div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;    <span class="stringliteral">&quot;  exec_state.y = x;&quot;</span></div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;    <span class="stringliteral">&quot;  return exec_state.y&quot;</span></div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;    <span class="stringliteral">&quot;})&quot;</span>;</div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;<a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Function&gt;</a> debugger_call_with_closure;</div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;</div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;<span class="comment">// Function to retrieve the number of JavaScript frames by calling a JavaScript</span></div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;<span class="comment">// in the debugger.</span></div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> CheckFrameCount(<span class="keyword">const</span> <a class="code" href="../../df/d31/classv8_1_1_arguments.html">v8::Arguments</a>&amp; args) {</div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(<a class="code" href="../../de/d13/classv8_1_1_debug.html#addcd97a2e1d1c179915a2eca561a0a24">v8::Debug::Call</a>(frame_count)-&gt;IsNumber());</div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(args[0]-&gt;Int32Value(),</div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;           <a class="code" href="../../de/d13/classv8_1_1_debug.html#addcd97a2e1d1c179915a2eca561a0a24">v8::Debug::Call</a>(frame_count)-&gt;Int32Value());</div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>();</div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;}</div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;</div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;</div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;<span class="comment">// Function to retrieve the source line of the top JavaScript frame by calling a</span></div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;<span class="comment">// JavaScript function in the debugger.</span></div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> CheckSourceLine(<span class="keyword">const</span> <a class="code" href="../../df/d31/classv8_1_1_arguments.html">v8::Arguments</a>&amp; args) {</div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(<a class="code" href="../../de/d13/classv8_1_1_debug.html#addcd97a2e1d1c179915a2eca561a0a24">v8::Debug::Call</a>(frame_source_line)-&gt;IsNumber());</div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(args[0]-&gt;Int32Value(),</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;           <a class="code" href="../../de/d13/classv8_1_1_debug.html#addcd97a2e1d1c179915a2eca561a0a24">v8::Debug::Call</a>(frame_source_line)-&gt;Int32Value());</div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>();</div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;}</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;</div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;<span class="comment">// Function to test passing an additional parameter to a JavaScript function</span></div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;<span class="comment">// called in the debugger. It also tests that functions called in the debugger</span></div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;<span class="comment">// can throw exceptions.</span></div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> CheckDataParameter(<span class="keyword">const</span> <a class="code" href="../../df/d31/classv8_1_1_arguments.html">v8::Arguments</a>&amp; args) {</div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> data = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;Test&quot;</span>);</div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(<a class="code" href="../../de/d13/classv8_1_1_debug.html#addcd97a2e1d1c179915a2eca561a0a24">v8::Debug::Call</a>(debugger_call_with_data, data)-&gt;IsString());</div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;</div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(<a class="code" href="../../de/d13/classv8_1_1_debug.html#addcd97a2e1d1c179915a2eca561a0a24">v8::Debug::Call</a>(debugger_call_with_data).IsEmpty());</div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(<a class="code" href="../../de/d13/classv8_1_1_debug.html#addcd97a2e1d1c179915a2eca561a0a24">v8::Debug::Call</a>(debugger_call_with_data).IsEmpty());</div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;</div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;  <a class="code" href="../../d4/dc6/classv8_1_1_try_catch.html">v8::TryCatch</a> catcher;</div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#addcd97a2e1d1c179915a2eca561a0a24">v8::Debug::Call</a>(debugger_call_with_data);</div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(catcher.<a class="code" href="../../d4/dc6/classv8_1_1_try_catch.html#a68f455077e74f15d67c6cc1664dbc266">HasCaught</a>());</div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(catcher.<a class="code" href="../../d4/dc6/classv8_1_1_try_catch.html#a65b4d97cc9755f7f99556dbe87d829ee">Exception</a>()-&gt;IsString());</div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;</div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>();</div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;}</div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;</div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;</div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;<span class="comment">// Function to test using a JavaScript with closure in the debugger.</span></div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> CheckClosure(<span class="keyword">const</span> <a class="code" href="../../df/d31/classv8_1_1_arguments.html">v8::Arguments</a>&amp; args) {</div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(<a class="code" href="../../de/d13/classv8_1_1_debug.html#addcd97a2e1d1c179915a2eca561a0a24">v8::Debug::Call</a>(debugger_call_with_closure)-&gt;IsNumber());</div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, <a class="code" href="../../de/d13/classv8_1_1_debug.html#addcd97a2e1d1c179915a2eca561a0a24">v8::Debug::Call</a>(debugger_call_with_closure)-&gt;Int32Value());</div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>();</div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;}</div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;</div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;</div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;<span class="comment">// Test functions called through the debugger.</span></div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(CallFunctionInDebugger) {</div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;  <span class="comment">// Create and enter a context with the functions CheckFrameCount,</span></div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;  <span class="comment">// CheckSourceLine and CheckDataParameter installed.</span></div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::ObjectTemplate&gt;</a> global_template = <a class="code" href="../../db/d5f/classv8_1_1_object_template.html#ada5e0fda7225c6a63c54f1d07bdc718c">v8::ObjectTemplate::New</a>();</div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;  global_template-&gt;<a class="code" href="../../db/df7/classv8_1_1_template.html#ae26f56c0bce13aa1815c5c50617fc791">Set</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;CheckFrameCount&quot;</span>),</div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;                       <a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a3b5a2868860b0414c3607f6cf1567b78">v8::FunctionTemplate::New</a>(CheckFrameCount));</div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;  global_template-&gt;<a class="code" href="../../db/df7/classv8_1_1_template.html#ae26f56c0bce13aa1815c5c50617fc791">Set</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;CheckSourceLine&quot;</span>),</div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;                       <a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a3b5a2868860b0414c3607f6cf1567b78">v8::FunctionTemplate::New</a>(CheckSourceLine));</div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;  global_template-&gt;<a class="code" href="../../db/df7/classv8_1_1_template.html#ae26f56c0bce13aa1815c5c50617fc791">Set</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;CheckDataParameter&quot;</span>),</div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;                       <a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a3b5a2868860b0414c3607f6cf1567b78">v8::FunctionTemplate::New</a>(CheckDataParameter));</div>
<div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;  global_template-&gt;<a class="code" href="../../db/df7/classv8_1_1_template.html#ae26f56c0bce13aa1815c5c50617fc791">Set</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;CheckClosure&quot;</span>),</div>
<div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;                       <a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a3b5a2868860b0414c3607f6cf1567b78">v8::FunctionTemplate::New</a>(CheckClosure));</div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Context&gt;</a> context = <a class="code" href="../../df/d69/classv8_1_1_context.html#a860f2fec28426ee65e5aec8cbcb43478">v8::Context::New</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, global_template);</div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;  <a class="code" href="../../de/d41/classv8_1_1_context_1_1_scope.html">v8::Context::Scope</a> context_scope(context);</div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;</div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;  <span class="comment">// Compile a function for checking the number of JavaScript frames.</span></div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(frame_count_source))-&gt;Run();</div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;  frame_count = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(</div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;      context-&gt;<a class="code" href="../../df/d69/classv8_1_1_context.html#a8fc7f005c25f7ac02e35c8ebf51183b3">Global</a>()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;frame_count&quot;</span>)));</div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;</div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;  <span class="comment">// Compile a function for returning the source line for the top frame.</span></div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(frame_source_line_source))-&gt;Run();</div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;  frame_source_line = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(</div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;      context-&gt;<a class="code" href="../../df/d69/classv8_1_1_context.html#a8fc7f005c25f7ac02e35c8ebf51183b3">Global</a>()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;frame_source_line&quot;</span>)));</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;</div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;  <span class="comment">// Compile a function returning the data parameter.</span></div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(debugger_call_with_data_source))-&gt;Run();</div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;  debugger_call_with_data = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(</div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;      context-&gt;<a class="code" href="../../df/d69/classv8_1_1_context.html#a8fc7f005c25f7ac02e35c8ebf51183b3">Global</a>()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;debugger_call_with_data&quot;</span>)));</div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;</div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;  <span class="comment">// Compile a function capturing closure.</span></div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;  debugger_call_with_closure = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;      <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(</div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;          <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(debugger_call_with_closure_source))-&gt;Run());</div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;</div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;  <span class="comment">// Calling a function through the debugger returns 0 frames if there are</span></div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;  <span class="comment">// no JavaScript frames.</span></div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(0), <a class="code" href="../../de/d13/classv8_1_1_debug.html#addcd97a2e1d1c179915a2eca561a0a24">v8::Debug::Call</a>(frame_count));</div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;</div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;  <span class="comment">// Test that the number of frames can be retrieved.</span></div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;CheckFrameCount(1)&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;function f() {&quot;</span></div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;                                      <span class="stringliteral">&quot;  CheckFrameCount(2);&quot;</span></div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;                                      <span class="stringliteral">&quot;}; f()&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;</div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;  <span class="comment">// Test that the source line can be retrieved.</span></div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;CheckSourceLine(0)&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;function f() {\n&quot;</span></div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;                                      <span class="stringliteral">&quot;  CheckSourceLine(1)\n&quot;</span></div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;                                      <span class="stringliteral">&quot;  CheckSourceLine(2)\n&quot;</span></div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;                                      <span class="stringliteral">&quot;  CheckSourceLine(3)\n&quot;</span></div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;                                      <span class="stringliteral">&quot;}; f()&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;</div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;  <span class="comment">// Test that a parameter can be passed to a function called in the debugger.</span></div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;CheckDataParameter()&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;</div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;  <span class="comment">// Test that a function with closure can be run in the debugger.</span></div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;CheckClosure()&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;</div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;</div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;  <span class="comment">// Test that the source line is correct when there is a line offset.</span></div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;  <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a> origin(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;test&quot;</span>),</div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;                          <a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(7));</div>
<div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;CheckSourceLine(7)&quot;</span>), &amp;origin)-&gt;Run();</div>
<div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;function f() {\n&quot;</span></div>
<div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;                                      <span class="stringliteral">&quot;  CheckSourceLine(8)\n&quot;</span></div>
<div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;                                      <span class="stringliteral">&quot;  CheckSourceLine(9)\n&quot;</span></div>
<div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;                                      <span class="stringliteral">&quot;  CheckSourceLine(10)\n&quot;</span></div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;                                      <span class="stringliteral">&quot;}; f()&quot;</span>), &amp;origin)-&gt;Run();</div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;}</div>
<div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;</div>
<div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;</div>
<div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;<span class="comment">// Debugger message handler which counts the number of breaks.</span></div>
<div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> SendContinueCommand();</div>
<div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> MessageHandlerBreakPointHitCount(</div>
<div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a>&amp; message) {</div>
<div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;  <span class="keywordflow">if</span> (message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a0633ca6194b8474fe39d4cffcc52b859">IsEvent</a>() &amp;&amp; message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a5e8220bed8b3bf7c537711ce6b9653d6">GetEvent</a>() == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;    <span class="comment">// Count the number of breaks.</span></div>
<div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;    break_point_hit_count++;</div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;</div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;    SendContinueCommand();</div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;  }</div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;}</div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;</div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;</div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;<span class="comment">// Test that clearing the debug event listener actually clears all break points</span></div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;<span class="comment">// and related information.</span></div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebuggerUnload) {</div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;</div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;  <span class="comment">// Check debugger is unloaded before it is used.</span></div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;</div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;  <span class="comment">// Set a debug event listener.</span></div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;  {</div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;    <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;    <span class="comment">// Create a couple of functions for the test.</span></div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;    <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo =</div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;        CompileFunction(&amp;env, <span class="stringliteral">&quot;function foo(){x=1}&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;    <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> bar =</div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;        CompileFunction(&amp;env, <span class="stringliteral">&quot;function bar(){y=2}&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>);</div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;</div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;    <span class="comment">// Set some break points.</span></div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;    SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;    SetBreakPoint(foo, 4);</div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;    SetBreakPoint(bar, 0);</div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;    SetBreakPoint(bar, 4);</div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;</div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;    <span class="comment">// Make sure that the break points are there.</span></div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;    break_point_hit_count = 0;</div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;    foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;    bar-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(4, break_point_hit_count);</div>
<div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;  }</div>
<div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;</div>
<div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;  <span class="comment">// Remove the debug event listener without clearing breakpoints. Do this</span></div>
<div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;  <span class="comment">// outside a handle scope.</span></div>
<div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;  CheckDebuggerUnloaded(<span class="keyword">true</span>);</div>
<div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;</div>
<div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;  <span class="comment">// Now set a debug message handler.</span></div>
<div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(MessageHandlerBreakPointHitCount);</div>
<div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;  {</div>
<div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;    <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;</div>
<div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;    <span class="comment">// Get the test functions again.</span></div>
<div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;    <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> <a class="code" href="../../d6/df1/test-accessors_8cc.html#a819b717d29c6c488a332fefeeb3815ba">foo</a>(<a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;::Cast</a>(</div>
<div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;        env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;foo&quot;</span>))));</div>
<div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;</div>
<div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;    foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, break_point_hit_count);</div>
<div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;</div>
<div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;    <span class="comment">// Set break points and run again.</span></div>
<div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;    SetBreakPoint(foo, 0);</div>
<div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;    SetBreakPoint(foo, 4);</div>
<div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;    foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;  }</div>
<div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;</div>
<div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;  <span class="comment">// Remove the debug message handler without clearing breakpoints. Do this</span></div>
<div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;  <span class="comment">// outside a handle scope.</span></div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;  CheckDebuggerUnloaded(<span class="keyword">true</span>);</div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;}</div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;</div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;</div>
<div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;<span class="comment">// Sends continue command to the debugger.</span></div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> SendContinueCommand() {</div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kBufferSize = 1000;</div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;  <a class="code" href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> buffer[kBufferSize];</div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_continue =</div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;    <span class="stringliteral">&quot;{\&quot;seq\&quot;:0,&quot;</span></div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;     <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;     <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;continue\&quot;}&quot;</span>;</div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;</div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_continue, buffer));</div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;}</div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;</div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;</div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;<span class="comment">// Debugger message handler which counts the number of times it is called.</span></div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> message_handler_hit_count = 0;</div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> MessageHandlerHitCount(<span class="keyword">const</span> <a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a>&amp; message) {</div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;  message_handler_hit_count++;</div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;</div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> print_buffer[1000];</div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;  <a class="code" href="../../d0/d6b/classv8_1_1_string_1_1_value.html">v8::String::Value</a> json(message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a1aa4b5cc7d83218c3a361692bcdce007">GetJSON</a>());</div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;  Utf16ToAscii(*json, json.length(), print_buffer);</div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;  <span class="keywordflow">if</span> (IsExceptionEventMessage(print_buffer)) {</div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;    <span class="comment">// Send a continue command for exception events.</span></div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;    SendContinueCommand();</div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;  }</div>
<div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;}</div>
<div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;</div>
<div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;</div>
<div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;<span class="comment">// Test clearing the debug message handler.</span></div>
<div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebuggerClearMessageHandler) {</div>
<div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;</div>
<div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;  <span class="comment">// Check debugger is unloaded before it is used.</span></div>
<div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;</div>
<div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;  <span class="comment">// Set a debug message handler.</span></div>
<div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(MessageHandlerHitCount);</div>
<div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;</div>
<div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;  <span class="comment">// Run code to throw a unhandled exception. This should end up in the message</span></div>
<div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;  <span class="comment">// handler.</span></div>
<div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;  CompileRun(<span class="stringliteral">&quot;throw 1&quot;</span>);</div>
<div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;</div>
<div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;  <span class="comment">// The message handler should be called.</span></div>
<div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#ad5a1a3bc35696ef5a1070bca3a419c99">CHECK_GT</a>(message_handler_hit_count, 0);</div>
<div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;</div>
<div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;  <span class="comment">// Clear debug message handler.</span></div>
<div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;  message_handler_hit_count = 0;</div>
<div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a969c9d982bcc1e4219047212bfb64467">v8::Debug::SetMessageHandler</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;</div>
<div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;  <span class="comment">// Run code to throw a unhandled exception. This should end up in the message</span></div>
<div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;  <span class="comment">// handler.</span></div>
<div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;  CompileRun(<span class="stringliteral">&quot;throw 1&quot;</span>);</div>
<div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;</div>
<div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;  <span class="comment">// The message handler should not be called more.</span></div>
<div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, message_handler_hit_count);</div>
<div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;</div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;  CheckDebuggerUnloaded(<span class="keyword">true</span>);</div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;}</div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;</div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;</div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;<span class="comment">// Debugger message handler which clears the message handler while active.</span></div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> MessageHandlerClearingMessageHandler(</div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a>&amp; message) {</div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;  message_handler_hit_count++;</div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;</div>
<div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;  <span class="comment">// Clear debug message handler.</span></div>
<div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a969c9d982bcc1e4219047212bfb64467">v8::Debug::SetMessageHandler</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;}</div>
<div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;</div>
<div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;</div>
<div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;<span class="comment">// Test clearing the debug message handler while processing a debug event.</span></div>
<div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebuggerClearMessageHandlerWhileActive) {</div>
<div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;</div>
<div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;  <span class="comment">// Check debugger is unloaded before it is used.</span></div>
<div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;</div>
<div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;  <span class="comment">// Set a debug message handler.</span></div>
<div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(MessageHandlerClearingMessageHandler);</div>
<div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;</div>
<div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;  <span class="comment">// Run code to throw a unhandled exception. This should end up in the message</span></div>
<div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;  <span class="comment">// handler.</span></div>
<div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;  CompileRun(<span class="stringliteral">&quot;throw 1&quot;</span>);</div>
<div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;</div>
<div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;  <span class="comment">// The message handler should be called.</span></div>
<div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, message_handler_hit_count);</div>
<div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;</div>
<div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;  CheckDebuggerUnloaded(<span class="keyword">true</span>);</div>
<div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;}</div>
<div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;</div>
<div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;</div>
<div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;<span class="comment">/* Test DebuggerHostDispatch */</span></div>
<div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;<span class="comment">/* In this test, the debugger waits for a command on a breakpoint</span></div>
<div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;<span class="comment"> * and is dispatching host commands while in the infinite loop.</span></div>
<div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;</div>
<div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;<span class="keyword">class </span>HostDispatchV8Thread : <span class="keyword">public</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html">v8::internal::Thread</a> {</div>
<div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;  HostDispatchV8Thread() : Thread(<span class="stringliteral">&quot;HostDispatchV8Thread&quot;</span>) { }</div>
<div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html#adc27ee0d7b66b8795db722f47a615cfe">Run</a>();</div>
<div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;};</div>
<div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;</div>
<div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;<span class="keyword">class </span>HostDispatchDebuggerThread : <span class="keyword">public</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html">v8::internal::Thread</a> {</div>
<div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;  HostDispatchDebuggerThread() : Thread(<span class="stringliteral">&quot;HostDispatchDebuggerThread&quot;</span>) { }</div>
<div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html#adc27ee0d7b66b8795db722f47a615cfe">Run</a>();</div>
<div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;};</div>
<div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;</div>
<div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;Barriers* host_dispatch_barriers;</div>
<div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;</div>
<div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> HostDispatchMessageHandler(<span class="keyword">const</span> <a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a>&amp; message) {</div>
<div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> print_buffer[1000];</div>
<div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;  <a class="code" href="../../d0/d6b/classv8_1_1_string_1_1_value.html">v8::String::Value</a> json(message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a1aa4b5cc7d83218c3a361692bcdce007">GetJSON</a>());</div>
<div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;  Utf16ToAscii(*json, json.length(), print_buffer);</div>
<div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;}</div>
<div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;</div>
<div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;</div>
<div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> HostDispatchDispatchHandler() {</div>
<div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;  host_dispatch_barriers-&gt;semaphore_1-&gt;Signal();</div>
<div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;}</div>
<div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;</div>
<div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;</div>
<div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;<span class="keywordtype">void</span> HostDispatchV8Thread::Run() {</div>
<div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* source_1 = <span class="stringliteral">&quot;var y_global = 3;\n&quot;</span></div>
<div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;    <span class="stringliteral">&quot;function cat( new_value ) {\n&quot;</span></div>
<div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;    <span class="stringliteral">&quot;  var x = new_value;\n&quot;</span></div>
<div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;    <span class="stringliteral">&quot;  y_global = 4;\n&quot;</span></div>
<div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;    <span class="stringliteral">&quot;  x = 3 * x + 1;\n&quot;</span></div>
<div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;    <span class="stringliteral">&quot;  y_global = 5;\n&quot;</span></div>
<div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;    <span class="stringliteral">&quot;  return x;\n&quot;</span></div>
<div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;    <span class="stringliteral">&quot;}\n&quot;</span></div>
<div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;    <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* source_2 = <span class="stringliteral">&quot;cat(17);\n&quot;</span>;</div>
<div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;</div>
<div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;  <a class="code" href="../../df/d43/classv8_1_1_v8.html#a248c764067ee60c03ee370784c49f353">v8::V8::Initialize</a>();</div>
<div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;</div>
<div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;  <span class="comment">// Set up message and host dispatch handlers.</span></div>
<div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(HostDispatchMessageHandler);</div>
<div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#af826b9404d46b69da1fe569ff785cd7c">v8::Debug::SetHostDispatchHandler</a>(HostDispatchDispatchHandler, 10 <span class="comment">/* ms */</span>);</div>
<div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;</div>
<div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;  CompileRun(source_1);</div>
<div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;  host_dispatch_barriers-&gt;barrier_1.Wait();</div>
<div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;  host_dispatch_barriers-&gt;barrier_2.Wait();</div>
<div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;  CompileRun(source_2);</div>
<div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;}</div>
<div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;</div>
<div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;</div>
<div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;<span class="keywordtype">void</span> HostDispatchDebuggerThread::Run() {</div>
<div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kBufSize = 1000;</div>
<div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;  <a class="code" href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> buffer[kBufSize];</div>
<div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;</div>
<div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_1 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:101,&quot;</span></div>
<div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;      <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;      <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;setbreakpoint\&quot;,&quot;</span></div>
<div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;      <span class="stringliteral">&quot;\&quot;arguments\&quot;:{\&quot;type\&quot;:\&quot;function\&quot;,\&quot;target\&quot;:\&quot;cat\&quot;,\&quot;line\&quot;:3}}&quot;</span>;</div>
<div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* command_2 = <span class="stringliteral">&quot;{\&quot;seq\&quot;:102,&quot;</span></div>
<div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;      <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;      <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;continue\&quot;}&quot;</span>;</div>
<div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;</div>
<div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;  <span class="comment">// v8 thread initializes, runs source_1</span></div>
<div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;  host_dispatch_barriers-&gt;barrier_1.Wait();</div>
<div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;  <span class="comment">// 1: Set breakpoint in cat().</span></div>
<div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_1, buffer));</div>
<div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;</div>
<div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;  host_dispatch_barriers-&gt;barrier_2.Wait();</div>
<div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;  <span class="comment">// v8 thread starts compiling source_2.</span></div>
<div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;  <span class="comment">// Break happens, to run queued commands and host dispatches.</span></div>
<div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;  <span class="comment">// Wait for host dispatch to be processed.</span></div>
<div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;  host_dispatch_barriers-&gt;semaphore_1-&gt;Wait();</div>
<div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;  <span class="comment">// 2: Continue evaluation</span></div>
<div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(command_2, buffer));</div>
<div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;}</div>
<div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;</div>
<div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;</div>
<div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebuggerHostDispatch) {</div>
<div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;  HostDispatchDebuggerThread host_dispatch_debugger_thread;</div>
<div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;  HostDispatchV8Thread host_dispatch_v8_thread;</div>
<div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;  i::FLAG_debugger_auto_break = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;</div>
<div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;  <span class="comment">// Create a V8 environment</span></div>
<div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;  Barriers stack_allocated_host_dispatch_barriers;</div>
<div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;  stack_allocated_host_dispatch_barriers.Initialize();</div>
<div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;  host_dispatch_barriers = &amp;stack_allocated_host_dispatch_barriers;</div>
<div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;</div>
<div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;  host_dispatch_v8_thread.Start();</div>
<div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;  host_dispatch_debugger_thread.Start();</div>
<div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;</div>
<div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;  host_dispatch_v8_thread.Join();</div>
<div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;  host_dispatch_debugger_thread.Join();</div>
<div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;}</div>
<div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;</div>
<div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;</div>
<div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;<span class="comment">/* Test DebugMessageDispatch */</span></div>
<div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;<span class="comment">/* In this test, the V8 thread waits for a message from the debug thread.</span></div>
<div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;<span class="comment"> * The DebugMessageDispatchHandler is executed from the debugger thread</span></div>
<div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;<span class="comment"> * which signals the V8 thread to wake up.</span></div>
<div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;</div>
<div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;<span class="keyword">class </span>DebugMessageDispatchV8Thread : <span class="keyword">public</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html">v8::internal::Thread</a> {</div>
<div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;  DebugMessageDispatchV8Thread() : Thread(<span class="stringliteral">&quot;DebugMessageDispatchV8Thread&quot;</span>) { }</div>
<div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html#adc27ee0d7b66b8795db722f47a615cfe">Run</a>();</div>
<div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;};</div>
<div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;</div>
<div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;<span class="keyword">class </span>DebugMessageDispatchDebuggerThread : <span class="keyword">public</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html">v8::internal::Thread</a> {</div>
<div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;  DebugMessageDispatchDebuggerThread()</div>
<div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;      : Thread(<span class="stringliteral">&quot;DebugMessageDispatchDebuggerThread&quot;</span>) { }</div>
<div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html#adc27ee0d7b66b8795db722f47a615cfe">Run</a>();</div>
<div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;};</div>
<div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;</div>
<div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;Barriers* debug_message_dispatch_barriers;</div>
<div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;</div>
<div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;</div>
<div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugMessageHandler() {</div>
<div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;  debug_message_dispatch_barriers-&gt;semaphore_1-&gt;Signal();</div>
<div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;}</div>
<div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;</div>
<div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;</div>
<div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;<span class="keywordtype">void</span> DebugMessageDispatchV8Thread::Run() {</div>
<div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;  <a class="code" href="../../df/d43/classv8_1_1_v8.html#a248c764067ee60c03ee370784c49f353">v8::V8::Initialize</a>();</div>
<div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;</div>
<div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;  <span class="comment">// Set up debug message dispatch handler.</span></div>
<div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a08b70cdbfce3a171f21ed3f2c53192d2">v8::Debug::SetDebugMessageDispatchHandler</a>(DebugMessageHandler);</div>
<div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;</div>
<div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;  CompileRun(<span class="stringliteral">&quot;var y = 1 + 2;\n&quot;</span>);</div>
<div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;  debug_message_dispatch_barriers-&gt;barrier_1.Wait();</div>
<div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;  debug_message_dispatch_barriers-&gt;semaphore_1-&gt;Wait();</div>
<div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;  debug_message_dispatch_barriers-&gt;barrier_2.Wait();</div>
<div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;}</div>
<div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;</div>
<div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;</div>
<div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;<span class="keywordtype">void</span> DebugMessageDispatchDebuggerThread::Run() {</div>
<div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;  debug_message_dispatch_barriers-&gt;barrier_1.Wait();</div>
<div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;  SendContinueCommand();</div>
<div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;  debug_message_dispatch_barriers-&gt;barrier_2.Wait();</div>
<div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;}</div>
<div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;</div>
<div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;</div>
<div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebuggerDebugMessageDispatch) {</div>
<div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;  DebugMessageDispatchDebuggerThread debug_message_dispatch_debugger_thread;</div>
<div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;  DebugMessageDispatchV8Thread debug_message_dispatch_v8_thread;</div>
<div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;</div>
<div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;  i::FLAG_debugger_auto_break = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;</div>
<div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;  <span class="comment">// Create a V8 environment</span></div>
<div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;  Barriers stack_allocated_debug_message_dispatch_barriers;</div>
<div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;  stack_allocated_debug_message_dispatch_barriers.Initialize();</div>
<div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;  debug_message_dispatch_barriers =</div>
<div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;      &amp;stack_allocated_debug_message_dispatch_barriers;</div>
<div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;</div>
<div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;  debug_message_dispatch_v8_thread.Start();</div>
<div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;  debug_message_dispatch_debugger_thread.Start();</div>
<div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;</div>
<div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;  debug_message_dispatch_v8_thread.Join();</div>
<div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;  debug_message_dispatch_debugger_thread.Join();</div>
<div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;}</div>
<div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;</div>
<div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;</div>
<div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebuggerAgent) {</div>
<div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;  <a class="code" href="../../df/d43/classv8_1_1_v8.html#a248c764067ee60c03ee370784c49f353">v8::V8::Initialize</a>();</div>
<div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;  i::Debugger* debugger = i::Isolate::Current()-&gt;debugger();</div>
<div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;  <span class="comment">// Make sure these ports is not used by other tests to allow tests to run in</span></div>
<div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;  <span class="comment">// parallel.</span></div>
<div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kPort1 = 5858 + FlagDependentPortOffset();</div>
<div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kPort2 = 5857 + FlagDependentPortOffset();</div>
<div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kPort3 = 5856 + FlagDependentPortOffset();</div>
<div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;</div>
<div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;  <span class="comment">// Make a string with the port2 number.</span></div>
<div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kPortBufferLen = 6;</div>
<div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;  <span class="keywordtype">char</span> port2_str[kPortBufferLen];</div>
<div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;  OS::SNPrintF(<a class="code" href="../../d5/d7d/classv8_1_1internal_1_1_vector.html">i::Vector&lt;char&gt;</a>(port2_str, kPortBufferLen), <span class="stringliteral">&quot;%d&quot;</span>, kPort2);</div>
<div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;</div>
<div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;  <span class="keywordtype">bool</span> ok;</div>
<div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;</div>
<div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;  <span class="comment">// Initialize the socket library.</span></div>
<div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;  <a class="code" href="../../d9/d18/classv8_1_1internal_1_1_socket.html#a88ccb24206b05493e679a2746d6e3557">i::Socket::SetUp</a>();</div>
<div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;</div>
<div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;  <span class="comment">// Test starting and stopping the agent without any client connection.</span></div>
<div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;  debugger-&gt;StartAgent(<span class="stringliteral">&quot;test&quot;</span>, kPort1);</div>
<div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;  debugger-&gt;StopAgent();</div>
<div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;  <span class="comment">// Test starting the agent, connecting a client and shutting down the agent</span></div>
<div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;  <span class="comment">// with the client connected.</span></div>
<div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;  ok = debugger-&gt;StartAgent(<span class="stringliteral">&quot;test&quot;</span>, kPort2);</div>
<div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(ok);</div>
<div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;  debugger-&gt;WaitForAgent();</div>
<div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;  <a class="code" href="../../d9/d18/classv8_1_1internal_1_1_socket.html">i::Socket</a>* client = <a class="code" href="../../de/d32/classv8_1_1internal_1_1_o_s.html#ab8d98b5da29bb3d29c7bdb6f90f551a5">i::OS::CreateSocket</a>();</div>
<div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;  ok = client-&gt;<a class="code" href="../../d9/d18/classv8_1_1internal_1_1_socket.html#afb4603adf38a295e156ae2a7730c978f">Connect</a>(<span class="stringliteral">&quot;localhost&quot;</span>, port2_str);</div>
<div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(ok);</div>
<div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;  <span class="comment">// It is important to wait for a message from the agent. Otherwise,</span></div>
<div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;  <span class="comment">// we can close the server socket during &quot;accept&quot; syscall, making it failing</span></div>
<div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;  <span class="comment">// (at least on Linux), and the test will work incorrectly.</span></div>
<div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;  <span class="keywordtype">char</span> buf;</div>
<div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;  ok = client-&gt;<a class="code" href="../../d9/d18/classv8_1_1internal_1_1_socket.html#a9c3dc153870088c0353dbe9e5c6c1e76">Receive</a>(&amp;buf, 1) == 1;</div>
<div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(ok);</div>
<div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;  debugger-&gt;StopAgent();</div>
<div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;  <span class="keyword">delete</span> client;</div>
<div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;</div>
<div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;  <span class="comment">// Test starting and stopping the agent with the required port already</span></div>
<div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;  <span class="comment">// occoupied.</span></div>
<div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;  <a class="code" href="../../d9/d18/classv8_1_1internal_1_1_socket.html">i::Socket</a>* server = <a class="code" href="../../de/d32/classv8_1_1internal_1_1_o_s.html#ab8d98b5da29bb3d29c7bdb6f90f551a5">i::OS::CreateSocket</a>();</div>
<div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;  server-&gt;<a class="code" href="../../d9/d18/classv8_1_1internal_1_1_socket.html#a698c1c8e2b154d73e01f7a4100245234">Bind</a>(kPort3);</div>
<div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;</div>
<div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;  debugger-&gt;StartAgent(<span class="stringliteral">&quot;test&quot;</span>, kPort3);</div>
<div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;  debugger-&gt;StopAgent();</div>
<div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;</div>
<div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;  <span class="keyword">delete</span> server;</div>
<div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;}</div>
<div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;</div>
<div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;</div>
<div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;<span class="keyword">class </span>DebuggerAgentProtocolServerThread : <span class="keyword">public</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html">i::Thread</a> {</div>
<div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;  <span class="keyword">explicit</span> DebuggerAgentProtocolServerThread(<span class="keywordtype">int</span> port)</div>
<div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;      : Thread(<span class="stringliteral">&quot;DebuggerAgentProtocolServerThread&quot;</span>),</div>
<div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;        port_(port),</div>
<div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;        server_(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>),</div>
<div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;        client_(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>),</div>
<div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;        listening_(OS::CreateSemaphore(0)) {</div>
<div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;  }</div>
<div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;  ~DebuggerAgentProtocolServerThread() {</div>
<div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;    <span class="comment">// Close both sockets.</span></div>
<div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;    <span class="keyword">delete</span> client_;</div>
<div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;    <span class="keyword">delete</span> server_;</div>
<div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;    <span class="keyword">delete</span> listening_;</div>
<div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;  }</div>
<div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;</div>
<div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../db/d61/classv8_1_1internal_1_1_thread.html#adc27ee0d7b66b8795db722f47a615cfe">Run</a>();</div>
<div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;  <span class="keywordtype">void</span> WaitForListening() { listening_-&gt;Wait(); }</div>
<div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;  <span class="keywordtype">char</span>* body() { <span class="keywordflow">return</span> *body_; }</div>
<div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;</div>
<div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;  <span class="keywordtype">int</span> port_;</div>
<div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;  <a class="code" href="../../d1/dfa/classv8_1_1internal_1_1_smart_array_pointer.html">i::SmartArrayPointer&lt;char&gt;</a> body_;</div>
<div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;  <a class="code" href="../../d9/d18/classv8_1_1internal_1_1_socket.html">i::Socket</a>* server_;  <span class="comment">// Server socket used for bind/accept.</span></div>
<div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;  <a class="code" href="../../d9/d18/classv8_1_1internal_1_1_socket.html">i::Socket</a>* client_;  <span class="comment">// Single client connection used by the test.</span></div>
<div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;  <a class="code" href="../../dd/d6f/classv8_1_1internal_1_1_semaphore.html">i::Semaphore</a>* listening_;  <span class="comment">// Signalled when the server is in listen mode.</span></div>
<div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;};</div>
<div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;</div>
<div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;</div>
<div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;<span class="keywordtype">void</span> DebuggerAgentProtocolServerThread::Run() {</div>
<div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;  <span class="keywordtype">bool</span> ok;</div>
<div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;</div>
<div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;  <span class="comment">// Create the server socket and bind it to the requested port.</span></div>
<div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;  server_ = <a class="code" href="../../de/d32/classv8_1_1internal_1_1_o_s.html#ab8d98b5da29bb3d29c7bdb6f90f551a5">i::OS::CreateSocket</a>();</div>
<div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(server_ != <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;  ok = server_-&gt;Bind(port_);</div>
<div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(ok);</div>
<div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;</div>
<div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;  <span class="comment">// Listen for new connections.</span></div>
<div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;  ok = server_-&gt;Listen(1);</div>
<div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(ok);</div>
<div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;  listening_-&gt;Signal();</div>
<div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;</div>
<div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;  <span class="comment">// Accept a connection.</span></div>
<div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;  client_ = server_-&gt;Accept();</div>
<div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(client_ != <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;</div>
<div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;  <span class="comment">// Receive a debugger agent protocol message.</span></div>
<div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;  i::DebuggerAgentUtil::ReceiveMessage(client_);</div>
<div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;}</div>
<div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;</div>
<div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;</div>
<div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebuggerAgentProtocolOverflowHeader) {</div>
<div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;  <span class="comment">// Make sure this port is not used by other tests to allow tests to run in</span></div>
<div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;  <span class="comment">// parallel.</span></div>
<div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kPort = 5860 + FlagDependentPortOffset();</div>
<div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* kLocalhost = <span class="stringliteral">&quot;localhost&quot;</span>;</div>
<div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;</div>
<div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;  <span class="comment">// Make a string with the port number.</span></div>
<div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kPortBufferLen = 6;</div>
<div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;  <span class="keywordtype">char</span> port_str[kPortBufferLen];</div>
<div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;  OS::SNPrintF(<a class="code" href="../../d5/d7d/classv8_1_1internal_1_1_vector.html">i::Vector&lt;char&gt;</a>(port_str, kPortBufferLen), <span class="stringliteral">&quot;%d&quot;</span>, kPort);</div>
<div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;</div>
<div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;  <span class="comment">// Initialize the socket library.</span></div>
<div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;  <a class="code" href="../../d9/d18/classv8_1_1internal_1_1_socket.html#a88ccb24206b05493e679a2746d6e3557">i::Socket::SetUp</a>();</div>
<div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;</div>
<div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;  <span class="comment">// Create a socket server to receive a debugger agent message.</span></div>
<div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;  DebuggerAgentProtocolServerThread* server =</div>
<div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;      <span class="keyword">new</span> DebuggerAgentProtocolServerThread(kPort);</div>
<div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;  server-&gt;Start();</div>
<div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;  server-&gt;WaitForListening();</div>
<div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;</div>
<div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;  <span class="comment">// Connect.</span></div>
<div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;  <a class="code" href="../../d9/d18/classv8_1_1internal_1_1_socket.html">i::Socket</a>* client = <a class="code" href="../../de/d32/classv8_1_1internal_1_1_o_s.html#ab8d98b5da29bb3d29c7bdb6f90f551a5">i::OS::CreateSocket</a>();</div>
<div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(client != <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;  <span class="keywordtype">bool</span> ok = client-&gt;<a class="code" href="../../d9/d18/classv8_1_1internal_1_1_socket.html#afb4603adf38a295e156ae2a7730c978f">Connect</a>(kLocalhost, port_str);</div>
<div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(ok);</div>
<div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;</div>
<div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;  <span class="comment">// Send headers which overflow the receive buffer.</span></div>
<div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kBufferSize = 1000;</div>
<div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;  <span class="keywordtype">char</span> buffer[kBufferSize];</div>
<div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;</div>
<div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;  <span class="comment">// Long key and short value: XXXX....XXXX:0\r\n.</span></div>
<div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; kBufferSize - 4; i++) {</div>
<div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;    buffer[i] = <span class="charliteral">&#39;X&#39;</span>;</div>
<div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;  }</div>
<div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;  buffer[kBufferSize - 4] = <span class="charliteral">&#39;:&#39;</span>;</div>
<div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;  buffer[kBufferSize - 3] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;  buffer[kBufferSize - 2] = <span class="charliteral">&#39;\r&#39;</span>;</div>
<div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;  buffer[kBufferSize - 1] = <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;  client-&gt;<a class="code" href="../../d9/d18/classv8_1_1internal_1_1_socket.html#a9eec95d5f5af5300a39e67385795da2b">Send</a>(buffer, kBufferSize);</div>
<div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;</div>
<div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;  <span class="comment">// Short key and long value: X:XXXX....XXXX\r\n.</span></div>
<div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;  buffer[0] = <span class="charliteral">&#39;X&#39;</span>;</div>
<div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;  buffer[1] = <span class="charliteral">&#39;:&#39;</span>;</div>
<div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 2; i &lt; kBufferSize - 2; i++) {</div>
<div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;    buffer[i] = <span class="charliteral">&#39;X&#39;</span>;</div>
<div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;  }</div>
<div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;  buffer[kBufferSize - 2] = <span class="charliteral">&#39;\r&#39;</span>;</div>
<div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;  buffer[kBufferSize - 1] = <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;  client-&gt;<a class="code" href="../../d9/d18/classv8_1_1internal_1_1_socket.html#a9eec95d5f5af5300a39e67385795da2b">Send</a>(buffer, kBufferSize);</div>
<div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;</div>
<div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;  <span class="comment">// Add empty body to request.</span></div>
<div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* content_length_zero_header = <span class="stringliteral">&quot;Content-Length:0\r\n&quot;</span>;</div>
<div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;  client-&gt;<a class="code" href="../../d9/d18/classv8_1_1internal_1_1_socket.html#a9eec95d5f5af5300a39e67385795da2b">Send</a>(content_length_zero_header,</div>
<div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;               <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">StrLength</a>(content_length_zero_header));</div>
<div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;  client-&gt;<a class="code" href="../../d9/d18/classv8_1_1internal_1_1_socket.html#a9eec95d5f5af5300a39e67385795da2b">Send</a>(<span class="stringliteral">&quot;\r\n&quot;</span>, 2);</div>
<div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;</div>
<div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;  <span class="comment">// Wait until data is received.</span></div>
<div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;  server-&gt;Join();</div>
<div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;</div>
<div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;  <span class="comment">// Check for empty body.</span></div>
<div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(server-&gt;body() == <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;</div>
<div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;  <span class="comment">// Close the client before the server to avoid TIME_WAIT issues.</span></div>
<div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;  client-&gt;<a class="code" href="../../d9/d18/classv8_1_1internal_1_1_socket.html#ad3e81de2c0735f63bf28eab6069184d2">Shutdown</a>();</div>
<div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;  <span class="keyword">delete</span> client;</div>
<div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;  <span class="keyword">delete</span> server;</div>
<div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;}</div>
<div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;</div>
<div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;</div>
<div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;<span class="comment">// Test for issue http://code.google.com/p/v8/issues/detail?id=289.</span></div>
<div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;<span class="comment">// Make sure that DebugGetLoadedScripts doesn&#39;t return scripts</span></div>
<div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;<span class="comment">// with disposed external source.</span></div>
<div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;<span class="keyword">class </span>EmptyExternalStringResource : <span class="keyword">public</span> <a class="code" href="../../d3/d29/classv8_1_1_string_1_1_external_string_resource.html">v8::String::ExternalStringResource</a> {</div>
<div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;  EmptyExternalStringResource() { empty_[0] = 0; }</div>
<div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;  <span class="keyword">virtual</span> ~EmptyExternalStringResource() {}</div>
<div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">size_t</span> <a class="code" href="../../d3/d29/classv8_1_1_string_1_1_external_string_resource.html#aff947d59ef34f9120a8baf6ad167c36f">length</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> empty_.length(); }</div>
<div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;  <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">uint16_t</a>* <a class="code" href="../../d3/d29/classv8_1_1_string_1_1_external_string_resource.html#ae326749f0c4660b410e8413215a26e25">data</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> empty_.start(); }</div>
<div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;  <a class="code" href="../../db/d76/classv8_1_1internal_1_1_embedded_vector.html">::v8::internal::EmbeddedVector&lt;uint16_t, 1&gt;</a> empty_;</div>
<div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;};</div>
<div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;</div>
<div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;</div>
<div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugGetLoadedScripts) {</div>
<div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;</div>
<div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;  EmptyExternalStringResource source_ext_str;</div>
<div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> source = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a973aec0759c01b6fb411d7fca8300e6a">v8::String::NewExternal</a>(&amp;source_ext_str);</div>
<div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Script&gt;</a> evil_script(<a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(source));</div>
<div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;  <span class="comment">// &quot;use&quot; evil_script to make the compiler happy.</span></div>
<div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;  (void) evil_script;</div>
<div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;  Handle&lt;i::ExternalTwoByteString&gt; i_source(</div>
<div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;      <a class="code" href="../../d2/d61/classv8_1_1internal_1_1_external_two_byte_string.html#af3ce25de865a8cce7740f323036f3894">i::ExternalTwoByteString::cast</a>(*v8::Utils::OpenHandle(*source)));</div>
<div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;  <span class="comment">// This situation can happen if source was an external string disposed</span></div>
<div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;  <span class="comment">// by its owner.</span></div>
<div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;  i_source-&gt;set_resource(0);</div>
<div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;</div>
<div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;  <span class="keywordtype">bool</span> allow_natives_syntax = i::FLAG_allow_natives_syntax;</div>
<div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;  i::FLAG_allow_natives_syntax = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;  CompileRun(</div>
<div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;      <span class="stringliteral">&quot;var scripts = %DebugGetLoadedScripts();&quot;</span></div>
<div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;      <span class="stringliteral">&quot;var count = scripts.length;&quot;</span></div>
<div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;      <span class="stringliteral">&quot;for (var i = 0; i &lt; count; ++i) {&quot;</span></div>
<div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;      <span class="stringliteral">&quot;  scripts[i].line_ends;&quot;</span></div>
<div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;      <span class="stringliteral">&quot;}&quot;</span>);</div>
<div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;  <span class="comment">// Must not crash while accessing line_ends.</span></div>
<div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;  i::FLAG_allow_natives_syntax = allow_natives_syntax;</div>
<div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;</div>
<div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;  <span class="comment">// Some scripts are retrieved - at least the number of native scripts.</span></div>
<div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#ad5a1a3bc35696ef5a1070bca3a419c99">CHECK_GT</a>((*env)-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;count&quot;</span>))-&gt;Int32Value(), 8);</div>
<div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;}</div>
<div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;</div>
<div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;</div>
<div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;<span class="comment">// Test script break points set on lines.</span></div>
<div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ScriptNameAndData) {</div>
<div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;</div>
<div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;  <span class="comment">// Create functions for retrieving script name and data for the function on</span></div>
<div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;  <span class="comment">// the top frame when hitting a break point.</span></div>
<div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;  frame_script_name = CompileFunction(&amp;env,</div>
<div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;                                      frame_script_name_source,</div>
<div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;                                      <span class="stringliteral">&quot;frame_script_name&quot;</span>);</div>
<div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;  frame_script_data = CompileFunction(&amp;env,</div>
<div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;                                      frame_script_data_source,</div>
<div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;                                      <span class="stringliteral">&quot;frame_script_data&quot;</span>);</div>
<div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;  compiled_script_data = CompileFunction(&amp;env,</div>
<div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;                                         compiled_script_data_source,</div>
<div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;                                         <span class="stringliteral">&quot;compiled_script_data&quot;</span>);</div>
<div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;</div>
<div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakPointHitCount,</div>
<div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;</div>
<div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;  <span class="comment">// Test function source.</span></div>
<div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> script = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(</div>
<div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;    <span class="stringliteral">&quot;function f() {\n&quot;</span></div>
<div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;    <span class="stringliteral">&quot;  debugger;\n&quot;</span></div>
<div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;    <span class="stringliteral">&quot;}\n&quot;</span>);</div>
<div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;</div>
<div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;  <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a> origin1 = <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;name&quot;</span>));</div>
<div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Script&gt;</a> script1 = <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin1);</div>
<div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;  script1-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#a404713fb4376624c69f531ee50b9db90">SetData</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;data&quot;</span>));</div>
<div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;  script1-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#ab937ef8dba07a7ef516f11ef83debf92">Run</a>();</div>
<div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f;</div>
<div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;  f = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;</div>
<div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<span class="stringliteral">&quot;name&quot;</span>, last_script_name_hit);</div>
<div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<span class="stringliteral">&quot;data&quot;</span>, last_script_data_hit);</div>
<div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;</div>
<div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;  <span class="comment">// Compile the same script again without setting data. As the compilation</span></div>
<div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;  <span class="comment">// cache is disabled when debugging expect the data to be missing.</span></div>
<div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin1)-&gt;Run();</div>
<div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;  f = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<span class="stringliteral">&quot;name&quot;</span>, last_script_name_hit);</div>
<div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<span class="stringliteral">&quot;&quot;</span>, last_script_data_hit);  <span class="comment">// Undefined results in empty string.</span></div>
<div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;</div>
<div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> data_obj_source = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(</div>
<div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;    <span class="stringliteral">&quot;({ a: &#39;abc&#39;,\n&quot;</span></div>
<div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;    <span class="stringliteral">&quot;  b: 123,\n&quot;</span></div>
<div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;    <span class="stringliteral">&quot;  toString: function() { return this.a + &#39; &#39; + this.b; }\n&quot;</span></div>
<div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;    <span class="stringliteral">&quot;})\n&quot;</span>);</div>
<div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Value&gt;</a> data_obj = <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(data_obj_source)-&gt;Run();</div>
<div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;  <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a> origin2 = <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;new name&quot;</span>));</div>
<div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Script&gt;</a> script2 = <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin2);</div>
<div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;  script2-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#ab937ef8dba07a7ef516f11ef83debf92">Run</a>();</div>
<div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;  script2-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#a404713fb4376624c69f531ee50b9db90">SetData</a>(data_obj-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a91b68fb0b5558f1c9539015c1bbf7af2">ToString</a>());</div>
<div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;  f = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(3, break_point_hit_count);</div>
<div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<span class="stringliteral">&quot;new name&quot;</span>, last_script_name_hit);</div>
<div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<span class="stringliteral">&quot;abc 123&quot;</span>, last_script_data_hit);</div>
<div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;</div>
<div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Script&gt;</a> script3 =</div>
<div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;      <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(script, &amp;origin2, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>,</div>
<div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;                          <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;in compile&quot;</span>));</div>
<div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<span class="stringliteral">&quot;in compile&quot;</span>, last_script_data_hit);</div>
<div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;  script3-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#ab937ef8dba07a7ef516f11ef83debf92">Run</a>();</div>
<div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;  f = <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(4, break_point_hit_count);</div>
<div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<span class="stringliteral">&quot;in compile&quot;</span>, last_script_data_hit);</div>
<div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;}</div>
<div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;</div>
<div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;</div>
<div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d2/d78/classv8_1_1_persistent.html">v8::Persistent&lt;v8::Context&gt;</a> expected_context;</div>
<div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> expected_context_data;</div>
<div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;</div>
<div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;</div>
<div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;<span class="comment">// Check that the expected context is the one generating the debug event.</span></div>
<div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> ContextCheckMessageHandler(<span class="keyword">const</span> <a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a>&amp; message) {</div>
<div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#ad4a63f4bd528bea4a669152a350a964f">GetEventContext</a>() == expected_context);</div>
<div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#ad4a63f4bd528bea4a669152a350a964f">GetEventContext</a>()-&gt;<a class="code" href="../../df/d69/classv8_1_1_context.html#a9e6aee5f2a332aad0a8b6e785921de70">GetData</a>()-&gt;StrictEquals(</div>
<div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;      expected_context_data));</div>
<div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;  message_handler_hit_count++;</div>
<div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;</div>
<div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> print_buffer[1000];</div>
<div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;  <a class="code" href="../../d0/d6b/classv8_1_1_string_1_1_value.html">v8::String::Value</a> json(message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a1aa4b5cc7d83218c3a361692bcdce007">GetJSON</a>());</div>
<div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;  Utf16ToAscii(*json, json.length(), print_buffer);</div>
<div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;</div>
<div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;  <span class="comment">// Send a continue command for break events.</span></div>
<div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;  <span class="keywordflow">if</span> (IsBreakEventMessage(print_buffer)) {</div>
<div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;    SendContinueCommand();</div>
<div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;  }</div>
<div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;}</div>
<div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;</div>
<div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;</div>
<div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;<span class="comment">// Test which creates two contexts and sets different embedder data on each.</span></div>
<div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;<span class="comment">// Checks that this data is set correctly and that when the debug message</span></div>
<div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;<span class="comment">// handler is called the expected context is the one active.</span></div>
<div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ContextData) {</div>
<div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;</div>
<div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(ContextCheckMessageHandler);</div>
<div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;</div>
<div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;  <span class="comment">// Create two contexts.</span></div>
<div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160;  <a class="code" href="../../d2/d78/classv8_1_1_persistent.html">v8::Persistent&lt;v8::Context&gt;</a> context_1;</div>
<div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;  <a class="code" href="../../d2/d78/classv8_1_1_persistent.html">v8::Persistent&lt;v8::Context&gt;</a> context_2;</div>
<div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::ObjectTemplate&gt;</a> global_template =</div>
<div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::ObjectTemplate&gt;</a>();</div>
<div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> global_object = <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a>();</div>
<div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;  context_1 = <a class="code" href="../../df/d69/classv8_1_1_context.html#a860f2fec28426ee65e5aec8cbcb43478">v8::Context::New</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, global_template, global_object);</div>
<div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;  context_2 = <a class="code" href="../../df/d69/classv8_1_1_context.html#a860f2fec28426ee65e5aec8cbcb43478">v8::Context::New</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, global_template, global_object);</div>
<div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;</div>
<div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;  <span class="comment">// Default data value is undefined.</span></div>
<div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(context_1-&gt;GetData()-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a2858c3ff89ed8f4b756b94cbebcfe42f">IsUndefined</a>());</div>
<div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(context_2-&gt;GetData()-&gt;IsUndefined());</div>
<div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;</div>
<div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;  <span class="comment">// Set and check different data values.</span></div>
<div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> data_1 = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> data_2 = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;2&quot;</span>);</div>
<div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;  context_1-&gt;SetData(data_1);</div>
<div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;  context_2-&gt;SetData(data_2);</div>
<div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(context_1-&gt;GetData()-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#af0cd01c3c7904eb9537f2b15d09e8b76">StrictEquals</a>(data_1));</div>
<div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(context_2-&gt;GetData()-&gt;StrictEquals(data_2));</div>
<div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;</div>
<div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;  <span class="comment">// Simple test function which causes a break.</span></div>
<div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* source = <span class="stringliteral">&quot;function f() { debugger; }&quot;</span>;</div>
<div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;</div>
<div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;  <span class="comment">// Enter and run function in the first context.</span></div>
<div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;  {</div>
<div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;    <a class="code" href="../../de/d41/classv8_1_1_context_1_1_scope.html">v8::Context::Scope</a> context_scope(context_1);</div>
<div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;    expected_context = context_1;</div>
<div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;    expected_context_data = data_1;</div>
<div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;    <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f = CompileFunction(source, <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;    f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(context_1-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;  }</div>
<div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;</div>
<div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;</div>
<div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;  <span class="comment">// Enter and run function in the second context.</span></div>
<div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;  {</div>
<div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;    <a class="code" href="../../de/d41/classv8_1_1_context_1_1_scope.html">v8::Context::Scope</a> context_scope(context_2);</div>
<div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;    expected_context = context_2;</div>
<div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;    expected_context_data = data_2;</div>
<div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;    <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f = CompileFunction(source, <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;    f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(context_2-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;  }</div>
<div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;</div>
<div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;  <span class="comment">// Two times compile event and two times break event.</span></div>
<div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#ad5a1a3bc35696ef5a1070bca3a419c99">CHECK_GT</a>(message_handler_hit_count, 4);</div>
<div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;</div>
<div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;}</div>
<div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;</div>
<div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;</div>
<div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;<span class="comment">// Debug message handler which issues a debug break when it hits a break event.</span></div>
<div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> message_handler_break_hit_count = 0;</div>
<div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugBreakMessageHandler(<span class="keyword">const</span> <a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a>&amp; message) {</div>
<div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;  <span class="comment">// Schedule a debug break for break events.</span></div>
<div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;  <span class="keywordflow">if</span> (message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a0633ca6194b8474fe39d4cffcc52b859">IsEvent</a>() &amp;&amp; message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a5e8220bed8b3bf7c537711ce6b9653d6">GetEvent</a>() == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;    message_handler_break_hit_count++;</div>
<div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;    <span class="keywordflow">if</span> (message_handler_break_hit_count == 1) {</div>
<div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;      <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;    }</div>
<div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;  }</div>
<div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;</div>
<div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;  <span class="comment">// Issue a continue command if this event will not cause the VM to start</span></div>
<div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;  <span class="comment">// running.</span></div>
<div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;  <span class="keywordflow">if</span> (!message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a1e7c258f96226ebca0fb9663e81407b9">WillStartRunning</a>()) {</div>
<div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;    SendContinueCommand();</div>
<div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;  }</div>
<div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;}</div>
<div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;</div>
<div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;</div>
<div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;<span class="comment">// Test that a debug break can be scheduled while in a message handler.</span></div>
<div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugBreakInMessageHandler) {</div>
<div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;</div>
<div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(DebugBreakMessageHandler);</div>
<div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;</div>
<div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;  <span class="comment">// Test functions.</span></div>
<div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* script = <span class="stringliteral">&quot;function f() { debugger; g(); } function g() { }&quot;</span>;</div>
<div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;  CompileRun(script);</div>
<div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f =</div>
<div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> g =</div>
<div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;g&quot;</span>)));</div>
<div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;</div>
<div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;  <span class="comment">// Call f then g. The debugger statement in f will casue a break which will</span></div>
<div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;  <span class="comment">// cause another break.</span></div>
<div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, message_handler_break_hit_count);</div>
<div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;  <span class="comment">// Calling g will not cause any additional breaks.</span></div>
<div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;  g-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, message_handler_break_hit_count);</div>
<div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;}</div>
<div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;</div>
<div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;</div>
<div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;<span class="preprocessor">#ifndef V8_INTERPRETED_REGEXP</span></div>
<div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;<span class="comment">// Debug event handler which gets the function on the top frame and schedules a</span></div>
<div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;<span class="comment">// break a number of times.</span></div>
<div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventDebugBreak(</div>
<div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;    <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;</div>
<div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;  <span class="keywordflow">if</span> (event == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;    break_point_hit_count++;</div>
<div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;</div>
<div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;    <span class="comment">// Get the name of the top frame function.</span></div>
<div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;    <span class="keywordflow">if</span> (!frame_function_name.<a class="code" href="../../d3/dd5/classv8_1_1_handle.html#aaef62c8761ddd1b95824fc57b1b277b5">IsEmpty</a>()) {</div>
<div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;      <span class="comment">// Get the name of the function.</span></div>
<div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 2;</div>
<div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv[argc] = { exec_state, <a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(0) };</div>
<div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result = frame_function_name-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(exec_state,</div>
<div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;                                                               argc, argv);</div>
<div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;      <span class="keywordflow">if</span> (result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a2858c3ff89ed8f4b756b94cbebcfe42f">IsUndefined</a>()) {</div>
<div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;        last_function_hit[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;        <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#abfee0d12e50e0499ce0e3eac2612b3a2">IsString</a>());</div>
<div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;        <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> function_name(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a91b68fb0b5558f1c9539015c1bbf7af2">ToString</a>());</div>
<div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;        function_name-&gt;WriteAscii(last_function_hit);</div>
<div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;      }</div>
<div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;    }</div>
<div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;</div>
<div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;    <span class="comment">// Keep forcing breaks.</span></div>
<div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;    <span class="keywordflow">if</span> (break_point_hit_count &lt; 20) {</div>
<div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;      <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;    }</div>
<div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;  }</div>
<div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;}</div>
<div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;</div>
<div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;</div>
<div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(RegExpDebugBreak) {</div>
<div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;  <span class="comment">// This test only applies to native regexps.</span></div>
<div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;</div>
<div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;  <span class="comment">// Create a function for checking the function when hitting a break point.</span></div>
<div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;  frame_function_name = CompileFunction(&amp;env,</div>
<div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;                                        frame_function_name_source,</div>
<div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;                                        <span class="stringliteral">&quot;frame_function_name&quot;</span>);</div>
<div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;</div>
<div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;  <span class="comment">// Test RegExp which matches white spaces and comments at the begining of a</span></div>
<div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;  <span class="comment">// source line.</span></div>
<div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* script =</div>
<div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;    <span class="stringliteral">&quot;var sourceLineBeginningSkip = /^(?:[ \\v\\h]*(?:\\/\\*.*?\\*\\/)*)*/;\n&quot;</span></div>
<div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;    <span class="stringliteral">&quot;function f(s) { return s.match(sourceLineBeginningSkip)[0].length; }&quot;</span>;</div>
<div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;</div>
<div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f = CompileFunction(script, <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv[argc] = { <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;  /* xxx */ a=0;&quot;</span>) };</div>
<div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Value&gt;</a> result = f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv);</div>
<div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(12, result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a3837d763158f1718969858a513670c62">Int32Value</a>());</div>
<div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;</div>
<div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventDebugBreak);</div>
<div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;  result = f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), argc, argv);</div>
<div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;</div>
<div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;  <span class="comment">// Check that there was only one break event. Matching RegExp should not</span></div>
<div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;  <span class="comment">// cause Break events.</span></div>
<div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(<span class="stringliteral">&quot;f&quot;</span>, last_function_hit);</div>
<div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;}</div>
<div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;<span class="preprocessor">#endif  // V8_INTERPRETED_REGEXP</span></div>
<div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;</div>
<div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;</div>
<div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;<span class="comment">// Common part of EvalContextData and NestedBreakEventContextData tests.</span></div>
<div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> ExecuteScriptForContextCheck() {</div>
<div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;  <span class="comment">// Create a context.</span></div>
<div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;  <a class="code" href="../../d2/d78/classv8_1_1_persistent.html">v8::Persistent&lt;v8::Context&gt;</a> context_1;</div>
<div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::ObjectTemplate&gt;</a> global_template =</div>
<div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::ObjectTemplate&gt;</a>();</div>
<div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;  context_1 = <a class="code" href="../../df/d69/classv8_1_1_context.html#a860f2fec28426ee65e5aec8cbcb43478">v8::Context::New</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>, global_template);</div>
<div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;</div>
<div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;  <span class="comment">// Default data value is undefined.</span></div>
<div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(context_1-&gt;GetData()-&gt;IsUndefined());</div>
<div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;</div>
<div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;  <span class="comment">// Set and check a data value.</span></div>
<div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> data_1 = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;  context_1-&gt;SetData(data_1);</div>
<div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(context_1-&gt;GetData()-&gt;StrictEquals(data_1));</div>
<div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;</div>
<div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;  <span class="comment">// Simple test function with eval that causes a break.</span></div>
<div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* source = <span class="stringliteral">&quot;function f() { eval(&#39;debugger;&#39;); }&quot;</span>;</div>
<div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;</div>
<div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;  <span class="comment">// Enter and run function in the context.</span></div>
<div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;  {</div>
<div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;    <a class="code" href="../../de/d41/classv8_1_1_context_1_1_scope.html">v8::Context::Scope</a> context_scope(context_1);</div>
<div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;    expected_context = context_1;</div>
<div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;    expected_context_data = data_1;</div>
<div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;    <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f = CompileFunction(source, <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;    f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(context_1-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;  }</div>
<div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;}</div>
<div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;</div>
<div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;</div>
<div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;<span class="comment">// Test which creates a context and sets embedder data on it. Checks that this</span></div>
<div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;<span class="comment">// data is set correctly and that when the debug message handler is called for</span></div>
<div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;<span class="comment">// break event in an eval statement the expected context is the one returned by</span></div>
<div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;<span class="comment">// Message.GetEventContext.</span></div>
<div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(EvalContextData) {</div>
<div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(ContextCheckMessageHandler);</div>
<div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;</div>
<div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;  ExecuteScriptForContextCheck();</div>
<div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;</div>
<div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;  <span class="comment">// One time compile event and one time break event.</span></div>
<div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#ad5a1a3bc35696ef5a1070bca3a419c99">CHECK_GT</a>(message_handler_hit_count, 2);</div>
<div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;}</div>
<div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;</div>
<div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160;</div>
<div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> sent_eval = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> break_count = 0;</div>
<div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> continue_command_send_count = 0;</div>
<div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;<span class="comment">// Check that the expected context is the one generating the debug event</span></div>
<div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;<span class="comment">// including the case of nested break event.</span></div>
<div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEvalContextCheckMessageHandler(</div>
<div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a>&amp; message) {</div>
<div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#ad4a63f4bd528bea4a669152a350a964f">GetEventContext</a>() == expected_context);</div>
<div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#ad4a63f4bd528bea4a669152a350a964f">GetEventContext</a>()-&gt;<a class="code" href="../../df/d69/classv8_1_1_context.html#a9e6aee5f2a332aad0a8b6e785921de70">GetData</a>()-&gt;StrictEquals(</div>
<div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;      expected_context_data));</div>
<div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;  message_handler_hit_count++;</div>
<div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;</div>
<div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> print_buffer[1000];</div>
<div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;  <a class="code" href="../../d0/d6b/classv8_1_1_string_1_1_value.html">v8::String::Value</a> json(message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a1aa4b5cc7d83218c3a361692bcdce007">GetJSON</a>());</div>
<div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;  Utf16ToAscii(*json, json.length(), print_buffer);</div>
<div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;</div>
<div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;  <span class="keywordflow">if</span> (IsBreakEventMessage(print_buffer)) {</div>
<div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;    break_count++;</div>
<div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;    <span class="keywordflow">if</span> (!sent_eval) {</div>
<div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;      sent_eval = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;</div>
<div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> kBufferSize = 1000;</div>
<div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;      <a class="code" href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> buffer[kBufferSize];</div>
<div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span>* eval_command =</div>
<div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;          <span class="stringliteral">&quot;{\&quot;seq\&quot;:0,&quot;</span></div>
<div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;          <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;          <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;evaluate\&quot;,&quot;</span></div>
<div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;          <span class="stringliteral">&quot;\&quot;arguments\&quot;:{\&quot;expression\&quot;:\&quot;debugger;\&quot;,&quot;</span></div>
<div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;          <span class="stringliteral">&quot;\&quot;global\&quot;:true,\&quot;disable_break\&quot;:false}}&quot;</span>;</div>
<div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;</div>
<div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;      <span class="comment">// Send evaluate command.</span></div>
<div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;      <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(eval_command, buffer));</div>
<div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;      <span class="comment">// It&#39;s a break event caused by the evaluation request above.</span></div>
<div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;      SendContinueCommand();</div>
<div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;      continue_command_send_count++;</div>
<div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;    }</div>
<div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IsEvaluateResponseMessage(print_buffer) &amp;&amp;</div>
<div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;      continue_command_send_count &lt; 2) {</div>
<div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;    <span class="comment">// Response to the evaluation request. We&#39;re still on the breakpoint so</span></div>
<div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;    <span class="comment">// send continue.</span></div>
<div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;    SendContinueCommand();</div>
<div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;    continue_command_send_count++;</div>
<div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;  }</div>
<div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;}</div>
<div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;</div>
<div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;</div>
<div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;<span class="comment">// Tests that context returned for break event is correct when the event occurs</span></div>
<div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;<span class="comment">// in &#39;evaluate&#39; debugger request.</span></div>
<div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(NestedBreakEventContextData) {</div>
<div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;  break_count = 0;</div>
<div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;  message_handler_hit_count = 0;</div>
<div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(DebugEvalContextCheckMessageHandler);</div>
<div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;</div>
<div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;  ExecuteScriptForContextCheck();</div>
<div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;</div>
<div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;  <span class="comment">// One time compile event and two times break event.</span></div>
<div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#ad5a1a3bc35696ef5a1070bca3a419c99">CHECK_GT</a>(message_handler_hit_count, 3);</div>
<div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;</div>
<div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;  <span class="comment">// One break from the source and another from the evaluate request.</span></div>
<div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(break_count, 2);</div>
<div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;}</div>
<div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;</div>
<div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160;</div>
<div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;<span class="comment">// Debug event listener which counts the script collected events.</span></div>
<div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;<span class="keywordtype">int</span> script_collected_count = 0;</div>
<div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventScriptCollectedEvent(<a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;                                           <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;                                           <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;                                           <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;  <span class="comment">// Count the number of breaks.</span></div>
<div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;  <span class="keywordflow">if</span> (event == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba7af8b3b962aadf798e813a27173fc4c3">v8::ScriptCollected</a>) {</div>
<div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;    script_collected_count++;</div>
<div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;  }</div>
<div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;}</div>
<div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;</div>
<div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;</div>
<div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;<span class="comment">// Test that scripts collected are reported through the debug event listener.</span></div>
<div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ScriptCollectedEvent) {</div>
<div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;  v8::internal::Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;  script_collected_count = 0;</div>
<div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;</div>
<div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;  <span class="comment">// Request the loaded scripts to initialize the debugger script cache.</span></div>
<div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;  debug-&gt;GetLoadedScripts();</div>
<div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;</div>
<div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;  <span class="comment">// Do garbage collection to ensure that only the script in this test will be</span></div>
<div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;  <span class="comment">// collected afterwards.</span></div>
<div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;  <a class="code" href="../../d8/d1e/isolate_8h.html#a4e8c3dc786eeec70c7c26763ea3d2ef7">HEAP</a>-&gt;CollectAllGarbage(Heap::kNoGCFlags);</div>
<div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;</div>
<div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;  script_collected_count = 0;</div>
<div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventScriptCollectedEvent,</div>
<div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;  {</div>
<div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;    <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;eval(&#39;a=1&#39;)&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;    <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;eval(&#39;a=2&#39;)&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;  }</div>
<div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;</div>
<div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;  <span class="comment">// Do garbage collection to collect the script above which is no longer</span></div>
<div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160;  <span class="comment">// referenced.</span></div>
<div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;  <a class="code" href="../../d8/d1e/isolate_8h.html#a4e8c3dc786eeec70c7c26763ea3d2ef7">HEAP</a>-&gt;CollectAllGarbage(Heap::kNoGCFlags);</div>
<div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;</div>
<div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, script_collected_count);</div>
<div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;</div>
<div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;}</div>
<div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;</div>
<div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;</div>
<div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;<span class="comment">// Debug event listener which counts the script collected events.</span></div>
<div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;<span class="keywordtype">int</span> script_collected_message_count = 0;</div>
<div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> ScriptCollectedMessageHandler(<span class="keyword">const</span> <a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a>&amp; message) {</div>
<div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;  <span class="comment">// Count the number of scripts collected.</span></div>
<div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160;  <span class="keywordflow">if</span> (message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a0633ca6194b8474fe39d4cffcc52b859">IsEvent</a>() &amp;&amp; message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a5e8220bed8b3bf7c537711ce6b9653d6">GetEvent</a>() == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba7af8b3b962aadf798e813a27173fc4c3">v8::ScriptCollected</a>) {</div>
<div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;    script_collected_message_count++;</div>
<div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Context&gt;</a> context = message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#ad4a63f4bd528bea4a669152a350a964f">GetEventContext</a>();</div>
<div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(context.<a class="code" href="../../d3/dd5/classv8_1_1_handle.html#aaef62c8761ddd1b95824fc57b1b277b5">IsEmpty</a>());</div>
<div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;  }</div>
<div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;}</div>
<div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;</div>
<div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;</div>
<div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;<span class="comment">// Test that GetEventContext doesn&#39;t fail and return empty handle for</span></div>
<div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;<span class="comment">// ScriptCollected events.</span></div>
<div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ScriptCollectedEventContext) {</div>
<div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160;  v8::internal::Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;  script_collected_message_count = 0;</div>
<div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;</div>
<div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;  { <span class="comment">// Scope for the DebugLocalContext.</span></div>
<div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;    DebugLocalContext env;</div>
<div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;</div>
<div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;    <span class="comment">// Request the loaded scripts to initialize the debugger script cache.</span></div>
<div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;    debug-&gt;GetLoadedScripts();</div>
<div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;</div>
<div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;    <span class="comment">// Do garbage collection to ensure that only the script in this test will be</span></div>
<div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;    <span class="comment">// collected afterwards.</span></div>
<div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;    <a class="code" href="../../d8/d1e/isolate_8h.html#a4e8c3dc786eeec70c7c26763ea3d2ef7">HEAP</a>-&gt;CollectAllGarbage(Heap::kNoGCFlags);</div>
<div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;</div>
<div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;    <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(ScriptCollectedMessageHandler);</div>
<div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;    {</div>
<div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;      <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;eval(&#39;a=1&#39;)&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;      <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;eval(&#39;a=2&#39;)&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;    }</div>
<div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;  }</div>
<div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;</div>
<div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160;  <span class="comment">// Do garbage collection to collect the script above which is no longer</span></div>
<div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;  <span class="comment">// referenced.</span></div>
<div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;  <a class="code" href="../../d8/d1e/isolate_8h.html#a4e8c3dc786eeec70c7c26763ea3d2ef7">HEAP</a>-&gt;CollectAllGarbage(Heap::kNoGCFlags);</div>
<div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;</div>
<div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, script_collected_message_count);</div>
<div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;</div>
<div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;}</div>
<div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;</div>
<div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;</div>
<div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;<span class="comment">// Debug event listener which counts the after compile events.</span></div>
<div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;<span class="keywordtype">int</span> after_compile_message_count = 0;</div>
<div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> AfterCompileMessageHandler(<span class="keyword">const</span> <a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a>&amp; message) {</div>
<div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;  <span class="comment">// Count the number of scripts collected.</span></div>
<div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;  <span class="keywordflow">if</span> (message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a0633ca6194b8474fe39d4cffcc52b859">IsEvent</a>()) {</div>
<div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;    <span class="keywordflow">if</span> (message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a5e8220bed8b3bf7c537711ce6b9653d6">GetEvent</a>() == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79bace1d56bc37c286ed08718089a72b1419">v8::AfterCompile</a>) {</div>
<div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;      after_compile_message_count++;</div>
<div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a5e8220bed8b3bf7c537711ce6b9653d6">GetEvent</a>() == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;      SendContinueCommand();</div>
<div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;    }</div>
<div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;  }</div>
<div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;}</div>
<div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;</div>
<div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;</div>
<div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;<span class="comment">// Tests that after compile event is sent as many times as there are scripts</span></div>
<div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;<span class="comment">// compiled.</span></div>
<div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(AfterCompileMessageWhenMessageHandlerIsReset) {</div>
<div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;  after_compile_message_count = 0;</div>
<div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* script = <span class="stringliteral">&quot;var a=1&quot;</span>;</div>
<div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;</div>
<div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(AfterCompileMessageHandler);</div>
<div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(script))-&gt;Run();</div>
<div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;</div>
<div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(AfterCompileMessageHandler);</div>
<div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(script))-&gt;Run();</div>
<div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;</div>
<div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;  <span class="comment">// Setting listener to NULL should cause debugger unload.</span></div>
<div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;</div>
<div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;  <span class="comment">// Compilation cache should be disabled when debugger is active.</span></div>
<div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, after_compile_message_count);</div>
<div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;}</div>
<div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;</div>
<div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;</div>
<div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;<span class="comment">// Tests that break event is sent when message handler is reset.</span></div>
<div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(BreakMessageWhenMessageHandlerIsReset) {</div>
<div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;  after_compile_message_count = 0;</div>
<div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* script = <span class="stringliteral">&quot;function f() {};&quot;</span>;</div>
<div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;</div>
<div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(AfterCompileMessageHandler);</div>
<div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(script))-&gt;Run();</div>
<div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;</div>
<div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(AfterCompileMessageHandler);</div>
<div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f =</div>
<div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;</div>
<div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;  <span class="comment">// Setting message handler to NULL should cause debugger unload.</span></div>
<div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;</div>
<div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;  <span class="comment">// Compilation cache should be disabled when debugger is active.</span></div>
<div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, after_compile_message_count);</div>
<div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;}</div>
<div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;</div>
<div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;</div>
<div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> exception_event_count = 0;</div>
<div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> ExceptionMessageHandler(<span class="keyword">const</span> <a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a>&amp; message) {</div>
<div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;  <span class="keywordflow">if</span> (message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a0633ca6194b8474fe39d4cffcc52b859">IsEvent</a>() &amp;&amp; message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a5e8220bed8b3bf7c537711ce6b9653d6">GetEvent</a>() == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba17524a77b7673b0322cc15aa590d1e41">v8::Exception</a>) {</div>
<div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;    exception_event_count++;</div>
<div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;    SendContinueCommand();</div>
<div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;  }</div>
<div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;}</div>
<div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;</div>
<div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;</div>
<div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;<span class="comment">// Tests that exception event is sent when message handler is reset.</span></div>
<div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ExceptionMessageWhenMessageHandlerIsReset) {</div>
<div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;</div>
<div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;  <span class="comment">// For this test, we want to break on uncaught exceptions:</span></div>
<div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160;  ChangeBreakOnException(<span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;</div>
<div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160;  exception_event_count = 0;</div>
<div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* script = <span class="stringliteral">&quot;function f() {throw new Error()};&quot;</span>;</div>
<div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;</div>
<div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(AfterCompileMessageHandler);</div>
<div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(script))-&gt;Run();</div>
<div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;</div>
<div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(ExceptionMessageHandler);</div>
<div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f =</div>
<div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;      <a class="code" href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local&lt;v8::Function&gt;::Cast</a>(env-&gt;Global()-&gt;Get(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;f&quot;</span>)));</div>
<div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;</div>
<div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;  <span class="comment">// Setting message handler to NULL should cause debugger unload.</span></div>
<div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160;</div>
<div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, exception_event_count);</div>
<div class="line"><a name="l06716"></a><span class="lineno"> 6716</span>&#160;}</div>
<div class="line"><a name="l06717"></a><span class="lineno"> 6717</span>&#160;</div>
<div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160;</div>
<div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;<span class="comment">// Tests after compile event is sent when there are some provisional</span></div>
<div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;<span class="comment">// breakpoints out of the scripts lines range.</span></div>
<div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ProvisionalBreakpointOnLineOutOfRange) {</div>
<div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* script = <span class="stringliteral">&quot;function f() {};&quot;</span>;</div>
<div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* resource_name = <span class="stringliteral">&quot;test_resource&quot;</span>;</div>
<div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;</div>
<div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;  <span class="comment">// Set a couple of provisional breakpoint on lines out of the script lines</span></div>
<div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;  <span class="comment">// range.</span></div>
<div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160;  <span class="keywordtype">int</span> sbp1 = SetScriptBreakPointByNameFromJS(resource_name, 3,</div>
<div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160;                                             -1 <span class="comment">/* no column */</span>);</div>
<div class="line"><a name="l06732"></a><span class="lineno"> 6732</span>&#160;  <span class="keywordtype">int</span> sbp2 = SetScriptBreakPointByNameFromJS(resource_name, 5, 5);</div>
<div class="line"><a name="l06733"></a><span class="lineno"> 6733</span>&#160;</div>
<div class="line"><a name="l06734"></a><span class="lineno"> 6734</span>&#160;  after_compile_message_count = 0;</div>
<div class="line"><a name="l06735"></a><span class="lineno"> 6735</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(AfterCompileMessageHandler);</div>
<div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160;</div>
<div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160;  <a class="code" href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a> origin(</div>
<div class="line"><a name="l06738"></a><span class="lineno"> 6738</span>&#160;      <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(resource_name),</div>
<div class="line"><a name="l06739"></a><span class="lineno"> 6739</span>&#160;      <a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(10),</div>
<div class="line"><a name="l06740"></a><span class="lineno"> 6740</span>&#160;      <a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(1));</div>
<div class="line"><a name="l06741"></a><span class="lineno"> 6741</span>&#160;  <span class="comment">// Compile a script whose first line number is greater than the breakpoints&#39;</span></div>
<div class="line"><a name="l06742"></a><span class="lineno"> 6742</span>&#160;  <span class="comment">// lines.</span></div>
<div class="line"><a name="l06743"></a><span class="lineno"> 6743</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(script), &amp;origin)-&gt;Run();</div>
<div class="line"><a name="l06744"></a><span class="lineno"> 6744</span>&#160;</div>
<div class="line"><a name="l06745"></a><span class="lineno"> 6745</span>&#160;  <span class="comment">// If the script is compiled successfully there is exactly one after compile</span></div>
<div class="line"><a name="l06746"></a><span class="lineno"> 6746</span>&#160;  <span class="comment">// event. In case of an exception in debugger code after compile event is not</span></div>
<div class="line"><a name="l06747"></a><span class="lineno"> 6747</span>&#160;  <span class="comment">// sent.</span></div>
<div class="line"><a name="l06748"></a><span class="lineno"> 6748</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, after_compile_message_count);</div>
<div class="line"><a name="l06749"></a><span class="lineno"> 6749</span>&#160;</div>
<div class="line"><a name="l06750"></a><span class="lineno"> 6750</span>&#160;  ClearBreakPointFromJS(sbp1);</div>
<div class="line"><a name="l06751"></a><span class="lineno"> 6751</span>&#160;  ClearBreakPointFromJS(sbp2);</div>
<div class="line"><a name="l06752"></a><span class="lineno"> 6752</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06753"></a><span class="lineno"> 6753</span>&#160;}</div>
<div class="line"><a name="l06754"></a><span class="lineno"> 6754</span>&#160;</div>
<div class="line"><a name="l06755"></a><span class="lineno"> 6755</span>&#160;</div>
<div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> BreakMessageHandler(<span class="keyword">const</span> <a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a>&amp; message) {</div>
<div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;  <a class="code" href="../../dd/d38/classv8_1_1internal_1_1_isolate.html">i::Isolate</a>* isolate = i::Isolate::Current();</div>
<div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160;  <span class="keywordflow">if</span> (message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a0633ca6194b8474fe39d4cffcc52b859">IsEvent</a>() &amp;&amp; message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a5e8220bed8b3bf7c537711ce6b9653d6">GetEvent</a>() == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;    <span class="comment">// Count the number of breaks.</span></div>
<div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160;    break_point_hit_count++;</div>
<div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160;</div>
<div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;    <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;    message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a1aa4b5cc7d83218c3a361692bcdce007">GetJSON</a>();</div>
<div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160;</div>
<div class="line"><a name="l06765"></a><span class="lineno"> 6765</span>&#160;    SendContinueCommand();</div>
<div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a0633ca6194b8474fe39d4cffcc52b859">IsEvent</a>() &amp;&amp; message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a5e8220bed8b3bf7c537711ce6b9653d6">GetEvent</a>() == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79bace1d56bc37c286ed08718089a72b1419">v8::AfterCompile</a>) {</div>
<div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160;    <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;</div>
<div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;    <span class="keywordtype">bool</span> is_debug_break = isolate-&gt;<a class="code" href="../../dd/d38/classv8_1_1internal_1_1_isolate.html#ac4bd5767160ff3b2e233134435e83fc3">stack_guard</a>()-&gt;IsDebugBreak();</div>
<div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160;    <span class="comment">// Force DebugBreak flag while serializer is working.</span></div>
<div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160;    isolate-&gt;<a class="code" href="../../dd/d38/classv8_1_1internal_1_1_isolate.html#ac4bd5767160ff3b2e233134435e83fc3">stack_guard</a>()-&gt;DebugBreak();</div>
<div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160;</div>
<div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160;    <span class="comment">// Force serialization to trigger some internal JS execution.</span></div>
<div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;    message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a1aa4b5cc7d83218c3a361692bcdce007">GetJSON</a>();</div>
<div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;</div>
<div class="line"><a name="l06776"></a><span class="lineno"> 6776</span>&#160;    <span class="comment">// Restore previous state.</span></div>
<div class="line"><a name="l06777"></a><span class="lineno"> 6777</span>&#160;    <span class="keywordflow">if</span> (is_debug_break) {</div>
<div class="line"><a name="l06778"></a><span class="lineno"> 6778</span>&#160;      isolate-&gt;<a class="code" href="../../dd/d38/classv8_1_1internal_1_1_isolate.html#ac4bd5767160ff3b2e233134435e83fc3">stack_guard</a>()-&gt;DebugBreak();</div>
<div class="line"><a name="l06779"></a><span class="lineno"> 6779</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06780"></a><span class="lineno"> 6780</span>&#160;      isolate-&gt;<a class="code" href="../../dd/d38/classv8_1_1internal_1_1_isolate.html#ac4bd5767160ff3b2e233134435e83fc3">stack_guard</a>()-&gt;<a class="code" href="../../d4/d71/classv8_1_1internal_1_1_stack_guard.html#a72e96e9d3857635ac17443562bc0aebe">Continue</a>(<a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a521544c43b8fe1dae91883cd28080da3aff699505fa2894108ea9f35f845abe64">i::DEBUGBREAK</a>);</div>
<div class="line"><a name="l06781"></a><span class="lineno"> 6781</span>&#160;    }</div>
<div class="line"><a name="l06782"></a><span class="lineno"> 6782</span>&#160;  }</div>
<div class="line"><a name="l06783"></a><span class="lineno"> 6783</span>&#160;}</div>
<div class="line"><a name="l06784"></a><span class="lineno"> 6784</span>&#160;</div>
<div class="line"><a name="l06785"></a><span class="lineno"> 6785</span>&#160;</div>
<div class="line"><a name="l06786"></a><span class="lineno"> 6786</span>&#160;<span class="comment">// Test that if DebugBreak is forced it is ignored when code from</span></div>
<div class="line"><a name="l06787"></a><span class="lineno"> 6787</span>&#160;<span class="comment">// debug-delay.js is executed.</span></div>
<div class="line"><a name="l06788"></a><span class="lineno"> 6788</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(NoDebugBreakInAfterCompileMessageHandler) {</div>
<div class="line"><a name="l06789"></a><span class="lineno"> 6789</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06790"></a><span class="lineno"> 6790</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l06791"></a><span class="lineno"> 6791</span>&#160;</div>
<div class="line"><a name="l06792"></a><span class="lineno"> 6792</span>&#160;  <span class="comment">// Register a debug event listener which sets the break flag and counts.</span></div>
<div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(BreakMessageHandler);</div>
<div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160;</div>
<div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160;  <span class="comment">// Set the debug break flag.</span></div>
<div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;</div>
<div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;  <span class="comment">// Create a function for testing stepping.</span></div>
<div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src = <span class="stringliteral">&quot;function f() { eval(&#39;var x = 10;&#39;); } &quot;</span>;</div>
<div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> f = CompileFunction(&amp;env, src, <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l06801"></a><span class="lineno"> 6801</span>&#160;</div>
<div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160;  <span class="comment">// There should be only one break event.</span></div>
<div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160;</div>
<div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;  <span class="comment">// Set the debug break flag again.</span></div>
<div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;  f-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160;  <span class="comment">// There should be one more break event when the script is evaluated in &#39;f&#39;.</span></div>
<div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, break_point_hit_count);</div>
<div class="line"><a name="l06810"></a><span class="lineno"> 6810</span>&#160;</div>
<div class="line"><a name="l06811"></a><span class="lineno"> 6811</span>&#160;  <span class="comment">// Get rid of the debug message handler.</span></div>
<div class="line"><a name="l06812"></a><span class="lineno"> 6812</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06813"></a><span class="lineno"> 6813</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l06814"></a><span class="lineno"> 6814</span>&#160;}</div>
<div class="line"><a name="l06815"></a><span class="lineno"> 6815</span>&#160;</div>
<div class="line"><a name="l06816"></a><span class="lineno"> 6816</span>&#160;</div>
<div class="line"><a name="l06817"></a><span class="lineno"> 6817</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> counting_message_handler_counter;</div>
<div class="line"><a name="l06818"></a><span class="lineno"> 6818</span>&#160;</div>
<div class="line"><a name="l06819"></a><span class="lineno"> 6819</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> CountingMessageHandler(<span class="keyword">const</span> <a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a>&amp; message) {</div>
<div class="line"><a name="l06820"></a><span class="lineno"> 6820</span>&#160;  counting_message_handler_counter++;</div>
<div class="line"><a name="l06821"></a><span class="lineno"> 6821</span>&#160;}</div>
<div class="line"><a name="l06822"></a><span class="lineno"> 6822</span>&#160;</div>
<div class="line"><a name="l06823"></a><span class="lineno"> 6823</span>&#160;<span class="comment">// Test that debug messages get processed when ProcessDebugMessages is called.</span></div>
<div class="line"><a name="l06824"></a><span class="lineno"> 6824</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(ProcessDebugMessages) {</div>
<div class="line"><a name="l06825"></a><span class="lineno"> 6825</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06826"></a><span class="lineno"> 6826</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l06827"></a><span class="lineno"> 6827</span>&#160;</div>
<div class="line"><a name="l06828"></a><span class="lineno"> 6828</span>&#160;  counting_message_handler_counter = 0;</div>
<div class="line"><a name="l06829"></a><span class="lineno"> 6829</span>&#160;</div>
<div class="line"><a name="l06830"></a><span class="lineno"> 6830</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(CountingMessageHandler);</div>
<div class="line"><a name="l06831"></a><span class="lineno"> 6831</span>&#160;</div>
<div class="line"><a name="l06832"></a><span class="lineno"> 6832</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kBufferSize = 1000;</div>
<div class="line"><a name="l06833"></a><span class="lineno"> 6833</span>&#160;  <a class="code" href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> buffer[kBufferSize];</div>
<div class="line"><a name="l06834"></a><span class="lineno"> 6834</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* scripts_command =</div>
<div class="line"><a name="l06835"></a><span class="lineno"> 6835</span>&#160;    <span class="stringliteral">&quot;{\&quot;seq\&quot;:0,&quot;</span></div>
<div class="line"><a name="l06836"></a><span class="lineno"> 6836</span>&#160;     <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l06837"></a><span class="lineno"> 6837</span>&#160;     <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;scripts\&quot;}&quot;</span>;</div>
<div class="line"><a name="l06838"></a><span class="lineno"> 6838</span>&#160;</div>
<div class="line"><a name="l06839"></a><span class="lineno"> 6839</span>&#160;  <span class="comment">// Send scripts command.</span></div>
<div class="line"><a name="l06840"></a><span class="lineno"> 6840</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(scripts_command, buffer));</div>
<div class="line"><a name="l06841"></a><span class="lineno"> 6841</span>&#160;</div>
<div class="line"><a name="l06842"></a><span class="lineno"> 6842</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, counting_message_handler_counter);</div>
<div class="line"><a name="l06843"></a><span class="lineno"> 6843</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a5aaf984433cde031c9e8b8a3da1ed699">v8::Debug::ProcessDebugMessages</a>();</div>
<div class="line"><a name="l06844"></a><span class="lineno"> 6844</span>&#160;  <span class="comment">// At least one message should come</span></div>
<div class="line"><a name="l06845"></a><span class="lineno"> 6845</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a54b4a23953fc7a4f455e4fc47e05c215">CHECK_GE</a>(counting_message_handler_counter, 1);</div>
<div class="line"><a name="l06846"></a><span class="lineno"> 6846</span>&#160;</div>
<div class="line"><a name="l06847"></a><span class="lineno"> 6847</span>&#160;  counting_message_handler_counter = 0;</div>
<div class="line"><a name="l06848"></a><span class="lineno"> 6848</span>&#160;</div>
<div class="line"><a name="l06849"></a><span class="lineno"> 6849</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(scripts_command, buffer));</div>
<div class="line"><a name="l06850"></a><span class="lineno"> 6850</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(scripts_command, buffer));</div>
<div class="line"><a name="l06851"></a><span class="lineno"> 6851</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, counting_message_handler_counter);</div>
<div class="line"><a name="l06852"></a><span class="lineno"> 6852</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a5aaf984433cde031c9e8b8a3da1ed699">v8::Debug::ProcessDebugMessages</a>();</div>
<div class="line"><a name="l06853"></a><span class="lineno"> 6853</span>&#160;  <span class="comment">// At least two messages should come</span></div>
<div class="line"><a name="l06854"></a><span class="lineno"> 6854</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a54b4a23953fc7a4f455e4fc47e05c215">CHECK_GE</a>(counting_message_handler_counter, 2);</div>
<div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160;</div>
<div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;  <span class="comment">// Get rid of the debug message handler.</span></div>
<div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160;}</div>
<div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;</div>
<div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160;</div>
<div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;<span class="keyword">struct </span>BacktraceData {</div>
<div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> frame_counter;</div>
<div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> MessageHandler(<span class="keyword">const</span> <a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a>&amp; message) {</div>
<div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;    <span class="keywordtype">char</span> print_buffer[1000];</div>
<div class="line"><a name="l06866"></a><span class="lineno"> 6866</span>&#160;    <a class="code" href="../../d0/d6b/classv8_1_1_string_1_1_value.html">v8::String::Value</a> json(message.<a class="code" href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a1aa4b5cc7d83218c3a361692bcdce007">GetJSON</a>());</div>
<div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160;    Utf16ToAscii(*json, json.length(), print_buffer, 1000);</div>
<div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;</div>
<div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160;    <span class="keywordflow">if</span> (strstr(print_buffer, <span class="stringliteral">&quot;backtrace&quot;</span>) == <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>) {</div>
<div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160;    }</div>
<div class="line"><a name="l06872"></a><span class="lineno"> 6872</span>&#160;    frame_counter = GetTotalFramesInt(print_buffer);</div>
<div class="line"><a name="l06873"></a><span class="lineno"> 6873</span>&#160;  }</div>
<div class="line"><a name="l06874"></a><span class="lineno"> 6874</span>&#160;};</div>
<div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;</div>
<div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;<span class="keywordtype">int</span> BacktraceData::frame_counter;</div>
<div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160;</div>
<div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;</div>
<div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160;<span class="comment">// Test that debug messages get processed when ProcessDebugMessages is called.</span></div>
<div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(Backtrace) {</div>
<div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;</div>
<div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(BacktraceData::MessageHandler);</div>
<div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160;</div>
<div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> kBufferSize = 1000;</div>
<div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;  <a class="code" href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> buffer[kBufferSize];</div>
<div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* scripts_command =</div>
<div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;    <span class="stringliteral">&quot;{\&quot;seq\&quot;:0,&quot;</span></div>
<div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;     <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;request\&quot;,&quot;</span></div>
<div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160;     <span class="stringliteral">&quot;\&quot;command\&quot;:\&quot;backtrace\&quot;}&quot;</span>;</div>
<div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160;</div>
<div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160;  <span class="comment">// Check backtrace from ProcessDebugMessages.</span></div>
<div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160;  BacktraceData::frame_counter = -10;</div>
<div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(scripts_command, buffer));</div>
<div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a5aaf984433cde031c9e8b8a3da1ed699">v8::Debug::ProcessDebugMessages</a>();</div>
<div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(BacktraceData::frame_counter, 0);</div>
<div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;</div>
<div class="line"><a name="l06899"></a><span class="lineno"> 6899</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> void0 = <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;void(0)&quot;</span>);</div>
<div class="line"><a name="l06900"></a><span class="lineno"> 6900</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Script&gt;</a> script = <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(void0, void0);</div>
<div class="line"><a name="l06901"></a><span class="lineno"> 6901</span>&#160;</div>
<div class="line"><a name="l06902"></a><span class="lineno"> 6902</span>&#160;  <span class="comment">// Check backtrace from &quot;void(0)&quot; script.</span></div>
<div class="line"><a name="l06903"></a><span class="lineno"> 6903</span>&#160;  BacktraceData::frame_counter = -10;</div>
<div class="line"><a name="l06904"></a><span class="lineno"> 6904</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a>(buffer, AsciiToUtf16(scripts_command, buffer));</div>
<div class="line"><a name="l06905"></a><span class="lineno"> 6905</span>&#160;  script-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#ab937ef8dba07a7ef516f11ef83debf92">Run</a>();</div>
<div class="line"><a name="l06906"></a><span class="lineno"> 6906</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(BacktraceData::frame_counter, 1);</div>
<div class="line"><a name="l06907"></a><span class="lineno"> 6907</span>&#160;</div>
<div class="line"><a name="l06908"></a><span class="lineno"> 6908</span>&#160;  <span class="comment">// Get rid of the debug message handler.</span></div>
<div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160;}</div>
<div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160;</div>
<div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;</div>
<div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(GetMirror) {</div>
<div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> obj = <a class="code" href="../../de/d13/classv8_1_1_debug.html#a1e4ddeff91cf83b89ee2fb20af16f6b2">v8::Debug::GetMirror</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;hodja&quot;</span>));</div>
<div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Function&gt;</a> run_test = <a class="code" href="../../d3/dd5/classv8_1_1_handle.html#aa096c30831ccfdc10b35ef64698b5af2">v8::Handle&lt;v8::Function&gt;::Cast</a>(</div>
<div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160;      <a class="code" href="../../d0/d35/classv8_1_1_script.html#ac1223816dab9d0df897a09a5fb899466">v8::Script::New</a>(</div>
<div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160;          <a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(</div>
<div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;              <span class="stringliteral">&quot;function runTest(mirror) {&quot;</span></div>
<div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160;              <span class="stringliteral">&quot;  return mirror.isString() &amp;&amp; (mirror.length() == 5);&quot;</span></div>
<div class="line"><a name="l06923"></a><span class="lineno"> 6923</span>&#160;              <span class="stringliteral">&quot;}&quot;</span></div>
<div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160;              <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><a name="l06925"></a><span class="lineno"> 6925</span>&#160;              <span class="stringliteral">&quot;runTest;&quot;</span>))-&gt;Run());</div>
<div class="line"><a name="l06926"></a><span class="lineno"> 6926</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result = run_test-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 1, &amp;obj);</div>
<div class="line"><a name="l06927"></a><span class="lineno"> 6927</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a3d46ba6a258e0029819606fe47d50c24">IsTrue</a>());</div>
<div class="line"><a name="l06928"></a><span class="lineno"> 6928</span>&#160;}</div>
<div class="line"><a name="l06929"></a><span class="lineno"> 6929</span>&#160;</div>
<div class="line"><a name="l06930"></a><span class="lineno"> 6930</span>&#160;</div>
<div class="line"><a name="l06931"></a><span class="lineno"> 6931</span>&#160;<span class="comment">// Test that the debug break flag works with function.apply.</span></div>
<div class="line"><a name="l06932"></a><span class="lineno"> 6932</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugBreakFunctionApply) {</div>
<div class="line"><a name="l06933"></a><span class="lineno"> 6933</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l06934"></a><span class="lineno"> 6934</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l06935"></a><span class="lineno"> 6935</span>&#160;</div>
<div class="line"><a name="l06936"></a><span class="lineno"> 6936</span>&#160;  <span class="comment">// Create a function for testing breaking in apply.</span></div>
<div class="line"><a name="l06937"></a><span class="lineno"> 6937</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(</div>
<div class="line"><a name="l06938"></a><span class="lineno"> 6938</span>&#160;      &amp;env,</div>
<div class="line"><a name="l06939"></a><span class="lineno"> 6939</span>&#160;      <span class="stringliteral">&quot;function baz(x) { }&quot;</span></div>
<div class="line"><a name="l06940"></a><span class="lineno"> 6940</span>&#160;      <span class="stringliteral">&quot;function bar(x) { baz(); }&quot;</span></div>
<div class="line"><a name="l06941"></a><span class="lineno"> 6941</span>&#160;      <span class="stringliteral">&quot;function foo(){ bar.apply(this, [1]); }&quot;</span>,</div>
<div class="line"><a name="l06942"></a><span class="lineno"> 6942</span>&#160;      <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l06943"></a><span class="lineno"> 6943</span>&#160;</div>
<div class="line"><a name="l06944"></a><span class="lineno"> 6944</span>&#160;  <span class="comment">// Register a debug event listener which steps and counts.</span></div>
<div class="line"><a name="l06945"></a><span class="lineno"> 6945</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakMax);</div>
<div class="line"><a name="l06946"></a><span class="lineno"> 6946</span>&#160;</div>
<div class="line"><a name="l06947"></a><span class="lineno"> 6947</span>&#160;  <span class="comment">// Set the debug break flag before calling the code using function.apply.</span></div>
<div class="line"><a name="l06948"></a><span class="lineno"> 6948</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l06949"></a><span class="lineno"> 6949</span>&#160;</div>
<div class="line"><a name="l06950"></a><span class="lineno"> 6950</span>&#160;  <span class="comment">// Limit the number of debug breaks. This is a regression test for issue 493</span></div>
<div class="line"><a name="l06951"></a><span class="lineno"> 6951</span>&#160;  <span class="comment">// where this test would enter an infinite loop.</span></div>
<div class="line"><a name="l06952"></a><span class="lineno"> 6952</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l06953"></a><span class="lineno"> 6953</span>&#160;  max_break_point_hit_count = 10000;  <span class="comment">// 10000 =&gt; infinite loop.</span></div>
<div class="line"><a name="l06954"></a><span class="lineno"> 6954</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;Global(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06955"></a><span class="lineno"> 6955</span>&#160;</div>
<div class="line"><a name="l06956"></a><span class="lineno"> 6956</span>&#160;  <span class="comment">// When keeping the debug break several break will happen.</span></div>
<div class="line"><a name="l06957"></a><span class="lineno"> 6957</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#ad5a1a3bc35696ef5a1070bca3a419c99">CHECK_GT</a>(break_point_hit_count, 1);</div>
<div class="line"><a name="l06958"></a><span class="lineno"> 6958</span>&#160;</div>
<div class="line"><a name="l06959"></a><span class="lineno"> 6959</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l06960"></a><span class="lineno"> 6960</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l06961"></a><span class="lineno"> 6961</span>&#160;}</div>
<div class="line"><a name="l06962"></a><span class="lineno"> 6962</span>&#160;</div>
<div class="line"><a name="l06963"></a><span class="lineno"> 6963</span>&#160;</div>
<div class="line"><a name="l06964"></a><span class="lineno"> 6964</span>&#160;<a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Context&gt;</a> debugee_context;</div>
<div class="line"><a name="l06965"></a><span class="lineno"> 6965</span>&#160;<a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Context&gt;</a> debugger_context;</div>
<div class="line"><a name="l06966"></a><span class="lineno"> 6966</span>&#160;</div>
<div class="line"><a name="l06967"></a><span class="lineno"> 6967</span>&#160;</div>
<div class="line"><a name="l06968"></a><span class="lineno"> 6968</span>&#160;<span class="comment">// Property getter that checks that current and calling contexts</span></div>
<div class="line"><a name="l06969"></a><span class="lineno"> 6969</span>&#160;<span class="comment">// are both the debugee contexts.</span></div>
<div class="line"><a name="l06970"></a><span class="lineno"> 6970</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> NamedGetterWithCallingContextCheck(</div>
<div class="line"><a name="l06971"></a><span class="lineno"> 6971</span>&#160;    <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::String&gt;</a> name,</div>
<div class="line"><a name="l06972"></a><span class="lineno"> 6972</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../da/d41/classv8_1_1_accessor_info.html">v8::AccessorInfo</a>&amp; info) {</div>
<div class="line"><a name="l06973"></a><span class="lineno"> 6973</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(0, strcmp(*<a class="code" href="../../d8/dcb/classv8_1_1_string_1_1_ascii_value.html">v8::String::AsciiValue</a>(name), <span class="stringliteral">&quot;a&quot;</span>));</div>
<div class="line"><a name="l06974"></a><span class="lineno"> 6974</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Context&gt;</a> current = <a class="code" href="../../df/d69/classv8_1_1_context.html#a9eb1408c458c49ea98d4e3a8f7617f0f">v8::Context::GetCurrent</a>();</div>
<div class="line"><a name="l06975"></a><span class="lineno"> 6975</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(current == debugee_context);</div>
<div class="line"><a name="l06976"></a><span class="lineno"> 6976</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(current != debugger_context);</div>
<div class="line"><a name="l06977"></a><span class="lineno"> 6977</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Context&gt;</a> calling = <a class="code" href="../../df/d69/classv8_1_1_context.html#a90f77effd76202d7370a234414fa06c6">v8::Context::GetCalling</a>();</div>
<div class="line"><a name="l06978"></a><span class="lineno"> 6978</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(calling == debugee_context);</div>
<div class="line"><a name="l06979"></a><span class="lineno"> 6979</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(calling != debugger_context);</div>
<div class="line"><a name="l06980"></a><span class="lineno"> 6980</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Int32::New</a>(1);</div>
<div class="line"><a name="l06981"></a><span class="lineno"> 6981</span>&#160;}</div>
<div class="line"><a name="l06982"></a><span class="lineno"> 6982</span>&#160;</div>
<div class="line"><a name="l06983"></a><span class="lineno"> 6983</span>&#160;</div>
<div class="line"><a name="l06984"></a><span class="lineno"> 6984</span>&#160;<span class="comment">// Debug event listener that checks if the first argument of a function is</span></div>
<div class="line"><a name="l06985"></a><span class="lineno"> 6985</span>&#160;<span class="comment">// an object with property &#39;a&#39; == 1. If the property has custom accessor</span></div>
<div class="line"><a name="l06986"></a><span class="lineno"> 6986</span>&#160;<span class="comment">// this handler will eventually invoke it.</span></div>
<div class="line"><a name="l06987"></a><span class="lineno"> 6987</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventGetAtgumentPropertyValue(</div>
<div class="line"><a name="l06988"></a><span class="lineno"> 6988</span>&#160;    <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l06989"></a><span class="lineno"> 6989</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l06990"></a><span class="lineno"> 6990</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l06991"></a><span class="lineno"> 6991</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l06992"></a><span class="lineno"> 6992</span>&#160;  <span class="keywordflow">if</span> (event == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l06993"></a><span class="lineno"> 6993</span>&#160;    break_point_hit_count++;</div>
<div class="line"><a name="l06994"></a><span class="lineno"> 6994</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(debugger_context == <a class="code" href="../../df/d69/classv8_1_1_context.html#a9eb1408c458c49ea98d4e3a8f7617f0f">v8::Context::GetCurrent</a>());</div>
<div class="line"><a name="l06995"></a><span class="lineno"> 6995</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Function&gt;</a> func(<a class="code" href="../../d5/d54/classv8_1_1_function.html#a2e69da7035a0d06c61e94dbefe1e866b">v8::Function::Cast</a>(*CompileRun(</div>
<div class="line"><a name="l06996"></a><span class="lineno"> 6996</span>&#160;        <span class="stringliteral">&quot;(function(exec_state) {\n&quot;</span></div>
<div class="line"><a name="l06997"></a><span class="lineno"> 6997</span>&#160;        <span class="stringliteral">&quot;    return (exec_state.frame(0).argumentValue(0).property(&#39;a&#39;).\n&quot;</span></div>
<div class="line"><a name="l06998"></a><span class="lineno"> 6998</span>&#160;        <span class="stringliteral">&quot;            value().value() == 1);\n&quot;</span></div>
<div class="line"><a name="l06999"></a><span class="lineno"> 6999</span>&#160;        <span class="stringliteral">&quot;})&quot;</span>)));</div>
<div class="line"><a name="l07000"></a><span class="lineno"> 7000</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line"><a name="l07001"></a><span class="lineno"> 7001</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv[argc] = { exec_state };</div>
<div class="line"><a name="l07002"></a><span class="lineno"> 7002</span>&#160;    <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result = func-&gt;Call(exec_state, argc, argv);</div>
<div class="line"><a name="l07003"></a><span class="lineno"> 7003</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a3d46ba6a258e0029819606fe47d50c24">IsTrue</a>());</div>
<div class="line"><a name="l07004"></a><span class="lineno"> 7004</span>&#160;  }</div>
<div class="line"><a name="l07005"></a><span class="lineno"> 7005</span>&#160;}</div>
<div class="line"><a name="l07006"></a><span class="lineno"> 7006</span>&#160;</div>
<div class="line"><a name="l07007"></a><span class="lineno"> 7007</span>&#160;</div>
<div class="line"><a name="l07008"></a><span class="lineno"> 7008</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(CallingContextIsNotDebugContext) {</div>
<div class="line"><a name="l07009"></a><span class="lineno"> 7009</span>&#160;  v8::internal::Debug* debug = v8::internal::Isolate::Current()-&gt;debug();</div>
<div class="line"><a name="l07010"></a><span class="lineno"> 7010</span>&#160;  <span class="comment">// Create and enter a debugee context.</span></div>
<div class="line"><a name="l07011"></a><span class="lineno"> 7011</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l07012"></a><span class="lineno"> 7012</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l07013"></a><span class="lineno"> 7013</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l07014"></a><span class="lineno"> 7014</span>&#160;</div>
<div class="line"><a name="l07015"></a><span class="lineno"> 7015</span>&#160;  <span class="comment">// Save handles to the debugger and debugee contexts to be used in</span></div>
<div class="line"><a name="l07016"></a><span class="lineno"> 7016</span>&#160;  <span class="comment">// NamedGetterWithCallingContextCheck.</span></div>
<div class="line"><a name="l07017"></a><span class="lineno"> 7017</span>&#160;  debugee_context = <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Context&gt;</a>(*env);</div>
<div class="line"><a name="l07018"></a><span class="lineno"> 7018</span>&#160;  debugger_context = <a class="code" href="../../d4/d4b/classv8_1_1_utils.html#a91962d30779259da776009f0cfb58291">v8::Utils::ToLocal</a>(debug-&gt;debug_context());</div>
<div class="line"><a name="l07019"></a><span class="lineno"> 7019</span>&#160;</div>
<div class="line"><a name="l07020"></a><span class="lineno"> 7020</span>&#160;  <span class="comment">// Create object with &#39;a&#39; property accessor.</span></div>
<div class="line"><a name="l07021"></a><span class="lineno"> 7021</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::ObjectTemplate&gt;</a> named = <a class="code" href="../../db/d5f/classv8_1_1_object_template.html#ada5e0fda7225c6a63c54f1d07bdc718c">v8::ObjectTemplate::New</a>();</div>
<div class="line"><a name="l07022"></a><span class="lineno"> 7022</span>&#160;  named-&gt;SetAccessor(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;a&quot;</span>),</div>
<div class="line"><a name="l07023"></a><span class="lineno"> 7023</span>&#160;                     NamedGetterWithCallingContextCheck);</div>
<div class="line"><a name="l07024"></a><span class="lineno"> 7024</span>&#160;  env-&gt;<a class="code" href="../../df/d69/classv8_1_1_context.html#a8fc7f005c25f7ac02e35c8ebf51183b3">Global</a>()-&gt;Set(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;obj&quot;</span>),</div>
<div class="line"><a name="l07025"></a><span class="lineno"> 7025</span>&#160;                     named-&gt;NewInstance());</div>
<div class="line"><a name="l07026"></a><span class="lineno"> 7026</span>&#160;</div>
<div class="line"><a name="l07027"></a><span class="lineno"> 7027</span>&#160;  <span class="comment">// Register the debug event listener</span></div>
<div class="line"><a name="l07028"></a><span class="lineno"> 7028</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventGetAtgumentPropertyValue);</div>
<div class="line"><a name="l07029"></a><span class="lineno"> 7029</span>&#160;</div>
<div class="line"><a name="l07030"></a><span class="lineno"> 7030</span>&#160;  <span class="comment">// Create a function that invokes debugger.</span></div>
<div class="line"><a name="l07031"></a><span class="lineno"> 7031</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Function&gt;</a> foo = CompileFunction(</div>
<div class="line"><a name="l07032"></a><span class="lineno"> 7032</span>&#160;      &amp;env,</div>
<div class="line"><a name="l07033"></a><span class="lineno"> 7033</span>&#160;      <span class="stringliteral">&quot;function bar(x) { debugger; }&quot;</span></div>
<div class="line"><a name="l07034"></a><span class="lineno"> 7034</span>&#160;      <span class="stringliteral">&quot;function foo(){ bar(obj); }&quot;</span>,</div>
<div class="line"><a name="l07035"></a><span class="lineno"> 7035</span>&#160;      <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l07036"></a><span class="lineno"> 7036</span>&#160;</div>
<div class="line"><a name="l07037"></a><span class="lineno"> 7037</span>&#160;  break_point_hit_count = 0;</div>
<div class="line"><a name="l07038"></a><span class="lineno"> 7038</span>&#160;  foo-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(env-&gt;<a class="code" href="../../df/d69/classv8_1_1_context.html#a8fc7f005c25f7ac02e35c8ebf51183b3">Global</a>(), 0, <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l07039"></a><span class="lineno"> 7039</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, break_point_hit_count);</div>
<div class="line"><a name="l07040"></a><span class="lineno"> 7040</span>&#160;</div>
<div class="line"><a name="l07041"></a><span class="lineno"> 7041</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l07042"></a><span class="lineno"> 7042</span>&#160;  debugee_context = <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Context&gt;</a>();</div>
<div class="line"><a name="l07043"></a><span class="lineno"> 7043</span>&#160;  debugger_context = <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Context&gt;</a>();</div>
<div class="line"><a name="l07044"></a><span class="lineno"> 7044</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l07045"></a><span class="lineno"> 7045</span>&#160;}</div>
<div class="line"><a name="l07046"></a><span class="lineno"> 7046</span>&#160;</div>
<div class="line"><a name="l07047"></a><span class="lineno"> 7047</span>&#160;</div>
<div class="line"><a name="l07048"></a><span class="lineno"> 7048</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugContextIsPreservedBetweenAccesses) {</div>
<div class="line"><a name="l07049"></a><span class="lineno"> 7049</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l07050"></a><span class="lineno"> 7050</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Context&gt;</a> context1 = <a class="code" href="../../de/d13/classv8_1_1_debug.html#a5461ea199a445a303a65198a7521eb94">v8::Debug::GetDebugContext</a>();</div>
<div class="line"><a name="l07051"></a><span class="lineno"> 7051</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Context&gt;</a> context2 = <a class="code" href="../../de/d13/classv8_1_1_debug.html#a5461ea199a445a303a65198a7521eb94">v8::Debug::GetDebugContext</a>();</div>
<div class="line"><a name="l07052"></a><span class="lineno"> 7052</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(*context1, *context2);</div>
<div class="line"><a name="l07053"></a><span class="lineno"> 7053</span>&#160;}</div>
<div class="line"><a name="l07054"></a><span class="lineno"> 7054</span>&#160;</div>
<div class="line"><a name="l07055"></a><span class="lineno"> 7055</span>&#160;</div>
<div class="line"><a name="l07056"></a><span class="lineno"> 7056</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> expected_callback_data;</div>
<div class="line"><a name="l07057"></a><span class="lineno"> 7057</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventContextChecker(<span class="keyword">const</span> <a class="code" href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html">v8::Debug::EventDetails</a>&amp; details) {</div>
<div class="line"><a name="l07058"></a><span class="lineno"> 7058</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(details.<a class="code" href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html#ad4a63f4bd528bea4a669152a350a964f">GetEventContext</a>() == expected_context);</div>
<div class="line"><a name="l07059"></a><span class="lineno"> 7059</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(expected_callback_data, details.<a class="code" href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html#a9f42d78445ecb9dce59ee8f80c9197fe">GetCallbackData</a>());</div>
<div class="line"><a name="l07060"></a><span class="lineno"> 7060</span>&#160;}</div>
<div class="line"><a name="l07061"></a><span class="lineno"> 7061</span>&#160;</div>
<div class="line"><a name="l07062"></a><span class="lineno"> 7062</span>&#160;<span class="comment">// Check that event details contain context where debug event occured.</span></div>
<div class="line"><a name="l07063"></a><span class="lineno"> 7063</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugEventContext) {</div>
<div class="line"><a name="l07064"></a><span class="lineno"> 7064</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l07065"></a><span class="lineno"> 7065</span>&#160;  expected_callback_data = <a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Int32::New</a>(2010);</div>
<div class="line"><a name="l07066"></a><span class="lineno"> 7066</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a6193450d47c80996b33eeae196c2535d">v8::Debug::SetDebugEventListener2</a>(DebugEventContextChecker,</div>
<div class="line"><a name="l07067"></a><span class="lineno"> 7067</span>&#160;                                    expected_callback_data);</div>
<div class="line"><a name="l07068"></a><span class="lineno"> 7068</span>&#160;  expected_context = <a class="code" href="../../df/d69/classv8_1_1_context.html#a860f2fec28426ee65e5aec8cbcb43478">v8::Context::New</a>();</div>
<div class="line"><a name="l07069"></a><span class="lineno"> 7069</span>&#160;  <a class="code" href="../../de/d41/classv8_1_1_context_1_1_scope.html">v8::Context::Scope</a> context_scope(expected_context);</div>
<div class="line"><a name="l07070"></a><span class="lineno"> 7070</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;(function(){debugger;})();&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l07071"></a><span class="lineno"> 7071</span>&#160;  expected_context.<a class="code" href="../../d2/d78/classv8_1_1_persistent.html#a6e2d745cdb7a7b983f861ed6a9a541a7">Dispose</a>();</div>
<div class="line"><a name="l07072"></a><span class="lineno"> 7072</span>&#160;  expected_context.<a class="code" href="../../d3/dd5/classv8_1_1_handle.html#aa71d36872f416feaa853788a7a7a7ef8">Clear</a>();</div>
<div class="line"><a name="l07073"></a><span class="lineno"> 7073</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l07074"></a><span class="lineno"> 7074</span>&#160;  expected_context_data = <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a>();</div>
<div class="line"><a name="l07075"></a><span class="lineno"> 7075</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l07076"></a><span class="lineno"> 7076</span>&#160;}</div>
<div class="line"><a name="l07077"></a><span class="lineno"> 7077</span>&#160;</div>
<div class="line"><a name="l07078"></a><span class="lineno"> 7078</span>&#160;</div>
<div class="line"><a name="l07079"></a><span class="lineno"> 7079</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span>* expected_break_data;</div>
<div class="line"><a name="l07080"></a><span class="lineno"> 7080</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> was_debug_break_called;</div>
<div class="line"><a name="l07081"></a><span class="lineno"> 7081</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> was_debug_event_called;</div>
<div class="line"><a name="l07082"></a><span class="lineno"> 7082</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventBreakDataChecker(<span class="keyword">const</span> <a class="code" href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html">v8::Debug::EventDetails</a>&amp; details) {</div>
<div class="line"><a name="l07083"></a><span class="lineno"> 7083</span>&#160;  <span class="keywordflow">if</span> (details.<a class="code" href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html#a5e8220bed8b3bf7c537711ce6b9653d6">GetEvent</a>() == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba88a18e11ec269de0e91887c301bccd7e">v8::BreakForCommand</a>) {</div>
<div class="line"><a name="l07084"></a><span class="lineno"> 7084</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(expected_break_data, details.<a class="code" href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html#a7761bfded060dc3978fc2150f9ad0e63">GetClientData</a>());</div>
<div class="line"><a name="l07085"></a><span class="lineno"> 7085</span>&#160;    was_debug_event_called = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07086"></a><span class="lineno"> 7086</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (details.<a class="code" href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html#a5e8220bed8b3bf7c537711ce6b9653d6">GetEvent</a>() == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l07087"></a><span class="lineno"> 7087</span>&#160;    was_debug_break_called = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07088"></a><span class="lineno"> 7088</span>&#160;  }</div>
<div class="line"><a name="l07089"></a><span class="lineno"> 7089</span>&#160;}</div>
<div class="line"><a name="l07090"></a><span class="lineno"> 7090</span>&#160;</div>
<div class="line"><a name="l07091"></a><span class="lineno"> 7091</span>&#160;</div>
<div class="line"><a name="l07092"></a><span class="lineno"> 7092</span>&#160;<span class="comment">// Check that event details contain context where debug event occured.</span></div>
<div class="line"><a name="l07093"></a><span class="lineno"> 7093</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugEventBreakData) {</div>
<div class="line"><a name="l07094"></a><span class="lineno"> 7094</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l07095"></a><span class="lineno"> 7095</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l07096"></a><span class="lineno"> 7096</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a6193450d47c80996b33eeae196c2535d">v8::Debug::SetDebugEventListener2</a>(DebugEventBreakDataChecker);</div>
<div class="line"><a name="l07097"></a><span class="lineno"> 7097</span>&#160;</div>
<div class="line"><a name="l07098"></a><span class="lineno"> 7098</span>&#160;  TestClientData::constructor_call_counter = 0;</div>
<div class="line"><a name="l07099"></a><span class="lineno"> 7099</span>&#160;  TestClientData::destructor_call_counter = 0;</div>
<div class="line"><a name="l07100"></a><span class="lineno"> 7100</span>&#160;</div>
<div class="line"><a name="l07101"></a><span class="lineno"> 7101</span>&#160;  expected_break_data = <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>;</div>
<div class="line"><a name="l07102"></a><span class="lineno"> 7102</span>&#160;  was_debug_event_called = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07103"></a><span class="lineno"> 7103</span>&#160;  was_debug_break_called = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07104"></a><span class="lineno"> 7104</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a8fc50de4e1e6d1b68f280f5d0c3086c3">v8::Debug::DebugBreakForCommand</a>();</div>
<div class="line"><a name="l07105"></a><span class="lineno"> 7105</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;(function(x){return x;})(1);&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l07106"></a><span class="lineno"> 7106</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(was_debug_event_called);</div>
<div class="line"><a name="l07107"></a><span class="lineno"> 7107</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!was_debug_break_called);</div>
<div class="line"><a name="l07108"></a><span class="lineno"> 7108</span>&#160;</div>
<div class="line"><a name="l07109"></a><span class="lineno"> 7109</span>&#160;  TestClientData* data1 = <span class="keyword">new</span> TestClientData();</div>
<div class="line"><a name="l07110"></a><span class="lineno"> 7110</span>&#160;  expected_break_data = data1;</div>
<div class="line"><a name="l07111"></a><span class="lineno"> 7111</span>&#160;  was_debug_event_called = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07112"></a><span class="lineno"> 7112</span>&#160;  was_debug_break_called = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07113"></a><span class="lineno"> 7113</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a8fc50de4e1e6d1b68f280f5d0c3086c3">v8::Debug::DebugBreakForCommand</a>(data1);</div>
<div class="line"><a name="l07114"></a><span class="lineno"> 7114</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;(function(x){return x+1;})(1);&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l07115"></a><span class="lineno"> 7115</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(was_debug_event_called);</div>
<div class="line"><a name="l07116"></a><span class="lineno"> 7116</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!was_debug_break_called);</div>
<div class="line"><a name="l07117"></a><span class="lineno"> 7117</span>&#160;</div>
<div class="line"><a name="l07118"></a><span class="lineno"> 7118</span>&#160;  expected_break_data = <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>;</div>
<div class="line"><a name="l07119"></a><span class="lineno"> 7119</span>&#160;  was_debug_event_called = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07120"></a><span class="lineno"> 7120</span>&#160;  was_debug_break_called = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07121"></a><span class="lineno"> 7121</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l07122"></a><span class="lineno"> 7122</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;(function(x){return x+2;})(1);&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l07123"></a><span class="lineno"> 7123</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!was_debug_event_called);</div>
<div class="line"><a name="l07124"></a><span class="lineno"> 7124</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(was_debug_break_called);</div>
<div class="line"><a name="l07125"></a><span class="lineno"> 7125</span>&#160;</div>
<div class="line"><a name="l07126"></a><span class="lineno"> 7126</span>&#160;  TestClientData* data2 = <span class="keyword">new</span> TestClientData();</div>
<div class="line"><a name="l07127"></a><span class="lineno"> 7127</span>&#160;  expected_break_data = data2;</div>
<div class="line"><a name="l07128"></a><span class="lineno"> 7128</span>&#160;  was_debug_event_called = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07129"></a><span class="lineno"> 7129</span>&#160;  was_debug_break_called = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07130"></a><span class="lineno"> 7130</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l07131"></a><span class="lineno"> 7131</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a8fc50de4e1e6d1b68f280f5d0c3086c3">v8::Debug::DebugBreakForCommand</a>(data2);</div>
<div class="line"><a name="l07132"></a><span class="lineno"> 7132</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;(function(x){return x+3;})(1);&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l07133"></a><span class="lineno"> 7133</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(was_debug_event_called);</div>
<div class="line"><a name="l07134"></a><span class="lineno"> 7134</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(was_debug_break_called);</div>
<div class="line"><a name="l07135"></a><span class="lineno"> 7135</span>&#160;</div>
<div class="line"><a name="l07136"></a><span class="lineno"> 7136</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, TestClientData::constructor_call_counter);</div>
<div class="line"><a name="l07137"></a><span class="lineno"> 7137</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(TestClientData::constructor_call_counter,</div>
<div class="line"><a name="l07138"></a><span class="lineno"> 7138</span>&#160;           TestClientData::destructor_call_counter);</div>
<div class="line"><a name="l07139"></a><span class="lineno"> 7139</span>&#160;</div>
<div class="line"><a name="l07140"></a><span class="lineno"> 7140</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l07141"></a><span class="lineno"> 7141</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l07142"></a><span class="lineno"> 7142</span>&#160;}</div>
<div class="line"><a name="l07143"></a><span class="lineno"> 7143</span>&#160;</div>
<div class="line"><a name="l07144"></a><span class="lineno"> 7144</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> debug_event_break_deoptimize_done = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07145"></a><span class="lineno"> 7145</span>&#160;</div>
<div class="line"><a name="l07146"></a><span class="lineno"> 7146</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventBreakDeoptimize(<a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l07147"></a><span class="lineno"> 7147</span>&#160;                                      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l07148"></a><span class="lineno"> 7148</span>&#160;                                      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l07149"></a><span class="lineno"> 7149</span>&#160;                                      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l07150"></a><span class="lineno"> 7150</span>&#160;  <span class="keywordflow">if</span> (event == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l07151"></a><span class="lineno"> 7151</span>&#160;    <span class="keywordflow">if</span> (!frame_function_name.<a class="code" href="../../d3/dd5/classv8_1_1_handle.html#aaef62c8761ddd1b95824fc57b1b277b5">IsEmpty</a>()) {</div>
<div class="line"><a name="l07152"></a><span class="lineno"> 7152</span>&#160;      <span class="comment">// Get the name of the function.</span></div>
<div class="line"><a name="l07153"></a><span class="lineno"> 7153</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 2;</div>
<div class="line"><a name="l07154"></a><span class="lineno"> 7154</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv[argc] = { exec_state, <a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(0) };</div>
<div class="line"><a name="l07155"></a><span class="lineno"> 7155</span>&#160;      <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result =</div>
<div class="line"><a name="l07156"></a><span class="lineno"> 7156</span>&#160;          frame_function_name-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(exec_state, argc, argv);</div>
<div class="line"><a name="l07157"></a><span class="lineno"> 7157</span>&#160;      <span class="keywordflow">if</span> (!result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a2858c3ff89ed8f4b756b94cbebcfe42f">IsUndefined</a>()) {</div>
<div class="line"><a name="l07158"></a><span class="lineno"> 7158</span>&#160;        <span class="keywordtype">char</span> fn[80];</div>
<div class="line"><a name="l07159"></a><span class="lineno"> 7159</span>&#160;        <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#abfee0d12e50e0499ce0e3eac2612b3a2">IsString</a>());</div>
<div class="line"><a name="l07160"></a><span class="lineno"> 7160</span>&#160;        <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> function_name(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a91b68fb0b5558f1c9539015c1bbf7af2">ToString</a>());</div>
<div class="line"><a name="l07161"></a><span class="lineno"> 7161</span>&#160;        function_name-&gt;WriteAscii(fn);</div>
<div class="line"><a name="l07162"></a><span class="lineno"> 7162</span>&#160;        <span class="keywordflow">if</span> (strcmp(fn, <span class="stringliteral">&quot;bar&quot;</span>) == 0) {</div>
<div class="line"><a name="l07163"></a><span class="lineno"> 7163</span>&#160;          <a class="code" href="../../dd/d9d/classv8_1_1internal_1_1_deoptimizer.html#aa7e0ee7bd6552a499e4d6421cabd8742">i::Deoptimizer::DeoptimizeAll</a>();</div>
<div class="line"><a name="l07164"></a><span class="lineno"> 7164</span>&#160;          debug_event_break_deoptimize_done = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07165"></a><span class="lineno"> 7165</span>&#160;        }</div>
<div class="line"><a name="l07166"></a><span class="lineno"> 7166</span>&#160;      }</div>
<div class="line"><a name="l07167"></a><span class="lineno"> 7167</span>&#160;    }</div>
<div class="line"><a name="l07168"></a><span class="lineno"> 7168</span>&#160;</div>
<div class="line"><a name="l07169"></a><span class="lineno"> 7169</span>&#160;    <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l07170"></a><span class="lineno"> 7170</span>&#160;  }</div>
<div class="line"><a name="l07171"></a><span class="lineno"> 7171</span>&#160;}</div>
<div class="line"><a name="l07172"></a><span class="lineno"> 7172</span>&#160;</div>
<div class="line"><a name="l07173"></a><span class="lineno"> 7173</span>&#160;</div>
<div class="line"><a name="l07174"></a><span class="lineno"> 7174</span>&#160;<span class="comment">// Test deoptimization when execution is broken using the debug break stack</span></div>
<div class="line"><a name="l07175"></a><span class="lineno"> 7175</span>&#160;<span class="comment">// check interrupt.</span></div>
<div class="line"><a name="l07176"></a><span class="lineno"> 7176</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DeoptimizeDuringDebugBreak) {</div>
<div class="line"><a name="l07177"></a><span class="lineno"> 7177</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l07178"></a><span class="lineno"> 7178</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l07179"></a><span class="lineno"> 7179</span>&#160;  env.ExposeDebug();</div>
<div class="line"><a name="l07180"></a><span class="lineno"> 7180</span>&#160;</div>
<div class="line"><a name="l07181"></a><span class="lineno"> 7181</span>&#160;  <span class="comment">// Create a function for checking the function when hitting a break point.</span></div>
<div class="line"><a name="l07182"></a><span class="lineno"> 7182</span>&#160;  frame_function_name = CompileFunction(&amp;env,</div>
<div class="line"><a name="l07183"></a><span class="lineno"> 7183</span>&#160;                                        frame_function_name_source,</div>
<div class="line"><a name="l07184"></a><span class="lineno"> 7184</span>&#160;                                        <span class="stringliteral">&quot;frame_function_name&quot;</span>);</div>
<div class="line"><a name="l07185"></a><span class="lineno"> 7185</span>&#160;</div>
<div class="line"><a name="l07186"></a><span class="lineno"> 7186</span>&#160;</div>
<div class="line"><a name="l07187"></a><span class="lineno"> 7187</span>&#160;  <span class="comment">// Set a debug event listener which will keep interrupting execution until</span></div>
<div class="line"><a name="l07188"></a><span class="lineno"> 7188</span>&#160;  <span class="comment">// debug break. When inside function bar it will deoptimize all functions.</span></div>
<div class="line"><a name="l07189"></a><span class="lineno"> 7189</span>&#160;  <span class="comment">// This tests lazy deoptimization bailout for the stack check, as the first</span></div>
<div class="line"><a name="l07190"></a><span class="lineno"> 7190</span>&#160;  <span class="comment">// time in function bar when using debug break and no break points will be at</span></div>
<div class="line"><a name="l07191"></a><span class="lineno"> 7191</span>&#160;  <span class="comment">// the initial stack check.</span></div>
<div class="line"><a name="l07192"></a><span class="lineno"> 7192</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakDeoptimize,</div>
<div class="line"><a name="l07193"></a><span class="lineno"> 7193</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l07194"></a><span class="lineno"> 7194</span>&#160;</div>
<div class="line"><a name="l07195"></a><span class="lineno"> 7195</span>&#160;  <span class="comment">// Compile and run function bar which will optimize it for some flag settings.</span></div>
<div class="line"><a name="l07196"></a><span class="lineno"> 7196</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;function bar(){}; bar()&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l07197"></a><span class="lineno"> 7197</span>&#160;</div>
<div class="line"><a name="l07198"></a><span class="lineno"> 7198</span>&#160;  <span class="comment">// Set debug break and call bar again.</span></div>
<div class="line"><a name="l07199"></a><span class="lineno"> 7199</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l07200"></a><span class="lineno"> 7200</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;bar()&quot;</span>))-&gt;Run();</div>
<div class="line"><a name="l07201"></a><span class="lineno"> 7201</span>&#160;</div>
<div class="line"><a name="l07202"></a><span class="lineno"> 7202</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(debug_event_break_deoptimize_done);</div>
<div class="line"><a name="l07203"></a><span class="lineno"> 7203</span>&#160;</div>
<div class="line"><a name="l07204"></a><span class="lineno"> 7204</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l07205"></a><span class="lineno"> 7205</span>&#160;}</div>
<div class="line"><a name="l07206"></a><span class="lineno"> 7206</span>&#160;</div>
<div class="line"><a name="l07207"></a><span class="lineno"> 7207</span>&#160;</div>
<div class="line"><a name="l07208"></a><span class="lineno"> 7208</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventBreakWithOptimizedStack(<a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l07209"></a><span class="lineno"> 7209</span>&#160;                                              <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l07210"></a><span class="lineno"> 7210</span>&#160;                                              <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l07211"></a><span class="lineno"> 7211</span>&#160;                                              <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l07212"></a><span class="lineno"> 7212</span>&#160;  <span class="keywordflow">if</span> (event == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l07213"></a><span class="lineno"> 7213</span>&#160;    <span class="keywordflow">if</span> (!frame_function_name.<a class="code" href="../../d3/dd5/classv8_1_1_handle.html#aaef62c8761ddd1b95824fc57b1b277b5">IsEmpty</a>()) {</div>
<div class="line"><a name="l07214"></a><span class="lineno"> 7214</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++) {</div>
<div class="line"><a name="l07215"></a><span class="lineno"> 7215</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 2;</div>
<div class="line"><a name="l07216"></a><span class="lineno"> 7216</span>&#160;        <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> argv[argc] = { exec_state, <a class="code" href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a>(i) };</div>
<div class="line"><a name="l07217"></a><span class="lineno"> 7217</span>&#160;        <span class="comment">// Get the name of the function in frame i.</span></div>
<div class="line"><a name="l07218"></a><span class="lineno"> 7218</span>&#160;        <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> result =</div>
<div class="line"><a name="l07219"></a><span class="lineno"> 7219</span>&#160;            frame_function_name-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(exec_state, argc, argv);</div>
<div class="line"><a name="l07220"></a><span class="lineno"> 7220</span>&#160;        <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#abfee0d12e50e0499ce0e3eac2612b3a2">IsString</a>());</div>
<div class="line"><a name="l07221"></a><span class="lineno"> 7221</span>&#160;        <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> function_name(result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a91b68fb0b5558f1c9539015c1bbf7af2">ToString</a>());</div>
<div class="line"><a name="l07222"></a><span class="lineno"> 7222</span>&#160;        <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(function_name-&gt;Equals(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;loop&quot;</span>)));</div>
<div class="line"><a name="l07223"></a><span class="lineno"> 7223</span>&#160;        <span class="comment">// Get the name of the first argument in frame i.</span></div>
<div class="line"><a name="l07224"></a><span class="lineno"> 7224</span>&#160;        result = frame_argument_name-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(exec_state, argc, argv);</div>
<div class="line"><a name="l07225"></a><span class="lineno"> 7225</span>&#160;        <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(result-&gt;IsString());</div>
<div class="line"><a name="l07226"></a><span class="lineno"> 7226</span>&#160;        <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> argument_name(result-&gt;ToString());</div>
<div class="line"><a name="l07227"></a><span class="lineno"> 7227</span>&#160;        <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(argument_name-&gt;Equals(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;count&quot;</span>)));</div>
<div class="line"><a name="l07228"></a><span class="lineno"> 7228</span>&#160;        <span class="comment">// Get the value of the first argument in frame i. If the</span></div>
<div class="line"><a name="l07229"></a><span class="lineno"> 7229</span>&#160;        <span class="comment">// funtion is optimized the value will be undefined, otherwise</span></div>
<div class="line"><a name="l07230"></a><span class="lineno"> 7230</span>&#160;        <span class="comment">// the value will be &#39;1 - i&#39;.</span></div>
<div class="line"><a name="l07231"></a><span class="lineno"> 7231</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l07232"></a><span class="lineno"> 7232</span>&#160;        <span class="comment">// TODO(3141533): We should be able to get the real value for</span></div>
<div class="line"><a name="l07233"></a><span class="lineno"> 7233</span>&#160;        <span class="comment">// optimized frames.</span></div>
<div class="line"><a name="l07234"></a><span class="lineno"> 7234</span>&#160;        result = frame_argument_value-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(exec_state, argc, argv);</div>
<div class="line"><a name="l07235"></a><span class="lineno"> 7235</span>&#160;        <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(result-&gt;IsUndefined() || (result-&gt;Int32Value() == 1 - i));</div>
<div class="line"><a name="l07236"></a><span class="lineno"> 7236</span>&#160;        <span class="comment">// Get the name of the first local variable.</span></div>
<div class="line"><a name="l07237"></a><span class="lineno"> 7237</span>&#160;        result = frame_local_name-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(exec_state, argc, argv);</div>
<div class="line"><a name="l07238"></a><span class="lineno"> 7238</span>&#160;        <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(result-&gt;IsString());</div>
<div class="line"><a name="l07239"></a><span class="lineno"> 7239</span>&#160;        <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::String&gt;</a> local_name(result-&gt;ToString());</div>
<div class="line"><a name="l07240"></a><span class="lineno"> 7240</span>&#160;        <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(local_name-&gt;Equals(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(<span class="stringliteral">&quot;local&quot;</span>)));</div>
<div class="line"><a name="l07241"></a><span class="lineno"> 7241</span>&#160;        <span class="comment">// Get the value of the first local variable. If the function</span></div>
<div class="line"><a name="l07242"></a><span class="lineno"> 7242</span>&#160;        <span class="comment">// is optimized the value will be undefined, otherwise it will</span></div>
<div class="line"><a name="l07243"></a><span class="lineno"> 7243</span>&#160;        <span class="comment">// be 42.</span></div>
<div class="line"><a name="l07244"></a><span class="lineno"> 7244</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l07245"></a><span class="lineno"> 7245</span>&#160;        <span class="comment">// TODO(3141533): We should be able to get the real value for</span></div>
<div class="line"><a name="l07246"></a><span class="lineno"> 7246</span>&#160;        <span class="comment">// optimized frames.</span></div>
<div class="line"><a name="l07247"></a><span class="lineno"> 7247</span>&#160;        result = frame_local_value-&gt;<a class="code" href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">Call</a>(exec_state, argc, argv);</div>
<div class="line"><a name="l07248"></a><span class="lineno"> 7248</span>&#160;        <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(result-&gt;IsUndefined() || (result-&gt;Int32Value() == 42));</div>
<div class="line"><a name="l07249"></a><span class="lineno"> 7249</span>&#160;      }</div>
<div class="line"><a name="l07250"></a><span class="lineno"> 7250</span>&#160;    }</div>
<div class="line"><a name="l07251"></a><span class="lineno"> 7251</span>&#160;  }</div>
<div class="line"><a name="l07252"></a><span class="lineno"> 7252</span>&#160;}</div>
<div class="line"><a name="l07253"></a><span class="lineno"> 7253</span>&#160;</div>
<div class="line"><a name="l07254"></a><span class="lineno"> 7254</span>&#160;</div>
<div class="line"><a name="l07255"></a><span class="lineno"> 7255</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> ScheduleBreak(<span class="keyword">const</span> <a class="code" href="../../df/d31/classv8_1_1_arguments.html">v8::Arguments</a>&amp; args) {</div>
<div class="line"><a name="l07256"></a><span class="lineno"> 7256</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakWithOptimizedStack,</div>
<div class="line"><a name="l07257"></a><span class="lineno"> 7257</span>&#160;                                   <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>());</div>
<div class="line"><a name="l07258"></a><span class="lineno"> 7258</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l07259"></a><span class="lineno"> 7259</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a>();</div>
<div class="line"><a name="l07260"></a><span class="lineno"> 7260</span>&#160;}</div>
<div class="line"><a name="l07261"></a><span class="lineno"> 7261</span>&#160;</div>
<div class="line"><a name="l07262"></a><span class="lineno"> 7262</span>&#160;</div>
<div class="line"><a name="l07263"></a><span class="lineno"> 7263</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugBreakStackInspection) {</div>
<div class="line"><a name="l07264"></a><span class="lineno"> 7264</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l07265"></a><span class="lineno"> 7265</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l07266"></a><span class="lineno"> 7266</span>&#160;</div>
<div class="line"><a name="l07267"></a><span class="lineno"> 7267</span>&#160;  frame_function_name =</div>
<div class="line"><a name="l07268"></a><span class="lineno"> 7268</span>&#160;      CompileFunction(&amp;env, frame_function_name_source, <span class="stringliteral">&quot;frame_function_name&quot;</span>);</div>
<div class="line"><a name="l07269"></a><span class="lineno"> 7269</span>&#160;  frame_argument_name =</div>
<div class="line"><a name="l07270"></a><span class="lineno"> 7270</span>&#160;      CompileFunction(&amp;env, frame_argument_name_source, <span class="stringliteral">&quot;frame_argument_name&quot;</span>);</div>
<div class="line"><a name="l07271"></a><span class="lineno"> 7271</span>&#160;  frame_argument_value = CompileFunction(&amp;env,</div>
<div class="line"><a name="l07272"></a><span class="lineno"> 7272</span>&#160;                                         frame_argument_value_source,</div>
<div class="line"><a name="l07273"></a><span class="lineno"> 7273</span>&#160;                                         <span class="stringliteral">&quot;frame_argument_value&quot;</span>);</div>
<div class="line"><a name="l07274"></a><span class="lineno"> 7274</span>&#160;  frame_local_name =</div>
<div class="line"><a name="l07275"></a><span class="lineno"> 7275</span>&#160;      CompileFunction(&amp;env, frame_local_name_source, <span class="stringliteral">&quot;frame_local_name&quot;</span>);</div>
<div class="line"><a name="l07276"></a><span class="lineno"> 7276</span>&#160;  frame_local_value =</div>
<div class="line"><a name="l07277"></a><span class="lineno"> 7277</span>&#160;      CompileFunction(&amp;env, frame_local_value_source, <span class="stringliteral">&quot;frame_local_value&quot;</span>);</div>
<div class="line"><a name="l07278"></a><span class="lineno"> 7278</span>&#160;</div>
<div class="line"><a name="l07279"></a><span class="lineno"> 7279</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::FunctionTemplate&gt;</a> schedule_break_template =</div>
<div class="line"><a name="l07280"></a><span class="lineno"> 7280</span>&#160;      <a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a3b5a2868860b0414c3607f6cf1567b78">v8::FunctionTemplate::New</a>(ScheduleBreak);</div>
<div class="line"><a name="l07281"></a><span class="lineno"> 7281</span>&#160;  <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Function&gt;</a> schedule_break =</div>
<div class="line"><a name="l07282"></a><span class="lineno"> 7282</span>&#160;      schedule_break_template-&gt;<a class="code" href="../../d8/d83/classv8_1_1_function_template.html#a7d1eef8a098a7467763f8c17f37b2d0d">GetFunction</a>();</div>
<div class="line"><a name="l07283"></a><span class="lineno"> 7283</span>&#160;  env-&gt;Global()-&gt;Set(v8_str(<span class="stringliteral">&quot;scheduleBreak&quot;</span>), schedule_break);</div>
<div class="line"><a name="l07284"></a><span class="lineno"> 7284</span>&#160;</div>
<div class="line"><a name="l07285"></a><span class="lineno"> 7285</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* src =</div>
<div class="line"><a name="l07286"></a><span class="lineno"> 7286</span>&#160;      <span class="stringliteral">&quot;function loop(count) {&quot;</span></div>
<div class="line"><a name="l07287"></a><span class="lineno"> 7287</span>&#160;      <span class="stringliteral">&quot;  var local = 42;&quot;</span></div>
<div class="line"><a name="l07288"></a><span class="lineno"> 7288</span>&#160;      <span class="stringliteral">&quot;  if (count &lt; 1) { scheduleBreak(); loop(count + 1); }&quot;</span></div>
<div class="line"><a name="l07289"></a><span class="lineno"> 7289</span>&#160;      <span class="stringliteral">&quot;}&quot;</span></div>
<div class="line"><a name="l07290"></a><span class="lineno"> 7290</span>&#160;      <span class="stringliteral">&quot;loop(0);&quot;</span>;</div>
<div class="line"><a name="l07291"></a><span class="lineno"> 7291</span>&#160;  <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(src))-&gt;Run();</div>
<div class="line"><a name="l07292"></a><span class="lineno"> 7292</span>&#160;}</div>
<div class="line"><a name="l07293"></a><span class="lineno"> 7293</span>&#160;</div>
<div class="line"><a name="l07294"></a><span class="lineno"> 7294</span>&#160;</div>
<div class="line"><a name="l07295"></a><span class="lineno"> 7295</span>&#160;<span class="comment">// Test that setting the terminate execution flag during debug break processing.</span></div>
<div class="line"><a name="l07296"></a><span class="lineno"> 7296</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> TestDebugBreakInLoop(<span class="keyword">const</span> <span class="keywordtype">char</span>* loop_head,</div>
<div class="line"><a name="l07297"></a><span class="lineno"> 7297</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">char</span>** loop_bodies,</div>
<div class="line"><a name="l07298"></a><span class="lineno"> 7298</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">char</span>* loop_tail) {</div>
<div class="line"><a name="l07299"></a><span class="lineno"> 7299</span>&#160;  <span class="comment">// Receive 100 breaks for each test and then terminate JavaScript execution.</span></div>
<div class="line"><a name="l07300"></a><span class="lineno"> 7300</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kBreaksPerTest = 100;</div>
<div class="line"><a name="l07301"></a><span class="lineno"> 7301</span>&#160;</div>
<div class="line"><a name="l07302"></a><span class="lineno"> 7302</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; loop_bodies[i] != <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>; i++) {</div>
<div class="line"><a name="l07303"></a><span class="lineno"> 7303</span>&#160;    <span class="comment">// Perform a lazy deoptimization after various numbers of breaks</span></div>
<div class="line"><a name="l07304"></a><span class="lineno"> 7304</span>&#160;    <span class="comment">// have been hit.</span></div>
<div class="line"><a name="l07305"></a><span class="lineno"> 7305</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 11; j++) {</div>
<div class="line"><a name="l07306"></a><span class="lineno"> 7306</span>&#160;      break_point_hit_count_deoptimize = j;</div>
<div class="line"><a name="l07307"></a><span class="lineno"> 7307</span>&#160;      <span class="keywordflow">if</span> (j == 10) {</div>
<div class="line"><a name="l07308"></a><span class="lineno"> 7308</span>&#160;        break_point_hit_count_deoptimize = kBreaksPerTest;</div>
<div class="line"><a name="l07309"></a><span class="lineno"> 7309</span>&#160;      }</div>
<div class="line"><a name="l07310"></a><span class="lineno"> 7310</span>&#160;</div>
<div class="line"><a name="l07311"></a><span class="lineno"> 7311</span>&#160;      break_point_hit_count = 0;</div>
<div class="line"><a name="l07312"></a><span class="lineno"> 7312</span>&#160;      max_break_point_hit_count = kBreaksPerTest;</div>
<div class="line"><a name="l07313"></a><span class="lineno"> 7313</span>&#160;      terminate_after_max_break_point_hit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07314"></a><span class="lineno"> 7314</span>&#160;</div>
<div class="line"><a name="l07315"></a><span class="lineno"> 7315</span>&#160;      EmbeddedVector&lt;char, 1024&gt; buffer;</div>
<div class="line"><a name="l07316"></a><span class="lineno"> 7316</span>&#160;      OS::SNPrintF(buffer,</div>
<div class="line"><a name="l07317"></a><span class="lineno"> 7317</span>&#160;                   <span class="stringliteral">&quot;function f() {%s%s%s}&quot;</span>,</div>
<div class="line"><a name="l07318"></a><span class="lineno"> 7318</span>&#160;                   loop_head, loop_bodies[i], loop_tail);</div>
<div class="line"><a name="l07319"></a><span class="lineno"> 7319</span>&#160;</div>
<div class="line"><a name="l07320"></a><span class="lineno"> 7320</span>&#160;      <span class="comment">// Function with infinite loop.</span></div>
<div class="line"><a name="l07321"></a><span class="lineno"> 7321</span>&#160;      CompileRun(buffer.start());</div>
<div class="line"><a name="l07322"></a><span class="lineno"> 7322</span>&#160;</div>
<div class="line"><a name="l07323"></a><span class="lineno"> 7323</span>&#160;      <span class="comment">// Set the debug break to enter the debugger as soon as possible.</span></div>
<div class="line"><a name="l07324"></a><span class="lineno"> 7324</span>&#160;      <a class="code" href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a>();</div>
<div class="line"><a name="l07325"></a><span class="lineno"> 7325</span>&#160;</div>
<div class="line"><a name="l07326"></a><span class="lineno"> 7326</span>&#160;      <span class="comment">// Call function with infinite loop.</span></div>
<div class="line"><a name="l07327"></a><span class="lineno"> 7327</span>&#160;      CompileRun(<span class="stringliteral">&quot;f();&quot;</span>);</div>
<div class="line"><a name="l07328"></a><span class="lineno"> 7328</span>&#160;      <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(kBreaksPerTest, break_point_hit_count);</div>
<div class="line"><a name="l07329"></a><span class="lineno"> 7329</span>&#160;</div>
<div class="line"><a name="l07330"></a><span class="lineno"> 7330</span>&#160;      <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(!<a class="code" href="../../df/d43/classv8_1_1_v8.html#a98d1ed798b9e063cb4e75925615cac4e">v8::V8::IsExecutionTerminating</a>());</div>
<div class="line"><a name="l07331"></a><span class="lineno"> 7331</span>&#160;    }</div>
<div class="line"><a name="l07332"></a><span class="lineno"> 7332</span>&#160;  }</div>
<div class="line"><a name="l07333"></a><span class="lineno"> 7333</span>&#160;}</div>
<div class="line"><a name="l07334"></a><span class="lineno"> 7334</span>&#160;</div>
<div class="line"><a name="l07335"></a><span class="lineno"> 7335</span>&#160;</div>
<div class="line"><a name="l07336"></a><span class="lineno"> 7336</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugBreakLoop) {</div>
<div class="line"><a name="l07337"></a><span class="lineno"> 7337</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l07338"></a><span class="lineno"> 7338</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l07339"></a><span class="lineno"> 7339</span>&#160;</div>
<div class="line"><a name="l07340"></a><span class="lineno"> 7340</span>&#160;  <span class="comment">// Register a debug event listener which sets the break flag and counts.</span></div>
<div class="line"><a name="l07341"></a><span class="lineno"> 7341</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventBreakMax);</div>
<div class="line"><a name="l07342"></a><span class="lineno"> 7342</span>&#160;</div>
<div class="line"><a name="l07343"></a><span class="lineno"> 7343</span>&#160;  <span class="comment">// Create a function for getting the frame count when hitting the break.</span></div>
<div class="line"><a name="l07344"></a><span class="lineno"> 7344</span>&#160;  frame_count = CompileFunction(&amp;env, frame_count_source, <span class="stringliteral">&quot;frame_count&quot;</span>);</div>
<div class="line"><a name="l07345"></a><span class="lineno"> 7345</span>&#160;</div>
<div class="line"><a name="l07346"></a><span class="lineno"> 7346</span>&#160;  CompileRun(<span class="stringliteral">&quot;var a = 1;&quot;</span>);</div>
<div class="line"><a name="l07347"></a><span class="lineno"> 7347</span>&#160;  CompileRun(<span class="stringliteral">&quot;function g() { }&quot;</span>);</div>
<div class="line"><a name="l07348"></a><span class="lineno"> 7348</span>&#160;  CompileRun(<span class="stringliteral">&quot;function h() { }&quot;</span>);</div>
<div class="line"><a name="l07349"></a><span class="lineno"> 7349</span>&#160;</div>
<div class="line"><a name="l07350"></a><span class="lineno"> 7350</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* loop_bodies[] = {</div>
<div class="line"><a name="l07351"></a><span class="lineno"> 7351</span>&#160;      <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l07352"></a><span class="lineno"> 7352</span>&#160;      <span class="stringliteral">&quot;g()&quot;</span>,</div>
<div class="line"><a name="l07353"></a><span class="lineno"> 7353</span>&#160;      <span class="stringliteral">&quot;if (a == 0) { g() }&quot;</span>,</div>
<div class="line"><a name="l07354"></a><span class="lineno"> 7354</span>&#160;      <span class="stringliteral">&quot;if (a == 1) { g() }&quot;</span>,</div>
<div class="line"><a name="l07355"></a><span class="lineno"> 7355</span>&#160;      <span class="stringliteral">&quot;if (a == 0) { g() } else { h() }&quot;</span>,</div>
<div class="line"><a name="l07356"></a><span class="lineno"> 7356</span>&#160;      <span class="stringliteral">&quot;if (a == 0) { continue }&quot;</span>,</div>
<div class="line"><a name="l07357"></a><span class="lineno"> 7357</span>&#160;      <span class="stringliteral">&quot;if (a == 1) { continue }&quot;</span>,</div>
<div class="line"><a name="l07358"></a><span class="lineno"> 7358</span>&#160;      <span class="stringliteral">&quot;switch (a) { case 1: g(); }&quot;</span>,</div>
<div class="line"><a name="l07359"></a><span class="lineno"> 7359</span>&#160;      <span class="stringliteral">&quot;switch (a) { case 1: continue; }&quot;</span>,</div>
<div class="line"><a name="l07360"></a><span class="lineno"> 7360</span>&#160;      <span class="stringliteral">&quot;switch (a) { case 1: g(); break; default: h() }&quot;</span>,</div>
<div class="line"><a name="l07361"></a><span class="lineno"> 7361</span>&#160;      <span class="stringliteral">&quot;switch (a) { case 1: continue; break; default: h() }&quot;</span>,</div>
<div class="line"><a name="l07362"></a><span class="lineno"> 7362</span>&#160;      <a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a></div>
<div class="line"><a name="l07363"></a><span class="lineno"> 7363</span>&#160;  };</div>
<div class="line"><a name="l07364"></a><span class="lineno"> 7364</span>&#160;</div>
<div class="line"><a name="l07365"></a><span class="lineno"> 7365</span>&#160;  TestDebugBreakInLoop(<span class="stringliteral">&quot;while (true) {&quot;</span>, loop_bodies, <span class="stringliteral">&quot;}&quot;</span>);</div>
<div class="line"><a name="l07366"></a><span class="lineno"> 7366</span>&#160;  TestDebugBreakInLoop(<span class="stringliteral">&quot;while (a == 1) {&quot;</span>, loop_bodies, <span class="stringliteral">&quot;}&quot;</span>);</div>
<div class="line"><a name="l07367"></a><span class="lineno"> 7367</span>&#160;</div>
<div class="line"><a name="l07368"></a><span class="lineno"> 7368</span>&#160;  TestDebugBreakInLoop(<span class="stringliteral">&quot;do {&quot;</span>, loop_bodies, <span class="stringliteral">&quot;} while (true)&quot;</span>);</div>
<div class="line"><a name="l07369"></a><span class="lineno"> 7369</span>&#160;  TestDebugBreakInLoop(<span class="stringliteral">&quot;do {&quot;</span>, loop_bodies, <span class="stringliteral">&quot;} while (a == 1)&quot;</span>);</div>
<div class="line"><a name="l07370"></a><span class="lineno"> 7370</span>&#160;</div>
<div class="line"><a name="l07371"></a><span class="lineno"> 7371</span>&#160;  TestDebugBreakInLoop(<span class="stringliteral">&quot;for (;;) {&quot;</span>, loop_bodies, <span class="stringliteral">&quot;}&quot;</span>);</div>
<div class="line"><a name="l07372"></a><span class="lineno"> 7372</span>&#160;  TestDebugBreakInLoop(<span class="stringliteral">&quot;for (;a == 1;) {&quot;</span>, loop_bodies, <span class="stringliteral">&quot;}&quot;</span>);</div>
<div class="line"><a name="l07373"></a><span class="lineno"> 7373</span>&#160;</div>
<div class="line"><a name="l07374"></a><span class="lineno"> 7374</span>&#160;  <span class="comment">// Get rid of the debug event listener.</span></div>
<div class="line"><a name="l07375"></a><span class="lineno"> 7375</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l07376"></a><span class="lineno"> 7376</span>&#160;  CheckDebuggerUnloaded();</div>
<div class="line"><a name="l07377"></a><span class="lineno"> 7377</span>&#160;}</div>
<div class="line"><a name="l07378"></a><span class="lineno"> 7378</span>&#160;</div>
<div class="line"><a name="l07379"></a><span class="lineno"> 7379</span>&#160;</div>
<div class="line"><a name="l07380"></a><span class="lineno"> 7380</span>&#160;<a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Script&gt;</a> inline_script;</div>
<div class="line"><a name="l07381"></a><span class="lineno"> 7381</span>&#160;</div>
<div class="line"><a name="l07382"></a><span class="lineno"> 7382</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugBreakInlineListener(<a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l07383"></a><span class="lineno"> 7383</span>&#160;                                     <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l07384"></a><span class="lineno"> 7384</span>&#160;                                     <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l07385"></a><span class="lineno"> 7385</span>&#160;                                     <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l07386"></a><span class="lineno"> 7386</span>&#160;  <span class="keywordflow">if</span> (event != <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l07387"></a><span class="lineno"> 7387</span>&#160;</div>
<div class="line"><a name="l07388"></a><span class="lineno"> 7388</span>&#160;  <span class="keywordtype">int</span> expected_frame_count = 4;</div>
<div class="line"><a name="l07389"></a><span class="lineno"> 7389</span>&#160;  <span class="keywordtype">int</span> expected_line_number[] = {1, 4, 7, 12};</div>
<div class="line"><a name="l07390"></a><span class="lineno"> 7390</span>&#160;</div>
<div class="line"><a name="l07391"></a><span class="lineno"> 7391</span>&#160;  <a class="code" href="../../da/dde/classv8_1_1internal_1_1_handle.html">i::Handle&lt;i::Object&gt;</a> compiled_script = v8::Utils::OpenHandle(*inline_script);</div>
<div class="line"><a name="l07392"></a><span class="lineno"> 7392</span>&#160;  <a class="code" href="../../da/dde/classv8_1_1internal_1_1_handle.html">i::Handle&lt;i::Script&gt;</a> source_script = <a class="code" href="../../da/dde/classv8_1_1internal_1_1_handle.html">i::Handle&lt;i::Script&gt;</a>(<a class="code" href="../../d9/da4/classv8_1_1internal_1_1_script.html#af5d25c39e7d38591e52ee53301bb283d">i::Script::cast</a>(</div>
<div class="line"><a name="l07393"></a><span class="lineno"> 7393</span>&#160;      <a class="code" href="../../d0/d2c/classv8_1_1internal_1_1_j_s_function.html#aadcf8f00ff5f932119b67a97c33762da">i::JSFunction::cast</a>(*compiled_script)-&gt;shared()-&gt;script()));</div>
<div class="line"><a name="l07394"></a><span class="lineno"> 7394</span>&#160;</div>
<div class="line"><a name="l07395"></a><span class="lineno"> 7395</span>&#160;  <span class="keywordtype">int</span> break_id = v8::internal::Isolate::Current()-&gt;debug()-&gt;break_id();</div>
<div class="line"><a name="l07396"></a><span class="lineno"> 7396</span>&#160;  <span class="keywordtype">char</span> script[128];</div>
<div class="line"><a name="l07397"></a><span class="lineno"> 7397</span>&#160;  <a class="code" href="../../d5/d7d/classv8_1_1internal_1_1_vector.html">i::Vector&lt;char&gt;</a> script_vector(script, <span class="keyword">sizeof</span>(script));</div>
<div class="line"><a name="l07398"></a><span class="lineno"> 7398</span>&#160;  OS::SNPrintF(script_vector, <span class="stringliteral">&quot;%%GetFrameCount(%d)&quot;</span>, break_id);</div>
<div class="line"><a name="l07399"></a><span class="lineno"> 7399</span>&#160;  <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Value&gt;</a> result = CompileRun(script);</div>
<div class="line"><a name="l07400"></a><span class="lineno"> 7400</span>&#160;</div>
<div class="line"><a name="l07401"></a><span class="lineno"> 7401</span>&#160;  <span class="keywordtype">int</span> frame_count = result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a3837d763158f1718969858a513670c62">Int32Value</a>();</div>
<div class="line"><a name="l07402"></a><span class="lineno"> 7402</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(expected_frame_count, frame_count);</div>
<div class="line"><a name="l07403"></a><span class="lineno"> 7403</span>&#160;</div>
<div class="line"><a name="l07404"></a><span class="lineno"> 7404</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; frame_count; i++) {</div>
<div class="line"><a name="l07405"></a><span class="lineno"> 7405</span>&#160;    <span class="comment">// The 5. element in the returned array of GetFrameDetails contains the</span></div>
<div class="line"><a name="l07406"></a><span class="lineno"> 7406</span>&#160;    <span class="comment">// source position of that frame.</span></div>
<div class="line"><a name="l07407"></a><span class="lineno"> 7407</span>&#160;    OS::SNPrintF(script_vector, <span class="stringliteral">&quot;%%GetFrameDetails(%d, %d)[5]&quot;</span>, break_id, i);</div>
<div class="line"><a name="l07408"></a><span class="lineno"> 7408</span>&#160;    <a class="code" href="../../de/deb/classv8_1_1_local.html">v8::Local&lt;v8::Value&gt;</a> result = CompileRun(script);</div>
<div class="line"><a name="l07409"></a><span class="lineno"> 7409</span>&#160;    <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(expected_line_number[i],</div>
<div class="line"><a name="l07410"></a><span class="lineno"> 7410</span>&#160;             <a class="code" href="../../d4/d32/namespacev8_1_1internal.html#a0b6640d40ef81deed8dc8b27c28aaee8">i::GetScriptLineNumber</a>(source_script, result-&gt;<a class="code" href="../../dc/d0a/classv8_1_1_value.html#a3837d763158f1718969858a513670c62">Int32Value</a>()));</div>
<div class="line"><a name="l07411"></a><span class="lineno"> 7411</span>&#160;  }</div>
<div class="line"><a name="l07412"></a><span class="lineno"> 7412</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l07413"></a><span class="lineno"> 7413</span>&#160;  <a class="code" href="../../df/d43/classv8_1_1_v8.html#ae438202e4c169f7e80162bba1e14f83e">v8::V8::TerminateExecution</a>();</div>
<div class="line"><a name="l07414"></a><span class="lineno"> 7414</span>&#160;}</div>
<div class="line"><a name="l07415"></a><span class="lineno"> 7415</span>&#160;</div>
<div class="line"><a name="l07416"></a><span class="lineno"> 7416</span>&#160;</div>
<div class="line"><a name="l07417"></a><span class="lineno"> 7417</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebugBreakInline) {</div>
<div class="line"><a name="l07418"></a><span class="lineno"> 7418</span>&#160;  i::FLAG_allow_natives_syntax = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07419"></a><span class="lineno"> 7419</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l07420"></a><span class="lineno"> 7420</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l07421"></a><span class="lineno"> 7421</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* source =</div>
<div class="line"><a name="l07422"></a><span class="lineno"> 7422</span>&#160;      <span class="stringliteral">&quot;function debug(b) {             \n&quot;</span></div>
<div class="line"><a name="l07423"></a><span class="lineno"> 7423</span>&#160;      <span class="stringliteral">&quot;  if (b) debugger;              \n&quot;</span></div>
<div class="line"><a name="l07424"></a><span class="lineno"> 7424</span>&#160;      <span class="stringliteral">&quot;}                               \n&quot;</span></div>
<div class="line"><a name="l07425"></a><span class="lineno"> 7425</span>&#160;      <span class="stringliteral">&quot;function f(b) {                 \n&quot;</span></div>
<div class="line"><a name="l07426"></a><span class="lineno"> 7426</span>&#160;      <span class="stringliteral">&quot;  debug(b)                      \n&quot;</span></div>
<div class="line"><a name="l07427"></a><span class="lineno"> 7427</span>&#160;      <span class="stringliteral">&quot;};                              \n&quot;</span></div>
<div class="line"><a name="l07428"></a><span class="lineno"> 7428</span>&#160;      <span class="stringliteral">&quot;function g(b) {                 \n&quot;</span></div>
<div class="line"><a name="l07429"></a><span class="lineno"> 7429</span>&#160;      <span class="stringliteral">&quot;  f(b);                         \n&quot;</span></div>
<div class="line"><a name="l07430"></a><span class="lineno"> 7430</span>&#160;      <span class="stringliteral">&quot;};                              \n&quot;</span></div>
<div class="line"><a name="l07431"></a><span class="lineno"> 7431</span>&#160;      <span class="stringliteral">&quot;g(false);                       \n&quot;</span></div>
<div class="line"><a name="l07432"></a><span class="lineno"> 7432</span>&#160;      <span class="stringliteral">&quot;g(false);                       \n&quot;</span></div>
<div class="line"><a name="l07433"></a><span class="lineno"> 7433</span>&#160;      <span class="stringliteral">&quot;%OptimizeFunctionOnNextCall(g); \n&quot;</span></div>
<div class="line"><a name="l07434"></a><span class="lineno"> 7434</span>&#160;      <span class="stringliteral">&quot;g(true);&quot;</span>;</div>
<div class="line"><a name="l07435"></a><span class="lineno"> 7435</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugBreakInlineListener);</div>
<div class="line"><a name="l07436"></a><span class="lineno"> 7436</span>&#160;  inline_script = <a class="code" href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a>(<a class="code" href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a>(source));</div>
<div class="line"><a name="l07437"></a><span class="lineno"> 7437</span>&#160;  inline_script-&gt;<a class="code" href="../../d0/d35/classv8_1_1_script.html#ab937ef8dba07a7ef516f11ef83debf92">Run</a>();</div>
<div class="line"><a name="l07438"></a><span class="lineno"> 7438</span>&#160;}</div>
<div class="line"><a name="l07439"></a><span class="lineno"> 7439</span>&#160;</div>
<div class="line"><a name="l07440"></a><span class="lineno"> 7440</span>&#160;</div>
<div class="line"><a name="l07441"></a><span class="lineno"> 7441</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> DebugEventStepNext(<a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l07442"></a><span class="lineno"> 7442</span>&#160;                               <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l07443"></a><span class="lineno"> 7443</span>&#160;                               <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l07444"></a><span class="lineno"> 7444</span>&#160;                               <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l07445"></a><span class="lineno"> 7445</span>&#160;  <span class="keywordflow">if</span> (event == <a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a>) {</div>
<div class="line"><a name="l07446"></a><span class="lineno"> 7446</span>&#160;    PrepareStep(StepNext);</div>
<div class="line"><a name="l07447"></a><span class="lineno"> 7447</span>&#160;  }</div>
<div class="line"><a name="l07448"></a><span class="lineno"> 7448</span>&#160;}</div>
<div class="line"><a name="l07449"></a><span class="lineno"> 7449</span>&#160;</div>
<div class="line"><a name="l07450"></a><span class="lineno"> 7450</span>&#160;</div>
<div class="line"><a name="l07451"></a><span class="lineno"> 7451</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> RunScriptInANewCFrame(<span class="keyword">const</span> <span class="keywordtype">char</span>* source) {</div>
<div class="line"><a name="l07452"></a><span class="lineno"> 7452</span>&#160;  <a class="code" href="../../d4/dc6/classv8_1_1_try_catch.html">v8::TryCatch</a> try_catch;</div>
<div class="line"><a name="l07453"></a><span class="lineno"> 7453</span>&#160;  CompileRun(source);</div>
<div class="line"><a name="l07454"></a><span class="lineno"> 7454</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a>(try_catch.<a class="code" href="../../d4/dc6/classv8_1_1_try_catch.html#a68f455077e74f15d67c6cc1664dbc266">HasCaught</a>());</div>
<div class="line"><a name="l07455"></a><span class="lineno"> 7455</span>&#160;}</div>
<div class="line"><a name="l07456"></a><span class="lineno"> 7456</span>&#160;</div>
<div class="line"><a name="l07457"></a><span class="lineno"> 7457</span>&#160;</div>
<div class="line"><a name="l07458"></a><span class="lineno"> 7458</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(Regress131642) {</div>
<div class="line"><a name="l07459"></a><span class="lineno"> 7459</span>&#160;  <span class="comment">// Bug description:</span></div>
<div class="line"><a name="l07460"></a><span class="lineno"> 7460</span>&#160;  <span class="comment">// When doing StepNext through the first script, the debugger is not reset</span></div>
<div class="line"><a name="l07461"></a><span class="lineno"> 7461</span>&#160;  <span class="comment">// after exiting through exception.  A flawed implementation enabling the</span></div>
<div class="line"><a name="l07462"></a><span class="lineno"> 7462</span>&#160;  <span class="comment">// debugger to step into Array.prototype.forEach breaks inside the callback</span></div>
<div class="line"><a name="l07463"></a><span class="lineno"> 7463</span>&#160;  <span class="comment">// for forEach in the second script under the assumption that we are in a</span></div>
<div class="line"><a name="l07464"></a><span class="lineno"> 7464</span>&#160;  <span class="comment">// recursive call.  In an attempt to step out, we crawl the stack using the</span></div>
<div class="line"><a name="l07465"></a><span class="lineno"> 7465</span>&#160;  <span class="comment">// recorded frame pointer from the first script and fail when not finding it</span></div>
<div class="line"><a name="l07466"></a><span class="lineno"> 7466</span>&#160;  <span class="comment">// on the stack.</span></div>
<div class="line"><a name="l07467"></a><span class="lineno"> 7467</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l07468"></a><span class="lineno"> 7468</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l07469"></a><span class="lineno"> 7469</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(DebugEventStepNext);</div>
<div class="line"><a name="l07470"></a><span class="lineno"> 7470</span>&#160;</div>
<div class="line"><a name="l07471"></a><span class="lineno"> 7471</span>&#160;  <span class="comment">// We step through the first script.  It exits through an exception.  We run</span></div>
<div class="line"><a name="l07472"></a><span class="lineno"> 7472</span>&#160;  <span class="comment">// this inside a new frame to record a different FP than the second script</span></div>
<div class="line"><a name="l07473"></a><span class="lineno"> 7473</span>&#160;  <span class="comment">// would expect.</span></div>
<div class="line"><a name="l07474"></a><span class="lineno"> 7474</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* script_1 = <span class="stringliteral">&quot;debugger; throw new Error();&quot;</span>;</div>
<div class="line"><a name="l07475"></a><span class="lineno"> 7475</span>&#160;  RunScriptInANewCFrame(script_1);</div>
<div class="line"><a name="l07476"></a><span class="lineno"> 7476</span>&#160;</div>
<div class="line"><a name="l07477"></a><span class="lineno"> 7477</span>&#160;  <span class="comment">// The second script uses forEach.</span></div>
<div class="line"><a name="l07478"></a><span class="lineno"> 7478</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* script_2 = <span class="stringliteral">&quot;[0].forEach(function() { });&quot;</span>;</div>
<div class="line"><a name="l07479"></a><span class="lineno"> 7479</span>&#160;  CompileRun(script_2);</div>
<div class="line"><a name="l07480"></a><span class="lineno"> 7480</span>&#160;</div>
<div class="line"><a name="l07481"></a><span class="lineno"> 7481</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l07482"></a><span class="lineno"> 7482</span>&#160;}</div>
<div class="line"><a name="l07483"></a><span class="lineno"> 7483</span>&#160;</div>
<div class="line"><a name="l07484"></a><span class="lineno"> 7484</span>&#160;</div>
<div class="line"><a name="l07485"></a><span class="lineno"> 7485</span>&#160;<span class="comment">// Import from test-heap.cc</span></div>
<div class="line"><a name="l07486"></a><span class="lineno"> 7486</span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/dae/test-heap_8cc.html#a80bf5e37a65269af89bd34d8c2d102ab">CountNativeContexts</a>();</div>
<div class="line"><a name="l07487"></a><span class="lineno"> 7487</span>&#160;</div>
<div class="line"><a name="l07488"></a><span class="lineno"> 7488</span>&#160;</div>
<div class="line"><a name="l07489"></a><span class="lineno"> 7489</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> NopListener(<a class="code" href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a> event,</div>
<div class="line"><a name="l07490"></a><span class="lineno"> 7490</span>&#160;                        <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> exec_state,</div>
<div class="line"><a name="l07491"></a><span class="lineno"> 7491</span>&#160;                        <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Object&gt;</a> event_data,</div>
<div class="line"><a name="l07492"></a><span class="lineno"> 7492</span>&#160;                        <a class="code" href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle&lt;v8::Value&gt;</a> data) {</div>
<div class="line"><a name="l07493"></a><span class="lineno"> 7493</span>&#160;}</div>
<div class="line"><a name="l07494"></a><span class="lineno"> 7494</span>&#160;</div>
<div class="line"><a name="l07495"></a><span class="lineno"> 7495</span>&#160;</div>
<div class="line"><a name="l07496"></a><span class="lineno"> 7496</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(DebuggerCreatesContextIffActive) {</div>
<div class="line"><a name="l07497"></a><span class="lineno"> 7497</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l07498"></a><span class="lineno"> 7498</span>&#160;  DebugLocalContext env;</div>
<div class="line"><a name="l07499"></a><span class="lineno"> 7499</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, <a class="code" href="../../d0/dae/test-heap_8cc.html#a80bf5e37a65269af89bd34d8c2d102ab">CountNativeContexts</a>());</div>
<div class="line"><a name="l07500"></a><span class="lineno"> 7500</span>&#160;</div>
<div class="line"><a name="l07501"></a><span class="lineno"> 7501</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l07502"></a><span class="lineno"> 7502</span>&#160;  CompileRun(<span class="stringliteral">&quot;debugger;&quot;</span>);</div>
<div class="line"><a name="l07503"></a><span class="lineno"> 7503</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(1, <a class="code" href="../../d0/dae/test-heap_8cc.html#a80bf5e37a65269af89bd34d8c2d102ab">CountNativeContexts</a>());</div>
<div class="line"><a name="l07504"></a><span class="lineno"> 7504</span>&#160;</div>
<div class="line"><a name="l07505"></a><span class="lineno"> 7505</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(NopListener);</div>
<div class="line"><a name="l07506"></a><span class="lineno"> 7506</span>&#160;  CompileRun(<span class="stringliteral">&quot;debugger;&quot;</span>);</div>
<div class="line"><a name="l07507"></a><span class="lineno"> 7507</span>&#160;  <a class="code" href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a>(2, <a class="code" href="../../d0/dae/test-heap_8cc.html#a80bf5e37a65269af89bd34d8c2d102ab">CountNativeContexts</a>());</div>
<div class="line"><a name="l07508"></a><span class="lineno"> 7508</span>&#160;</div>
<div class="line"><a name="l07509"></a><span class="lineno"> 7509</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a>(<a class="code" href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a>);</div>
<div class="line"><a name="l07510"></a><span class="lineno"> 7510</span>&#160;}</div>
<div class="line"><a name="l07511"></a><span class="lineno"> 7511</span>&#160;</div>
<div class="line"><a name="l07512"></a><span class="lineno"> 7512</span>&#160;</div>
<div class="line"><a name="l07513"></a><span class="lineno"> 7513</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(LiveEditEnabled) {</div>
<div class="line"><a name="l07514"></a><span class="lineno"> 7514</span>&#160;  v8::internal::FLAG_allow_natives_syntax = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07515"></a><span class="lineno"> 7515</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l07516"></a><span class="lineno"> 7516</span>&#160;  <a class="code" href="../../d7/d05/class_local_context.html">LocalContext</a> context;</div>
<div class="line"><a name="l07517"></a><span class="lineno"> 7517</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a01f6a88c03b3e7b8c65c77caca32c8c4">v8::Debug::SetLiveEditEnabled</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l07518"></a><span class="lineno"> 7518</span>&#160;  CompileRun(<span class="stringliteral">&quot;%LiveEditCompareStrings(&#39;&#39;, &#39;&#39;)&quot;</span>);</div>
<div class="line"><a name="l07519"></a><span class="lineno"> 7519</span>&#160;}</div>
<div class="line"><a name="l07520"></a><span class="lineno"> 7520</span>&#160;</div>
<div class="line"><a name="l07521"></a><span class="lineno"> 7521</span>&#160;</div>
<div class="line"><a name="l07522"></a><span class="lineno"> 7522</span>&#160;<a class="code" href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a>(LiveEditDisabled) {</div>
<div class="line"><a name="l07523"></a><span class="lineno"> 7523</span>&#160;  v8::internal::FLAG_allow_natives_syntax = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07524"></a><span class="lineno"> 7524</span>&#160;  <a class="code" href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a> scope;</div>
<div class="line"><a name="l07525"></a><span class="lineno"> 7525</span>&#160;  <a class="code" href="../../d7/d05/class_local_context.html">LocalContext</a> context;</div>
<div class="line"><a name="l07526"></a><span class="lineno"> 7526</span>&#160;  <a class="code" href="../../de/d13/classv8_1_1_debug.html#a01f6a88c03b3e7b8c65c77caca32c8c4">v8::Debug::SetLiveEditEnabled</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l07527"></a><span class="lineno"> 7527</span>&#160;  CompileRun(<span class="stringliteral">&quot;%LiveEditCompareStrings(&#39;&#39;, &#39;&#39;)&quot;</span>);</div>
<div class="line"><a name="l07528"></a><span class="lineno"> 7528</span>&#160;}</div>
<div class="line"><a name="l07529"></a><span class="lineno"> 7529</span>&#160;</div>
<div class="line"><a name="l07530"></a><span class="lineno"> 7530</span>&#160;</div>
<div class="line"><a name="l07531"></a><span class="lineno"> 7531</span>&#160;<span class="preprocessor">#endif  // ENABLE_DEBUGGER_SUPPORT</span></div>
<div class="ttc" id="namespacev8_1_1internal_html_ac7f0eb0e10bc8bbb03c793ea1256e329"><div class="ttname"><a href="../../d4/d32/namespacev8_1_1internal.html#ac7f0eb0e10bc8bbb03c793ea1256e329">v8::internal::Address</a></div><div class="ttdeci">byte * Address</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d87/globals_8h_source.html#l00157">globals.h:157</a></div></div>
<div class="ttc" id="classv8_1_1_context_html_a9eb1408c458c49ea98d4e3a8f7617f0f"><div class="ttname"><a href="../../df/d69/classv8_1_1_context.html#a9eb1408c458c49ea98d4e3a8f7617f0f">v8::Context::GetCurrent</a></div><div class="ttdeci">static Local&lt; Context &gt; GetCurrent()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l04545">api.cc:4545</a></div></div>
<div class="ttc" id="classv8_1_1_string_1_1_value_html"><div class="ttname"><a href="../../d0/d6b/classv8_1_1_string_1_1_value.html">v8::String::Value</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l01347">v8.h:1347</a></div></div>
<div class="ttc" id="classv8_1_1_debug_1_1_message_html_a5e8220bed8b3bf7c537711ce6b9653d6"><div class="ttname"><a href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a5e8220bed8b3bf7c537711ce6b9653d6">v8::Debug::Message::GetEvent</a></div><div class="ttdeci">virtual DebugEvent GetEvent() const =0</div></div>
<div class="ttc" id="classv8_1_1_debug_html_a01f6a88c03b3e7b8c65c77caca32c8c4"><div class="ttname"><a href="../../de/d13/classv8_1_1_debug.html#a01f6a88c03b3e7b8c65c77caca32c8c4">v8::Debug::SetLiveEditEnabled</a></div><div class="ttdeci">static void SetLiveEditEnabled(bool enable, Isolate *isolate=NULL)</div></div>
<div class="ttc" id="classv8_1_1_script_html_aa7b74acaf5ab0ca34e877897315f45be"><div class="ttname"><a href="../../d0/d35/classv8_1_1_script.html#aa7b74acaf5ab0ca34e877897315f45be">v8::Script::Compile</a></div><div class="ttdeci">static Local&lt; Script &gt; Compile(Handle&lt; String &gt; source, ScriptOrigin *origin=NULL, ScriptData *pre_data=NULL, Handle&lt; String &gt; script_data=Handle&lt; String &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l01568">api.cc:1568</a></div></div>
<div class="ttc" id="classv8_1_1_debug_1_1_message_html_a1e7c258f96226ebca0fb9663e81407b9"><div class="ttname"><a href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a1e7c258f96226ebca0fb9663e81407b9">v8::Debug::Message::WillStartRunning</a></div><div class="ttdeci">virtual bool WillStartRunning() const =0</div></div>
<div class="ttc" id="checks_8h_html_a0ea8f66bf4733597f9a514fda2151ff9"><div class="ttname"><a href="../../d5/d16/checks_8h.html#a0ea8f66bf4733597f9a514fda2151ff9">CHECK_EQ</a></div><div class="ttdeci">#define CHECK_EQ(expected, value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/checks_8h_source.html#l00219">checks.h:219</a></div></div>
<div class="ttc" id="classv8_1_1_value_html_a3d46ba6a258e0029819606fe47d50c24"><div class="ttname"><a href="../../dc/d0a/classv8_1_1_value.html#a3d46ba6a258e0029819606fe47d50c24">v8::Value::IsTrue</a></div><div class="ttdeci">V8EXPORT bool IsTrue() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l02143">api.cc:2143</a></div></div>
<div class="ttc" id="classv8_1_1_v8_html_a98d1ed798b9e063cb4e75925615cac4e"><div class="ttname"><a href="../../df/d43/classv8_1_1_v8.html#a98d1ed798b9e063cb4e75925615cac4e">v8::V8::IsExecutionTerminating</a></div><div class="ttdeci">static bool IsExecutionTerminating(Isolate *isolate=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l05513">api.cc:5513</a></div></div>
<div class="ttc" id="namespacev8_1_1internal_html_a521544c43b8fe1dae91883cd28080da3aff699505fa2894108ea9f35f845abe64"><div class="ttname"><a href="../../d4/d32/namespacev8_1_1internal.html#a521544c43b8fe1dae91883cd28080da3aff699505fa2894108ea9f35f845abe64">v8::internal::DEBUGBREAK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d01/execution_8h_source.html#l00040">execution.h:40</a></div></div>
<div class="ttc" id="classv8_1_1_function_template_html_a3b5a2868860b0414c3607f6cf1567b78"><div class="ttname"><a href="../../d8/d83/classv8_1_1_function_template.html#a3b5a2868860b0414c3607f6cf1567b78">v8::FunctionTemplate::New</a></div><div class="ttdeci">static Local&lt; FunctionTemplate &gt; New(InvocationCallback callback=0, Handle&lt; Value &gt; data=Handle&lt; Value &gt;(), Handle&lt; Signature &gt; signature=Handle&lt; Signature &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l00951">api.cc:951</a></div></div>
<div class="ttc" id="api_8h_html"><div class="ttname"><a href="../../dc/d65/api_8h.html">api.h</a></div></div>
<div class="ttc" id="namespacev8_html_a50252b3ef3537127f61f73c2d3888092"><div class="ttname"><a href="../../d2/dc3/namespacev8.html#a50252b3ef3537127f61f73c2d3888092">v8::True</a></div><div class="ttdeci">Handle&lt; Boolean &gt; V8EXPORT True()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l00569">api.cc:569</a></div></div>
<div class="ttc" id="classv8_1_1_persistent_html_a6e2d745cdb7a7b983f861ed6a9a541a7"><div class="ttname"><a href="../../d2/d78/classv8_1_1_persistent.html#a6e2d745cdb7a7b983f861ed6a9a541a7">v8::Persistent::Dispose</a></div><div class="ttdeci">void Dispose()</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l04235">v8.h:4235</a></div></div>
<div class="ttc" id="classv8_1_1_context_html"><div class="ttname"><a href="../../df/d69/classv8_1_1_context.html">v8::Context</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l03635">v8.h:3635</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_vector_html"><div class="ttname"><a href="../../d5/d7d/classv8_1_1internal_1_1_vector.html">v8::internal::Vector&lt; char &gt;</a></div></div>
<div class="ttc" id="classv8_1_1_handle_scope_html"><div class="ttname"><a href="../../d3/d95/classv8_1_1_handle_scope.html">v8::HandleScope</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l00446">v8.h:446</a></div></div>
<div class="ttc" id="classv8_1_1_try_catch_html_a65b4d97cc9755f7f99556dbe87d829ee"><div class="ttname"><a href="../../d4/dc6/classv8_1_1_try_catch.html#a65b4d97cc9755f7f99556dbe87d829ee">v8::TryCatch::Exception</a></div><div class="ttdeci">Local&lt; Value &gt; Exception() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l01720">api.cc:1720</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_handle_html"><div class="ttname"><a href="../../da/dde/classv8_1_1internal_1_1_handle.html">v8::internal::Handle</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d23/handles_8h_source.html#l00044">handles.h:44</a></div></div>
<div class="ttc" id="classv8_1_1_value_html_af0cd01c3c7904eb9537f2b15d09e8b76"><div class="ttname"><a href="../../dc/d0a/classv8_1_1_value.html#af0cd01c3c7904eb9537f2b15d09e8b76">v8::Value::StrictEquals</a></div><div class="ttdeci">V8EXPORT bool StrictEquals(Handle&lt; Value &gt; that) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l02711">api.cc:2711</a></div></div>
<div class="ttc" id="classv8_1_1_object_html_a15d9f2b57d7fc06e12259c976c7d66fc"><div class="ttname"><a href="../../db/d85/classv8_1_1_object.html#a15d9f2b57d7fc06e12259c976c7d66fc">v8::Object::Get</a></div><div class="ttdeci">V8EXPORT Local&lt; Value &gt; Get(Handle&lt; Value &gt; key)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l02853">api.cc:2853</a></div></div>
<div class="ttc" id="namespacev8_1_1internal_html_a15abb08e993176799070e492e920cbd5"><div class="ttname"><a href="../../d4/d32/namespacev8_1_1internal.html#a15abb08e993176799070e492e920cbd5">v8::internal::f0</a></div><div class="ttdeci">const FPURegister f0</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d46/assembler-mips_8h_source.html#l00286">assembler-mips.h:286</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_smi_html_a53259c85a9a7f54c354c7871cb340073"><div class="ttname"><a href="../../d8/dca/classv8_1_1internal_1_1_smi.html#a53259c85a9a7f54c354c7871cb340073">v8::internal::Smi::FromInt</a></div><div class="ttdeci">static Smi * FromInt(int value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dfe/objects-inl_8h_source.html#l00981">objects-inl.h:981</a></div></div>
<div class="ttc" id="debug_8h_html"><div class="ttname"><a href="../../db/d16/debug_8h.html">debug.h</a></div></div>
<div class="ttc" id="namespacev8_html_a28fb95f8f3ce5a9f3ff7fc78bd2fd812"><div class="ttname"><a href="../../d2/dc3/namespacev8.html#a28fb95f8f3ce5a9f3ff7fc78bd2fd812">v8::RegisterExtension</a></div><div class="ttdeci">void V8EXPORT RegisterExtension(Extension *extension)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l00526">api.cc:526</a></div></div>
<div class="ttc" id="classv8_1_1_object_template_html_afcc882983702100ce4f5550102b04ef4"><div class="ttname"><a href="../../db/d5f/classv8_1_1_object_template.html#afcc882983702100ce4f5550102b04ef4">v8::ObjectTemplate::NewInstance</a></div><div class="ttdeci">Local&lt; Object &gt; NewInstance()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l04660">api.cc:4660</a></div></div>
<div class="ttc" id="checks_8h_html_ad5a1a3bc35696ef5a1070bca3a419c99"><div class="ttname"><a href="../../d5/d16/checks_8h.html#ad5a1a3bc35696ef5a1070bca3a419c99">CHECK_GT</a></div><div class="ttdeci">#define CHECK_GT(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/checks_8h_source.html#l00227">checks.h:227</a></div></div>
<div class="ttc" id="classv8_1_1_try_catch_html_a68f455077e74f15d67c6cc1664dbc266"><div class="ttname"><a href="../../d4/dc6/classv8_1_1_try_catch.html#a68f455077e74f15d67c6cc1664dbc266">v8::TryCatch::HasCaught</a></div><div class="ttdeci">bool HasCaught() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l01703">api.cc:1703</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_thread_html_adc27ee0d7b66b8795db722f47a615cfe"><div class="ttname"><a href="../../db/d61/classv8_1_1internal_1_1_thread.html#adc27ee0d7b66b8795db722f47a615cfe">v8::internal::Thread::Run</a></div><div class="ttdeci">virtual void Run()=0</div></div>
<div class="ttc" id="classv8_1_1_script_origin_html"><div class="ttname"><a href="../../db/d84/classv8_1_1_script_origin.html">v8::ScriptOrigin</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l00576">v8.h:576</a></div></div>
<div class="ttc" id="namespacev8_html_ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb"><div class="ttname"><a href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba54957cf47b2c20cda66ae848d2b3aacb">v8::Break</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/v8-debug_8h_source.html#l00074">v8-debug.h:74</a></div></div>
<div class="ttc" id="classv8_1_1_string_html_a4e0912d12d080f5b9772b2f13b4ef994"><div class="ttname"><a href="../../d2/db3/classv8_1_1_string.html#a4e0912d12d080f5b9772b2f13b4ef994">v8::String::New</a></div><div class="ttdeci">static V8EXPORT Local&lt; String &gt; New(const char *data, int length=-1)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l04779">api.cc:4779</a></div></div>
<div class="ttc" id="classv8_1_1_script_html_a404713fb4376624c69f531ee50b9db90"><div class="ttname"><a href="../../d0/d35/classv8_1_1_script.html#a404713fb4376624c69f531ee50b9db90">v8::Script::SetData</a></div><div class="ttdeci">void SetData(Handle&lt; String &gt; data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l01660">api.cc:1660</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_socket_html_ad3e81de2c0735f63bf28eab6069184d2"><div class="ttname"><a href="../../d9/d18/classv8_1_1internal_1_1_socket.html#ad3e81de2c0735f63bf28eab6069184d2">v8::internal::Socket::Shutdown</a></div><div class="ttdeci">virtual bool Shutdown()=0</div></div>
<div class="ttc" id="classv8_1_1_context_1_1_scope_html"><div class="ttname"><a href="../../de/d41/classv8_1_1_context_1_1_scope.html">v8::Context::Scope</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l03781">v8.h:3781</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_external_two_byte_string_html_af3ce25de865a8cce7740f323036f3894"><div class="ttname"><a href="../../d2/d61/classv8_1_1internal_1_1_external_two_byte_string.html#af3ce25de865a8cce7740f323036f3894">v8::internal::ExternalTwoByteString::cast</a></div><div class="ttdeci">static ExternalTwoByteString * cast(Object *obj)</div></div>
<div class="ttc" id="namespacev8_html_ac08707d61d5d7a69b2a5001ba10ed79ba88a18e11ec269de0e91887c301bccd7e"><div class="ttname"><a href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba88a18e11ec269de0e91887c301bccd7e">v8::BreakForCommand</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/v8-debug_8h_source.html#l00080">v8-debug.h:80</a></div></div>
<div class="ttc" id="classv8_1_1_function_template_html_a7f38518da88507c8f2580b7ecb35317c"><div class="ttname"><a href="../../d8/d83/classv8_1_1_function_template.html#a7f38518da88507c8f2580b7ecb35317c">v8::FunctionTemplate::InstanceTemplate</a></div><div class="ttdeci">Local&lt; ObjectTemplate &gt; InstanceTemplate()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l01122">api.cc:1122</a></div></div>
<div class="ttc" id="classv8_1_1_exception_html"><div class="ttname"><a href="../../da/d6a/classv8_1_1_exception.html">v8::Exception</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l02678">v8.h:2678</a></div></div>
<div class="ttc" id="namespacev8_html_ac08707d61d5d7a69b2a5001ba10ed79b"><div class="ttname"><a href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79b">v8::DebugEvent</a></div><div class="ttdeci">DebugEvent</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/v8-debug_8h_source.html#l00073">v8-debug.h:73</a></div></div>
<div class="ttc" id="classv8_1_1_debug_1_1_event_details_html_a9f42d78445ecb9dce59ee8f80c9197fe"><div class="ttname"><a href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html#a9f42d78445ecb9dce59ee8f80c9197fe">v8::Debug::EventDetails::GetCallbackData</a></div><div class="ttdeci">virtual Handle&lt; Value &gt; GetCallbackData() const =0</div></div>
<div class="ttc" id="namespacev8_1_1internal_html_afe0c8382c7538527acc84c987be6c595a301d3e92bcf2f8986b1eb28c9afeb54e"><div class="ttname"><a href="../../d4/d32/namespacev8_1_1internal.html#afe0c8382c7538527acc84c987be6c595a301d3e92bcf2f8986b1eb28c9afeb54e">v8::internal::kNonStrictMode</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d87/globals_8h_source.html#l00398">globals.h:398</a></div></div>
<div class="ttc" id="classv8_1_1_debug_html_a5461ea199a445a303a65198a7521eb94"><div class="ttname"><a href="../../de/d13/classv8_1_1_debug.html#a5461ea199a445a303a65198a7521eb94">v8::Debug::GetDebugContext</a></div><div class="ttdeci">static Local&lt; Context &gt; GetDebugContext()</div></div>
<div class="ttc" id="classv8_1_1_handle_html_aa096c30831ccfdc10b35ef64698b5af2"><div class="ttname"><a href="../../d3/dd5/classv8_1_1_handle.html#aa096c30831ccfdc10b35ef64698b5af2">v8::Handle::Cast</a></div><div class="ttdeci">static Handle&lt; T &gt; Cast(Handle&lt; S &gt; that)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l00244">v8.h:244</a></div></div>
<div class="ttc" id="classv8_1_1_extension_html"><div class="ttname"><a href="../../d9/da9/classv8_1_1_extension.html">v8::Extension</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l02559">v8.h:2559</a></div></div>
<div class="ttc" id="classv8_1_1_context_html_a9e6aee5f2a332aad0a8b6e785921de70"><div class="ttname"><a href="../../df/d69/classv8_1_1_context.html#a9e6aee5f2a332aad0a8b6e785921de70">v8::Context::GetData</a></div><div class="ttdeci">Local&lt; Value &gt; GetData()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l00788">api.cc:788</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_socket_html_a9c3dc153870088c0353dbe9e5c6c1e76"><div class="ttname"><a href="../../d9/d18/classv8_1_1internal_1_1_socket.html#a9c3dc153870088c0353dbe9e5c6c1e76">v8::internal::Socket::Receive</a></div><div class="ttdeci">virtual int Receive(char *data, int len) const =0</div></div>
<div class="ttc" id="classv8_1_1_object_template_html_ad3baf9d0959cbc49663a33718d7dd8a3"><div class="ttname"><a href="../../db/d5f/classv8_1_1_object_template.html#ad3baf9d0959cbc49663a33718d7dd8a3">v8::ObjectTemplate::SetIndexedPropertyHandler</a></div><div class="ttdeci">void SetIndexedPropertyHandler(IndexedPropertyGetter getter, IndexedPropertySetter setter=0, IndexedPropertyQuery query=0, IndexedPropertyDeleter deleter=0, IndexedPropertyEnumerator enumerator=0, Handle&lt; Value &gt; data=Handle&lt; Value &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l01386">api.cc:1386</a></div></div>
<div class="ttc" id="classv8_1_1_debug_1_1_event_details_html_a5e8220bed8b3bf7c537711ce6b9653d6"><div class="ttname"><a href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html#a5e8220bed8b3bf7c537711ce6b9653d6">v8::Debug::EventDetails::GetEvent</a></div><div class="ttdeci">virtual DebugEvent GetEvent() const =0</div></div>
<div class="ttc" id="classv8_1_1_function_html_a0857617e4f2a360ecc9a558a66cdbff4"><div class="ttname"><a href="../../d5/d54/classv8_1_1_function.html#a0857617e4f2a360ecc9a558a66cdbff4">v8::Function::Call</a></div><div class="ttdeci">V8EXPORT Local&lt; Value &gt; Call(Handle&lt; Object &gt; recv, int argc, Handle&lt; Value &gt; argv[])</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l03652">api.cc:3652</a></div></div>
<div class="ttc" id="compilation-cache_8h_html"><div class="ttname"><a href="../../de/dea/compilation-cache_8h.html">compilation-cache.h</a></div></div>
<div class="ttc" id="classv8_1_1_handle_html_aa71d36872f416feaa853788a7a7a7ef8"><div class="ttname"><a href="../../d3/dd5/classv8_1_1_handle.html#aa71d36872f416feaa853788a7a7a7ef8">v8::Handle::Clear</a></div><div class="ttdeci">void Clear()</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l00214">v8.h:214</a></div></div>
<div class="ttc" id="classv8_1_1_v8_html_a07aa85791067a2785e0ba6c0f31c67c6"><div class="ttname"><a href="../../df/d43/classv8_1_1_v8.html#a07aa85791067a2785e0ba6c0f31c67c6">v8::V8::AddMessageListener</a></div><div class="ttdeci">static bool AddMessageListener(MessageCallback that)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l05273">api.cc:5273</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_script_html_af5d25c39e7d38591e52ee53301bb283d"><div class="ttname"><a href="../../d9/da4/classv8_1_1internal_1_1_script.html#af5d25c39e7d38591e52ee53301bb283d">v8::internal::Script::cast</a></div><div class="ttdeci">static Script * cast(Object *obj)</div></div>
<div class="ttc" id="namespaceunibrow_html_a273cf69d639a59973b6019625df33e30"><div class="ttname"><a href="../../d7/df6/namespaceunibrow.html#a273cf69d639a59973b6019625df33e30">unibrow::uint16_t</a></div><div class="ttdeci">unsigned short uint16_t</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dad/unicode_8cc_source.html#l00046">unicode.cc:46</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_deoptimizer_html_aa7e0ee7bd6552a499e4d6421cabd8742"><div class="ttname"><a href="../../dd/d9d/classv8_1_1internal_1_1_deoptimizer.html#aa7e0ee7bd6552a499e4d6421cabd8742">v8::internal::Deoptimizer::DeoptimizeAll</a></div><div class="ttdeci">static void DeoptimizeAll()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de7/deoptimizer_8cc_source.html#l00250">deoptimizer.cc:250</a></div></div>
<div class="ttc" id="namespacev8_1_1internal_html_a21939e1b7e98ec2dd612be4a0223d73f"><div class="ttname"><a href="../../d4/d32/namespacev8_1_1internal.html#a21939e1b7e98ec2dd612be4a0223d73f">v8::internal::f3</a></div><div class="ttdeci">const FPURegister f3</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d46/assembler-mips_8h_source.html#l00289">assembler-mips.h:289</a></div></div>
<div class="ttc" id="namespacev8_html_ac08707d61d5d7a69b2a5001ba10ed79bace1d56bc37c286ed08718089a72b1419"><div class="ttname"><a href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79bace1d56bc37c286ed08718089a72b1419">v8::AfterCompile</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/v8-debug_8h_source.html#l00078">v8-debug.h:78</a></div></div>
<div class="ttc" id="classv8_1_1_value_html_a91b68fb0b5558f1c9539015c1bbf7af2"><div class="ttname"><a href="../../dc/d0a/classv8_1_1_value.html#a91b68fb0b5558f1c9539015c1bbf7af2">v8::Value::ToString</a></div><div class="ttdeci">V8EXPORT Local&lt; String &gt; ToString() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l02313">api.cc:2313</a></div></div>
<div class="ttc" id="platform_8h_html"><div class="ttname"><a href="../../de/d03/platform_8h.html">platform.h</a></div></div>
<div class="ttc" id="classv8_1_1_debug_1_1_message_html_a0633ca6194b8474fe39d4cffcc52b859"><div class="ttname"><a href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a0633ca6194b8474fe39d4cffcc52b859">v8::Debug::Message::IsEvent</a></div><div class="ttdeci">virtual bool IsEvent() const =0</div></div>
<div class="ttc" id="checks_8h_html_a3e1cfef60e774a81f30eaddf26a3a274"><div class="ttname"><a href="../../d5/d16/checks_8h.html#a3e1cfef60e774a81f30eaddf26a3a274">CHECK</a></div><div class="ttdeci">#define CHECK(condition)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/checks_8h_source.html#l00056">checks.h:56</a></div></div>
<div class="ttc" id="classv8_1_1_debug_1_1_message_html_a7761bfded060dc3978fc2150f9ad0e63"><div class="ttname"><a href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a7761bfded060dc3978fc2150f9ad0e63">v8::Debug::Message::GetClientData</a></div><div class="ttdeci">virtual ClientData * GetClientData() const =0</div></div>
<div class="ttc" id="classv8_1_1_template_html_ae26f56c0bce13aa1815c5c50617fc791"><div class="ttname"><a href="../../db/df7/classv8_1_1_template.html#ae26f56c0bce13aa1815c5c50617fc791">v8::Template::Set</a></div><div class="ttdeci">void Set(Handle&lt; String &gt; name, Handle&lt; Data &gt; value, PropertyAttribute attributes=None)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l00902">api.cc:902</a></div></div>
<div class="ttc" id="classv8_1_1_function_html_a2e69da7035a0d06c61e94dbefe1e866b"><div class="ttname"><a href="../../d5/d54/classv8_1_1_function.html#a2e69da7035a0d06c61e94dbefe1e866b">v8::Function::Cast</a></div><div class="ttdeci">static Function * Cast(Value *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l04597">v8.h:4597</a></div></div>
<div class="ttc" id="checks_8h_html_a54b4a23953fc7a4f455e4fc47e05c215"><div class="ttname"><a href="../../d5/d16/checks_8h.html#a54b4a23953fc7a4f455e4fc47e05c215">CHECK_GE</a></div><div class="ttdeci">#define CHECK_GE(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/checks_8h_source.html#l00228">checks.h:228</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_socket_html_a9eec95d5f5af5300a39e67385795da2b"><div class="ttname"><a href="../../d9/d18/classv8_1_1internal_1_1_socket.html#a9eec95d5f5af5300a39e67385795da2b">v8::internal::Socket::Send</a></div><div class="ttdeci">virtual int Send(const char *data, int len) const =0</div></div>
<div class="ttc" id="classv8_1_1_string_1_1_external_string_resource_html_ae326749f0c4660b410e8413215a26e25"><div class="ttname"><a href="../../d3/d29/classv8_1_1_string_1_1_external_string_resource.html#ae326749f0c4660b410e8413215a26e25">v8::String::ExternalStringResource::data</a></div><div class="ttdeci">virtual const uint16_t * data() const =0</div></div>
<div class="ttc" id="classv8_1_1_string_1_1_ascii_value_html"><div class="ttname"><a href="../../d8/dcb/classv8_1_1_string_1_1_ascii_value.html">v8::String::AsciiValue</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l01325">v8.h:1325</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_socket_html"><div class="ttname"><a href="../../d9/d18/classv8_1_1internal_1_1_socket.html">v8::internal::Socket</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d03/platform_8h_source.html#l00665">platform.h:665</a></div></div>
<div class="ttc" id="cctest_8h_html"><div class="ttname"><a href="../../df/d84/cctest_8h.html">cctest.h</a></div></div>
<div class="ttc" id="utils_8h_html"><div class="ttname"><a href="../../d5/d60/utils_8h.html">utils.h</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_isolate_html_ac4bd5767160ff3b2e233134435e83fc3"><div class="ttname"><a href="../../dd/d38/classv8_1_1internal_1_1_isolate.html#ac4bd5767160ff3b2e233134435e83fc3">v8::internal::Isolate::stack_guard</a></div><div class="ttdeci">StackGuard * stack_guard()</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d1e/isolate_8h_source.html#l00834">isolate.h:834</a></div></div>
<div class="ttc" id="test-accessors_8cc_html_a819b717d29c6c488a332fefeeb3815ba"><div class="ttname"><a href="../../d6/df1/test-accessors_8cc.html#a819b717d29c6c488a332fefeeb3815ba">foo</a></div><div class="ttdeci">int foo</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/df1/test-accessors_8cc_source.html#l00085">test-accessors.cc:85</a></div></div>
<div class="ttc" id="property-details_8h_html_ad8c75160526c9af7c8fa09418542c4e3a25edafa890b5af702b1c6a0b444da0b8"><div class="ttname"><a href="../../d5/d43/property-details_8h.html#ad8c75160526c9af7c8fa09418542c4e3a25edafa890b5af702b1c6a0b444da0b8">DONT_ENUM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d43/property-details_8h_source.html#l00039">property-details.h:39</a></div></div>
<div class="ttc" id="classv8_1_1_debug_html_a8fc50de4e1e6d1b68f280f5d0c3086c3"><div class="ttname"><a href="../../de/d13/classv8_1_1_debug.html#a8fc50de4e1e6d1b68f280f5d0c3086c3">v8::Debug::DebugBreakForCommand</a></div><div class="ttdeci">static void DebugBreakForCommand(ClientData *data=NULL, Isolate *isolate=NULL)</div></div>
<div class="ttc" id="classv8_1_1_script_html_ac863f6ddf042f479912dd207d3fd17e0"><div class="ttname"><a href="../../d0/d35/classv8_1_1_script.html#ac863f6ddf042f479912dd207d3fd17e0">v8::Script::Id</a></div><div class="ttdeci">Local&lt; Value &gt; Id()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l01643">api.cc:1643</a></div></div>
<div class="ttc" id="classv8_1_1_script_html_ac1223816dab9d0df897a09a5fb899466"><div class="ttname"><a href="../../d0/d35/classv8_1_1_script.html#ac1223816dab9d0df897a09a5fb899466">v8::Script::New</a></div><div class="ttdeci">static Local&lt; Script &gt; New(Handle&lt; String &gt; source, ScriptOrigin *origin=NULL, ScriptData *pre_data=NULL, Handle&lt; String &gt; script_data=Handle&lt; String &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l01506">api.cc:1506</a></div></div>
<div class="ttc" id="checks_8cc_html_af00312fd9717ee54d003136140753a32"><div class="ttname"><a href="../../d8/d29/checks_8cc.html#af00312fd9717ee54d003136140753a32">V8_Fatal</a></div><div class="ttdeci">void V8_Fatal(const char *file, int line, const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d29/checks_8cc_source.html#l00038">checks.cc:38</a></div></div>
<div class="ttc" id="classv8_1_1_debug_html_abcd3ae702b7a13710137dd5ab2654104"><div class="ttname"><a href="../../de/d13/classv8_1_1_debug.html#abcd3ae702b7a13710137dd5ab2654104">v8::Debug::SetDebugEventListener</a></div><div class="ttdeci">static bool SetDebugEventListener(EventCallback that, Handle&lt; Value &gt; data=Handle&lt; Value &gt;())</div></div>
<div class="ttc" id="classv8_1_1_string_1_1_external_string_resource_html_aff947d59ef34f9120a8baf6ad167c36f"><div class="ttname"><a href="../../d3/d29/classv8_1_1_string_1_1_external_string_resource.html#aff947d59ef34f9120a8baf6ad167c36f">v8::String::ExternalStringResource::length</a></div><div class="ttdeci">virtual size_t length() const =0</div></div>
<div class="ttc" id="test-thread-termination_8cc_html_a5e0f60888f1d0bb3daf99036125b899a"><div class="ttname"><a href="../../d1/deb/test-thread-termination_8cc.html#a5e0f60888f1d0bb3daf99036125b899a">call_count</a></div><div class="ttdeci">int call_count</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/deb/test-thread-termination_8cc_source.html#l00268">test-thread-termination.cc:268</a></div></div>
<div class="ttc" id="deoptimizer_8h_html"><div class="ttname"><a href="../../d1/d23/deoptimizer_8h.html">deoptimizer.h</a></div></div>
<div class="ttc" id="namespacev8_1_1internal_html_a31cef5fa9835a15a28b6e650d4a724d4"><div class="ttname"><a href="../../d4/d32/namespacev8_1_1internal.html#a31cef5fa9835a15a28b6e650d4a724d4">v8::internal::StringToInt</a></div><div class="ttdeci">double StringToInt(UnicodeCache *unicode_cache, String *str, int radix)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd0/v8conversions_8cc_source.html#l00107">v8conversions.cc:107</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_thread_html"><div class="ttname"><a href="../../db/d61/classv8_1_1internal_1_1_thread.html">v8::internal::Thread</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d03/platform_8h_source.html#l00449">platform.h:449</a></div></div>
<div class="ttc" id="classv8_1_1_object_template_html_ada5e0fda7225c6a63c54f1d07bdc718c"><div class="ttname"><a href="../../db/d5f/classv8_1_1_object_template.html#ada5e0fda7225c6a63c54f1d07bdc718c">v8::ObjectTemplate::New</a></div><div class="ttdeci">static Local&lt; ObjectTemplate &gt; New()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l01253">api.cc:1253</a></div></div>
<div class="ttc" id="classv8_1_1_debug_html_af826b9404d46b69da1fe569ff785cd7c"><div class="ttname"><a href="../../de/d13/classv8_1_1_debug.html#af826b9404d46b69da1fe569ff785cd7c">v8::Debug::SetHostDispatchHandler</a></div><div class="ttdeci">static void SetHostDispatchHandler(HostDispatchHandler handler, int period=100)</div></div>
<div class="ttc" id="classv8_1_1_debug_1_1_event_details_html_a6c310570684fe353e180846f823a099d"><div class="ttname"><a href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html#a6c310570684fe353e180846f823a099d">v8::Debug::EventDetails::GetExecutionState</a></div><div class="ttdeci">virtual Handle&lt; Object &gt; GetExecutionState() const =0</div></div>
<div class="ttc" id="classv8_1_1internal_1_1_heap_html_a2aed3c801bc981533015db78190333fa"><div class="ttname"><a href="../../dd/d58/classv8_1_1internal_1_1_heap.html#a2aed3c801bc981533015db78190333fa">v8::internal::Heap::kNoGCFlags</a></div><div class="ttdeci">static const int kNoGCFlags</div><div class="ttdef"><b>Definition:</b> <a href="../../da/ddb/heap_8h_source.html#l01081">heap.h:1081</a></div></div>
<div class="ttc" id="namespacev8_1_1internal_html_a0ff83451bc94a1105976297cc6b68676"><div class="ttname"><a href="../../d4/d32/namespacev8_1_1internal.html#a0ff83451bc94a1105976297cc6b68676">v8::internal::Object</a></div><div class="ttdeci">Object</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dfe/objects-inl_8h_source.html#l03851">objects-inl.h:3851</a></div></div>
<div class="ttc" id="classv8_1_1_object_template_html_a15549aa25e1ad60c23f086170841c482"><div class="ttname"><a href="../../db/d5f/classv8_1_1_object_template.html#a15549aa25e1ad60c23f086170841c482">v8::ObjectTemplate::SetAccessor</a></div><div class="ttdeci">void SetAccessor(Handle&lt; String &gt; name, AccessorGetter getter, AccessorSetter setter=0, Handle&lt; Value &gt; data=Handle&lt; Value &gt;(), AccessControl settings=DEFAULT, PropertyAttribute attribute=None, Handle&lt; AccessorSignature &gt; signature=Handle&lt; AccessorSignature &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l01291">api.cc:1291</a></div></div>
<div class="ttc" id="namespacev8_1_1internal_html_a7e9db74e121402bd5e9e584fa9225897"><div class="ttname"><a href="../../d4/d32/namespacev8_1_1internal.html#a7e9db74e121402bd5e9e584fa9225897">v8::internal::SetProperty</a></div><div class="ttdeci">Handle&lt; Object &gt; SetProperty(Handle&lt; Object &gt; object, Handle&lt; Object &gt; key, Handle&lt; Object &gt; value, PropertyAttributes attributes, StrictModeFlag strict_mode)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d59/handles_8cc_source.html#l00232">handles.cc:232</a></div></div>
<div class="ttc" id="classv8_1_1_debug_1_1_event_details_html"><div class="ttname"><a href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html">v8::Debug::EventDetails</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/v8-debug_8h_source.html#l00150">v8-debug.h:150</a></div></div>
<div class="ttc" id="classv8_1_1_accessor_info_html"><div class="ttname"><a href="../../da/d41/classv8_1_1_accessor_info.html">v8::AccessorInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l02033">v8.h:2033</a></div></div>
<div class="ttc" id="flag-definitions_8h_html_a52143ab7f8a8ac8ea0cdbe70d282c73a"><div class="ttname"><a href="../../d1/d2e/flag-definitions_8h.html#a52143ab7f8a8ac8ea0cdbe70d282c73a">message</a></div><div class="ttdeci">activate correct semantics for inheriting readonliness enable harmony semantics for typeof enable harmony enable harmony proxies enable all harmony harmony_scoping harmony_proxies harmony_scoping tracks arrays with only smi values automatically unbox arrays of doubles use crankshaft use hydrogen range analysis use hydrogen global value numbering use function inlining maximum number of AST nodes considered for a single inlining loop invariant code motion print statistics for hydrogen trace generated IR for specified phases trace register allocator trace range analysis trace representation types environment for every instruction put a break point before deoptimizing polymorphic inlining perform array bounds checks elimination use dead code elimination trace on stack replacement optimize closures cache optimized code for closures functions with arguments object loop weight for representation inference allow uint32 values on optimize frames if they are used only in safe operations track parallel recompilation enable all profiler experiments number of stack frames inspected by the profiler call recompile stub directly when self optimizing trigger profiler ticks based on counting instead of timing weight back edges by jump distance for interrupt triggering percentage of ICs that must have type info to allow optimization watch_ic_patching retry_self_opt interrupt_at_exit extra verbose compilation tracing generate extra emit comments in code disassembly enable use of SSE3 instructions if available enable use of CMOV instruction if available enable use of SAHF instruction if enable use of VFP3 instructions if available this implies enabling ARMv7 and VFP2 enable use of VFP2 instructions if available enable use of SDIV and UDIV instructions if enable loading bit constant by means of movw movt instruction enable unaligned accesses for enable use of MIPS FPU instructions if expose natives in global object expose gc extension number of stack frames to capture disable builtin natives files print a stack trace if an assertion failure occurs use random jit cookie to mask large constants trace lazy optimization use adaptive optimizations prepare for turning on always opt minimum length for automatic enable preparsing maximum number of optimization attempts before giving up cache prototype transitions automatically set the debug break flag when debugger commands are in the queue always cause a debug break before aborting maximum length of function source code printed in a stack trace max size of the new max size of the old max size of executable always perform global GCs print one trace line following each garbage collection do not print trace line after scavenger collection print more details following each garbage collection print amount of external allocated memory after each time it is adjusted flush code that we expect not to use again before full gc do incremental marking steps track object counts and memory usage use caching Perform compaction on every full GC Never perform compaction on full GC testing only Compact code space on full incremental collections Default seed for initializing random allows verbose printing trace parsing and preparsing Check icache flushes in ARM and MIPS simulator Stack alingment in bytes in print stack trace when throwing exceptions randomize hashes to avoid predictable hash Fixed seed to use to hash property activate a timer that switches between V8 threads testing_bool_flag float flag Seed used for threading test randomness A filename with extra code to be included in the Print usage message</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d2e/flag-definitions_8h_source.html#l00494">flag-definitions.h:494</a></div></div>
<div class="ttc" id="classv8_1_1_v8_html_ae438202e4c169f7e80162bba1e14f83e"><div class="ttname"><a href="../../df/d43/classv8_1_1_v8.html#ae438202e4c169f7e80162bba1e14f83e">v8::V8::TerminateExecution</a></div><div class="ttdeci">static void TerminateExecution(int thread_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l05487">api.cc:5487</a></div></div>
<div class="ttc" id="classv8_1_1_value_html_a3837d763158f1718969858a513670c62"><div class="ttname"><a href="../../dc/d0a/classv8_1_1_value.html#a3837d763158f1718969858a513670c62">v8::Value::Int32Value</a></div><div class="ttdeci">V8EXPORT int32_t Int32Value() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l02662">api.cc:2662</a></div></div>
<div class="ttc" id="classv8_1_1_context_html_a8fc7f005c25f7ac02e35c8ebf51183b3"><div class="ttname"><a href="../../df/d69/classv8_1_1_context.html#a8fc7f005c25f7ac02e35c8ebf51183b3">v8::Context::Global</a></div><div class="ttdeci">Local&lt; Object &gt; Global()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l04570">api.cc:4570</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_mutex_html"><div class="ttname"><a href="../../de/dfb/classv8_1_1internal_1_1_mutex.html">v8::internal::Mutex</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d03/platform_8h_source.html#l00548">platform.h:548</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_smart_array_pointer_html"><div class="ttname"><a href="../../d1/dfa/classv8_1_1internal_1_1_smart_array_pointer.html">v8::internal::SmartArrayPointer&lt; char &gt;</a></div></div>
<div class="ttc" id="classv8_1_1_v8_html_ae61ffdc4886d3057e578e4e39420deb6"><div class="ttname"><a href="../../df/d43/classv8_1_1_v8.html#ae61ffdc4886d3057e578e4e39420deb6">v8::V8::RemoveMessageListeners</a></div><div class="ttdeci">static void RemoveMessageListeners(MessageCallback that)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l05285">api.cc:5285</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_embedded_vector_html"><div class="ttname"><a href="../../db/d76/classv8_1_1internal_1_1_embedded_vector.html">v8::internal::EmbeddedVector</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00483">utils.h:483</a></div></div>
<div class="ttc" id="classv8_1_1_debug_1_1_client_data_html"><div class="ttname"><a href="../../d9/d18/classv8_1_1_debug_1_1_client_data.html">v8::Debug::ClientData</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/v8-debug_8h_source.html#l00090">v8-debug.h:90</a></div></div>
<div class="ttc" id="classv8_1_1_object_html_a98ad2e2a82b457a733bee13e4c2ba876"><div class="ttname"><a href="../../db/d85/classv8_1_1_object.html#a98ad2e2a82b457a733bee13e4c2ba876">v8::Object::SetHiddenValue</a></div><div class="ttdeci">V8EXPORT bool SetHiddenValue(Handle&lt; String &gt; key, Handle&lt; Value &gt; value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l03305">api.cc:3305</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_heap_html_afbaa9137eb86d66f958fcc41a77c2fea"><div class="ttname"><a href="../../dd/d58/classv8_1_1internal_1_1_heap.html#afbaa9137eb86d66f958fcc41a77c2fea">v8::internal::Heap::kMakeHeapIterableMask</a></div><div class="ttdeci">static const int kMakeHeapIterableMask</div><div class="ttdef"><b>Definition:</b> <a href="../../da/ddb/heap_8h_source.html#l01088">heap.h:1088</a></div></div>
<div class="ttc" id="classv8_1_1_debug_1_1_message_html_a1aa4b5cc7d83218c3a361692bcdce007"><div class="ttname"><a href="../../de/dbd/classv8_1_1_debug_1_1_message.html#a1aa4b5cc7d83218c3a361692bcdce007">v8::Debug::Message::GetJSON</a></div><div class="ttdeci">virtual Handle&lt; String &gt; GetJSON() const =0</div></div>
<div class="ttc" id="classv8_1_1_handle_html"><div class="ttname"><a href="../../d3/dd5/classv8_1_1_handle.html">v8::Handle</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l00105">v8.h:105</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_socket_html_afb4603adf38a295e156ae2a7730c978f"><div class="ttname"><a href="../../d9/d18/classv8_1_1internal_1_1_socket.html#afb4603adf38a295e156ae2a7730c978f">v8::internal::Socket::Connect</a></div><div class="ttdeci">virtual bool Connect(const char *host, const char *port)=0</div></div>
<div class="ttc" id="namespacev8_1_1internal_html_a61f71fa44dbac342ed3919921c4fc95b"><div class="ttname"><a href="../../d4/d32/namespacev8_1_1internal.html#a61f71fa44dbac342ed3919921c4fc95b">v8::internal::f2</a></div><div class="ttdeci">const FPURegister f2</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d46/assembler-mips_8h_source.html#l00288">assembler-mips.h:288</a></div></div>
<div class="ttc" id="classv8_1_1_context_html_a90f77effd76202d7370a234414fa06c6"><div class="ttname"><a href="../../df/d69/classv8_1_1_context.html#a90f77effd76202d7370a234414fa06c6">v8::Context::GetCalling</a></div><div class="ttdeci">static Local&lt; Context &gt; GetCalling()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l04557">api.cc:4557</a></div></div>
<div class="ttc" id="classv8_1_1_value_html_a2858c3ff89ed8f4b756b94cbebcfe42f"><div class="ttname"><a href="../../dc/d0a/classv8_1_1_value.html#a2858c3ff89ed8f4b756b94cbebcfe42f">v8::Value::IsUndefined</a></div><div class="ttdeci">bool IsUndefined() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l04472">v8.h:4472</a></div></div>
<div class="ttc" id="classv8_1_1_value_html_a1510d19d3b776197459ac9da4a0ae64f"><div class="ttname"><a href="../../dc/d0a/classv8_1_1_value.html#a1510d19d3b776197459ac9da4a0ae64f">v8::Value::IsFunction</a></div><div class="ttdeci">V8EXPORT bool IsFunction() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l02155">api.cc:2155</a></div></div>
<div class="ttc" id="stub-cache_8h_html"><div class="ttname"><a href="../../dc/db3/stub-cache_8h.html">stub-cache.h</a></div></div>
<div class="ttc" id="checks_8h_html_a403854a78bdaff5e42e57b4126bd12f4"><div class="ttname"><a href="../../d5/d16/checks_8h.html#a403854a78bdaff5e42e57b4126bd12f4">CHECK_NE</a></div><div class="ttdeci">#define CHECK_NE(unexpected, value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/checks_8h_source.html#l00223">checks.h:223</a></div></div>
<div class="ttc" id="classv8_1_1_debug_html_a969c9d982bcc1e4219047212bfb64467"><div class="ttname"><a href="../../de/d13/classv8_1_1_debug.html#a969c9d982bcc1e4219047212bfb64467">v8::Debug::SetMessageHandler</a></div><div class="ttdeci">static void SetMessageHandler(MessageHandler handler, bool message_handler_thread=false)</div></div>
<div class="ttc" id="namespacev8_html_a6d946d0599c405a057cb4a1b446c3662"><div class="ttname"><a href="../../d2/dc3/namespacev8.html#a6d946d0599c405a057cb4a1b446c3662">v8::False</a></div><div class="ttdeci">Handle&lt; Boolean &gt; V8EXPORT False()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l00579">api.cc:579</a></div></div>
<div class="ttc" id="classv8_1_1_function_template_html_ac7b86dfd4d1ed73a4a6aac7d2de8a20b"><div class="ttname"><a href="../../d8/d83/classv8_1_1_function_template.html#ac7b86dfd4d1ed73a4a6aac7d2de8a20b">v8::FunctionTemplate::SetHiddenPrototype</a></div><div class="ttdeci">void SetHiddenPrototype(bool value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l01147">api.cc:1147</a></div></div>
<div class="ttc" id="namespacev8_1_1internal_html_ade544f21fa0bf00a352dfd991253bc03"><div class="ttname"><a href="../../d4/d32/namespacev8_1_1internal.html#ade544f21fa0bf00a352dfd991253bc03">v8::internal::StrLength</a></div><div class="ttdeci">int StrLength(const char *string)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00234">utils.h:234</a></div></div>
<div class="ttc" id="classv8_1_1_utils_html_a91962d30779259da776009f0cfb58291"><div class="ttname"><a href="../../d4/d4b/classv8_1_1_utils.html#a91962d30779259da776009f0cfb58291">v8::Utils::ToLocal</a></div><div class="ttdeci">static Local&lt; Context &gt; ToLocal(v8::internal::Handle&lt; v8::internal::Context &gt; obj)</div></div>
<div class="ttc" id="classv8_1_1_object_template_html_a21edabb159db29683a37ea2eef37f20c"><div class="ttname"><a href="../../db/d5f/classv8_1_1_object_template.html#a21edabb159db29683a37ea2eef37f20c">v8::ObjectTemplate::SetNamedPropertyHandler</a></div><div class="ttdeci">void SetNamedPropertyHandler(NamedPropertyGetter getter, NamedPropertySetter setter=0, NamedPropertyQuery query=0, NamedPropertyDeleter deleter=0, NamedPropertyEnumerator enumerator=0, Handle&lt; Value &gt; data=Handle&lt; Value &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l01316">api.cc:1316</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_semaphore_html"><div class="ttname"><a href="../../dd/d6f/classv8_1_1internal_1_1_semaphore.html">v8::internal::Semaphore</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d03/platform_8h_source.html#l00617">platform.h:617</a></div></div>
<div class="ttc" id="classv8_1_1_string_1_1_external_string_resource_html"><div class="ttname"><a href="../../d3/d29/classv8_1_1_string_1_1_external_string_resource.html">v8::String::ExternalStringResource</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l01143">v8.h:1143</a></div></div>
<div class="ttc" id="classv8_1_1_value_html_abfee0d12e50e0499ce0e3eac2612b3a2"><div class="ttname"><a href="../../dc/d0a/classv8_1_1_value.html#abfee0d12e50e0499ce0e3eac2612b3a2">v8::Value::IsString</a></div><div class="ttdeci">bool IsString() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l04508">v8.h:4508</a></div></div>
<div class="ttc" id="classv8_1_1_local_html_af8ad97e74b3e02fafdb20fd8f42efba5"><div class="ttname"><a href="../../de/deb/classv8_1_1_local.html#af8ad97e74b3e02fafdb20fd8f42efba5">v8::Local::Cast</a></div><div class="ttdeci">static Local&lt; T &gt; Cast(Local&lt; S &gt; that)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l00282">v8.h:282</a></div></div>
<div class="ttc" id="namespacev8_html_aa944500afca8000fffef41951b9f2660ac9d3e887722f2bc482bcca9d41c512af"><div class="ttname"><a href="../../d2/dc3/namespacev8.html#aa944500afca8000fffef41951b9f2660ac9d3e887722f2bc482bcca9d41c512af">v8::None</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l01425">v8.h:1425</a></div></div>
<div class="ttc" id="classv8_1_1_debug_html_ac4bc676ae18348abb5fb1ad66973ac0b"><div class="ttname"><a href="../../de/d13/classv8_1_1_debug.html#ac4bc676ae18348abb5fb1ad66973ac0b">v8::Debug::SetMessageHandler2</a></div><div class="ttdeci">static void SetMessageHandler2(MessageHandler2 handler)</div></div>
<div class="ttc" id="namespacev8_1_1internal_html_a0b6640d40ef81deed8dc8b27c28aaee8"><div class="ttname"><a href="../../d4/d32/namespacev8_1_1internal.html#a0b6640d40ef81deed8dc8b27c28aaee8">v8::internal::GetScriptLineNumber</a></div><div class="ttdeci">int GetScriptLineNumber(Handle&lt; Script &gt; script, int code_pos)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d59/handles_8cc_source.html#l00479">handles.cc:479</a></div></div>
<div class="ttc" id="classv8_1_1_debug_html_a08b70cdbfce3a171f21ed3f2c53192d2"><div class="ttname"><a href="../../de/d13/classv8_1_1_debug.html#a08b70cdbfce3a171f21ed3f2c53192d2">v8::Debug::SetDebugMessageDispatchHandler</a></div><div class="ttdeci">static void SetDebugMessageDispatchHandler(DebugMessageDispatchHandler handler, bool provide_locker=false)</div></div>
<div class="ttc" id="classv8_1_1_arguments_html"><div class="ttname"><a href="../../df/d31/classv8_1_1_arguments.html">v8::Arguments</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l02000">v8.h:2000</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_stack_guard_html_a72e96e9d3857635ac17443562bc0aebe"><div class="ttname"><a href="../../d4/d71/classv8_1_1internal_1_1_stack_guard.html#a72e96e9d3857635ac17443562bc0aebe">v8::internal::StackGuard::Continue</a></div><div class="ttdeci">void Continue(InterruptFlag after_what)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d7d/execution_8cc_source.html#l00513">execution.cc:513</a></div></div>
<div class="ttc" id="classv8_1_1_value_html_aa9d220237cea3d96fe34448d6ec84847"><div class="ttname"><a href="../../dc/d0a/classv8_1_1_value.html#aa9d220237cea3d96fe34448d6ec84847">v8::Value::IsNumber</a></div><div class="ttdeci">V8EXPORT bool IsNumber() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l02183">api.cc:2183</a></div></div>
<div class="ttc" id="classv8_1_1_debug_1_1_event_details_html_a7761bfded060dc3978fc2150f9ad0e63"><div class="ttname"><a href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html#a7761bfded060dc3978fc2150f9ad0e63">v8::Debug::EventDetails::GetClientData</a></div><div class="ttdeci">virtual ClientData * GetClientData() const =0</div></div>
<div class="ttc" id="classv8_1_1_function_template_html_a7d1eef8a098a7467763f8c17f37b2d0d"><div class="ttname"><a href="../../d8/d83/classv8_1_1_function_template.html#a7d1eef8a098a7467763f8c17f37b2d0d">v8::FunctionTemplate::GetFunction</a></div><div class="ttdeci">Local&lt; Function &gt; GetFunction()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l04675">api.cc:4675</a></div></div>
<div class="ttc" id="classv8_1_1_debug_1_1_message_html"><div class="ttname"><a href="../../de/dbd/classv8_1_1_debug_1_1_message.html">v8::Debug::Message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/v8-debug_8h_source.html#l00099">v8-debug.h:99</a></div></div>
<div class="ttc" id="namespacev8_html_ac08707d61d5d7a69b2a5001ba10ed79ba17524a77b7673b0322cc15aa590d1e41"><div class="ttname"><a href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba17524a77b7673b0322cc15aa590d1e41">v8::Exception</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/v8-debug_8h_source.html#l00075">v8-debug.h:75</a></div></div>
<div class="ttc" id="classv8_1_1_debug_html_a6193450d47c80996b33eeae196c2535d"><div class="ttname"><a href="../../de/d13/classv8_1_1_debug.html#a6193450d47c80996b33eeae196c2535d">v8::Debug::SetDebugEventListener2</a></div><div class="ttdeci">static bool SetDebugEventListener2(EventCallback2 that, Handle&lt; Value &gt; data=Handle&lt; Value &gt;())</div></div>
<div class="ttc" id="namespacev8_html_a2e9a0288e6c2df2ecebc50944c3ff9faa88ec7d5086d2469ba843c7fcceade8a6"><div class="ttname"><a href="../../d2/dc3/namespacev8.html#a2e9a0288e6c2df2ecebc50944c3ff9faa88ec7d5086d2469ba843c7fcceade8a6">v8::DEFAULT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l01471">v8.h:1471</a></div></div>
<div class="ttc" id="classv8_1_1_persistent_html"><div class="ttname"><a href="../../d2/d78/classv8_1_1_persistent.html">v8::Persistent&lt; v8::Context &gt;</a></div></div>
<div class="ttc" id="isolate_8h_html_a4e8c3dc786eeec70c7c26763ea3d2ef7"><div class="ttname"><a href="../../d8/d1e/isolate_8h.html#a4e8c3dc786eeec70c7c26763ea3d2ef7">HEAP</a></div><div class="ttdeci">#define HEAP</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d1e/isolate_8h_source.html#l01433">isolate.h:1433</a></div></div>
<div class="ttc" id="classv8_1_1_try_catch_html"><div class="ttname"><a href="../../d4/dc6/classv8_1_1_try_catch.html">v8::TryCatch</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l03508">v8.h:3508</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_reloc_iterator_html"><div class="ttname"><a href="../../df/d0c/classv8_1_1internal_1_1_reloc_iterator.html">v8::internal::RelocIterator</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dec/assembler_8h_source.html#l00444">assembler.h:444</a></div></div>
<div class="ttc" id="namespacev8_1_1internal_html_a62faa0b827a826722636f447051be4af"><div class="ttname"><a href="../../d4/d32/namespacev8_1_1internal.html#a62faa0b827a826722636f447051be4af">v8::internal::f1</a></div><div class="ttdeci">const FPURegister f1</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d46/assembler-mips_8h_source.html#l00287">assembler-mips.h:287</a></div></div>
<div class="ttc" id="classv8_1_1_integer_html_ab6814b14977933efe2fef83a84ab1ef1"><div class="ttname"><a href="../../df/d84/classv8_1_1_integer.html#ab6814b14977933efe2fef83a84ab1ef1">v8::Integer::New</a></div><div class="ttdeci">static V8EXPORT Local&lt; Integer &gt; New(int32_t value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l05228">api.cc:5228</a></div></div>
<div class="ttc" id="flag-definitions_8h_html_a49435ced13267a613e1d5ba777466b64"><div class="ttname"><a href="../../d1/d2e/flag-definitions_8h.html#a49435ced13267a613e1d5ba777466b64">NULL</a></div><div class="ttdeci">activate correct semantics for inheriting readonliness enable harmony semantics for typeof enable harmony enable harmony proxies enable all harmony harmony_scoping harmony_proxies harmony_scoping tracks arrays with only smi values automatically unbox arrays of doubles use crankshaft use hydrogen range analysis use hydrogen global value numbering use function inlining maximum number of AST nodes considered for a single inlining loop invariant code motion print statistics for hydrogen trace generated IR for specified phases trace register allocator trace range analysis trace representation types environment for every instruction put a break point before deoptimizing polymorphic inlining perform array bounds checks elimination use dead code elimination trace on stack replacement optimize closures cache optimized code for closures functions with arguments object loop weight for representation inference allow uint32 values on optimize frames if they are used only in safe operations track parallel recompilation enable all profiler experiments number of stack frames inspected by the profiler call recompile stub directly when self optimizing trigger profiler ticks based on counting instead of timing weight back edges by jump distance for interrupt triggering percentage of ICs that must have type info to allow optimization watch_ic_patching retry_self_opt interrupt_at_exit extra verbose compilation tracing generate extra emit comments in code disassembly enable use of SSE3 instructions if available enable use of CMOV instruction if available enable use of SAHF instruction if enable use of VFP3 instructions if available this implies enabling ARMv7 and VFP2 enable use of VFP2 instructions if available enable use of SDIV and UDIV instructions if enable loading bit constant by means of movw movt instruction enable unaligned accesses for enable use of MIPS FPU instructions if NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d2e/flag-definitions_8h_source.html#l00300">flag-definitions.h:300</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_socket_html_a698c1c8e2b154d73e01f7a4100245234"><div class="ttname"><a href="../../d9/d18/classv8_1_1internal_1_1_socket.html#a698c1c8e2b154d73e01f7a4100245234">v8::internal::Socket::Bind</a></div><div class="ttdeci">virtual bool Bind(const int port)=0</div></div>
<div class="ttc" id="classv8_1_1_debug_html_addcd97a2e1d1c179915a2eca561a0a24"><div class="ttname"><a href="../../de/d13/classv8_1_1_debug.html#addcd97a2e1d1c179915a2eca561a0a24">v8::Debug::Call</a></div><div class="ttdeci">static Local&lt; Value &gt; Call(v8::Handle&lt; v8::Function &gt; fun, Handle&lt; Value &gt; data=Handle&lt; Value &gt;())</div></div>
<div class="ttc" id="namespacev8_html_a183d763ef2c91e406b7e4db184a126f1"><div class="ttname"><a href="../../d2/dc3/namespacev8.html#a183d763ef2c91e406b7e4db184a126f1">v8::Undefined</a></div><div class="ttdeci">Handle&lt; Primitive &gt; V8EXPORT Undefined()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l00549">api.cc:549</a></div></div>
<div class="ttc" id="classv8_1_1_number_html_a07973edb5d78ef02327a2bb493116b61"><div class="ttname"><a href="../../d9/d29/classv8_1_1_number.html#a07973edb5d78ef02327a2bb493116b61">v8::Number::New</a></div><div class="ttdeci">static V8EXPORT Local&lt; Number &gt; New(double value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l05215">api.cc:5215</a></div></div>
<div class="ttc" id="classv8_1_1_handle_html_aaef62c8761ddd1b95824fc57b1b277b5"><div class="ttname"><a href="../../d3/dd5/classv8_1_1_handle.html#aaef62c8761ddd1b95824fc57b1b277b5">v8::Handle::IsEmpty</a></div><div class="ttdeci">bool IsEmpty() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l00209">v8.h:209</a></div></div>
<div class="ttc" id="namespacev8_1_1internal_html_a7ff5a5c54f182b86d1cd993cf4512c87a65a864c610bdf664db1a858a3baa22d8"><div class="ttname"><a href="../../d4/d32/namespacev8_1_1internal.html#a7ff5a5c54f182b86d1cd993cf4512c87a65a864c610bdf664db1a858a3baa22d8">v8::internal::INTERCEPTOR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d43/property-details_8h_source.html#l00066">property-details.h:66</a></div></div>
<div class="ttc" id="classv8_1_1_script_html_ab937ef8dba07a7ef516f11ef83debf92"><div class="ttname"><a href="../../d0/d35/classv8_1_1_script.html#ab937ef8dba07a7ef516f11ef83debf92">v8::Script::Run</a></div><div class="ttdeci">Local&lt; Value &gt; Run()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l01598">api.cc:1598</a></div></div>
<div class="ttc" id="isolate_8h_html_aedf6a97db5aec9c5da4cb045ac40c2df"><div class="ttname"><a href="../../d8/d1e/isolate_8h.html#aedf6a97db5aec9c5da4cb045ac40c2df">FACTORY</a></div><div class="ttdeci">#define FACTORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d1e/isolate_8h_source.html#l01434">isolate.h:1434</a></div></div>
<div class="ttc" id="cctest_8h_html_aa336661b38c04ab56c34842870688872"><div class="ttname"><a href="../../df/d84/cctest_8h.html#aa336661b38c04ab56c34842870688872">TEST</a></div><div class="ttdeci">#define TEST(Name)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d84/cctest_8h_source.html#l00034">cctest.h:34</a></div></div>
<div class="ttc" id="namespacev8_1_1internal_html_a49435ced13267a613e1d5ba777466b64"><div class="ttname"><a href="../../d4/d32/namespacev8_1_1internal.html#a49435ced13267a613e1d5ba777466b64">v8::internal::NULL</a></div><div class="ttdeci">activate correct semantics for inheriting readonliness enable harmony semantics for typeof enable harmony enable harmony proxies enable all harmony harmony_scoping harmony_proxies harmony_scoping tracks arrays with only smi values automatically unbox arrays of doubles use crankshaft use hydrogen range analysis use hydrogen global value numbering use function inlining maximum number of AST nodes considered for a single inlining loop invariant code motion print statistics for hydrogen trace generated IR for specified phases trace register allocator trace range analysis trace representation types environment for every instruction put a break point before deoptimizing polymorphic inlining perform array bounds checks elimination use dead code elimination trace on stack replacement optimize closures cache optimized code for closures functions with arguments object loop weight for representation inference allow uint32 values on optimize frames if they are used only in safe operations track parallel recompilation enable all profiler experiments number of stack frames inspected by the profiler call recompile stub directly when self optimizing trigger profiler ticks based on counting instead of timing weight back edges by jump distance for interrupt triggering percentage of ICs that must have type info to allow optimization watch_ic_patching retry_self_opt interrupt_at_exit extra verbose compilation tracing generate extra emit comments in code disassembly enable use of SSE3 instructions if available enable use of CMOV instruction if available enable use of SAHF instruction if enable use of VFP3 instructions if available this implies enabling ARMv7 and VFP2 enable use of VFP2 instructions if available enable use of SDIV and UDIV instructions if enable loading bit constant by means of movw movt instruction enable unaligned accesses for enable use of MIPS FPU instructions if NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d54/flags_8cc_source.html#l00301">flags.cc:301</a></div></div>
<div class="ttc" id="classv8_1_1_context_html_a860f2fec28426ee65e5aec8cbcb43478"><div class="ttname"><a href="../../df/d69/classv8_1_1_context.html#a860f2fec28426ee65e5aec8cbcb43478">v8::Context::New</a></div><div class="ttdeci">static Persistent&lt; Context &gt; New(ExtensionConfiguration *extensions=NULL, Handle&lt; ObjectTemplate &gt; global_template=Handle&lt; ObjectTemplate &gt;(), Handle&lt; Value &gt; global_object=Handle&lt; Value &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l04411">api.cc:4411</a></div></div>
<div class="ttc" id="namespacev8_html_ac08707d61d5d7a69b2a5001ba10ed79ba7af8b3b962aadf798e813a27173fc4c3"><div class="ttname"><a href="../../d2/dc3/namespacev8.html#ac08707d61d5d7a69b2a5001ba10ed79ba7af8b3b962aadf798e813a27173fc4c3">v8::ScriptCollected</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/v8-debug_8h_source.html#l00079">v8-debug.h:79</a></div></div>
<div class="ttc" id="classv8_1_1_debug_1_1_event_details_html_ad4a63f4bd528bea4a669152a350a964f"><div class="ttname"><a href="../../d9/d73/classv8_1_1_debug_1_1_event_details.html#ad4a63f4bd528bea4a669152a350a964f">v8::Debug::EventDetails::GetEventContext</a></div><div class="ttdeci">virtual Handle&lt; Context &gt; GetEventContext() const =0</div></div>
<div class="ttc" id="classv8_1_1_debug_1_1_message_html_ad4a63f4bd528bea4a669152a350a964f"><div class="ttname"><a href="../../de/dbd/classv8_1_1_debug_1_1_message.html#ad4a63f4bd528bea4a669152a350a964f">v8::Debug::Message::GetEventContext</a></div><div class="ttdeci">virtual Handle&lt; Context &gt; GetEventContext() const =0</div></div>
<div class="ttc" id="classv8_1_1_extension_configuration_html"><div class="ttname"><a href="../../d2/d03/classv8_1_1_extension_configuration.html">v8::ExtensionConfiguration</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l03620">v8.h:3620</a></div></div>
<div class="ttc" id="classv8_1_1_debug_html_ae12666df328de1e1aa3fa79d6c1deeeb"><div class="ttname"><a href="../../de/d13/classv8_1_1_debug.html#ae12666df328de1e1aa3fa79d6c1deeeb">v8::Debug::SendCommand</a></div><div class="ttdeci">static void SendCommand(const uint16_t *command, int length, ClientData *client_data=NULL, Isolate *isolate=NULL)</div></div>
<div class="ttc" id="classv8_1_1_debug_html_a4bf76677c1d7cbf5081ee9ab49dc4d66"><div class="ttname"><a href="../../de/d13/classv8_1_1_debug.html#a4bf76677c1d7cbf5081ee9ab49dc4d66">v8::Debug::DebugBreak</a></div><div class="ttdeci">static void DebugBreak(Isolate *isolate=NULL)</div></div>
<div class="ttc" id="test-accessors_8cc_html_a2df8914184cddeed49ac0b633472d973"><div class="ttname"><a href="../../d6/df1/test-accessors_8cc.html#a2df8914184cddeed49ac0b633472d973">bar</a></div><div class="ttdeci">int bar</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/df1/test-accessors_8cc_source.html#l00085">test-accessors.cc:85</a></div></div>
<div class="ttc" id="classv8_1_1_string_html_a973aec0759c01b6fb411d7fca8300e6a"><div class="ttname"><a href="../../d2/db3/classv8_1_1_string.html#a973aec0759c01b6fb411d7fca8300e6a">v8::String::NewExternal</a></div><div class="ttdeci">static V8EXPORT Local&lt; String &gt; NewExternal(ExternalStringResource *resource)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l04871">api.cc:4871</a></div></div>
<div class="ttc" id="classv8_1_1_debug_html_a1e4ddeff91cf83b89ee2fb20af16f6b2"><div class="ttname"><a href="../../de/d13/classv8_1_1_debug.html#a1e4ddeff91cf83b89ee2fb20af16f6b2">v8::Debug::GetMirror</a></div><div class="ttdeci">static Local&lt; Value &gt; GetMirror(v8::Handle&lt; v8::Value &gt; obj)</div></div>
<div class="ttc" id="classv8_1_1internal_1_1_isolate_html"><div class="ttname"><a href="../../dd/d38/classv8_1_1internal_1_1_isolate.html">v8::internal::Isolate</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d1e/isolate_8h_source.html#l00359">isolate.h:359</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_socket_html_a88ccb24206b05493e679a2746d6e3557"><div class="ttname"><a href="../../d9/d18/classv8_1_1internal_1_1_socket.html#a88ccb24206b05493e679a2746d6e3557">v8::internal::Socket::SetUp</a></div><div class="ttdeci">static bool SetUp()</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d34/platform-posix_8cc_source.html#l00514">platform-posix.cc:514</a></div></div>
<div class="ttc" id="test-deoptimization_8cc_html_a9b3c273aec2361d19e0449b2a7515e75"><div class="ttname"><a href="../../de/dd6/test-deoptimization_8cc.html#a9b3c273aec2361d19e0449b2a7515e75">SMALL_STRING_BUFFER_SIZE</a></div><div class="ttdeci">#define SMALL_STRING_BUFFER_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dd6/test-deoptimization_8cc_source.html#l00050">test-deoptimization.cc:50</a></div></div>
<div class="ttc" id="class_local_context_html"><div class="ttname"><a href="../../d7/d05/class_local_context.html">LocalContext</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d84/cctest_8h_source.html#l00168">cctest.h:168</a></div></div>
<div class="ttc" id="globals_8h_html_a25f003de16c08a4888b69f619d70f427"><div class="ttname"><a href="../../d5/d87/globals_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a></div><div class="ttdeci">#define ARRAY_SIZE(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d87/globals_8h_source.html#l00281">globals.h:281</a></div></div>
<div class="ttc" id="classv8_1_1_debug_html_a5aaf984433cde031c9e8b8a3da1ed699"><div class="ttname"><a href="../../de/d13/classv8_1_1_debug.html#a5aaf984433cde031c9e8b8a3da1ed699">v8::Debug::ProcessDebugMessages</a></div><div class="ttdeci">static void ProcessDebugMessages()</div></div>
<div class="ttc" id="classv8_1_1_local_html"><div class="ttname"><a href="../../de/deb/classv8_1_1_local.html">v8::Local</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8f/include_2v8_8h_source.html#l00106">v8.h:106</a></div></div>
<div class="ttc" id="checks_8cc_html_ad384ae4907762693c3cffc9673d1f80a"><div class="ttname"><a href="../../d8/d29/checks_8cc.html#ad384ae4907762693c3cffc9673d1f80a">CheckNonEqualsHelper</a></div><div class="ttdeci">void CheckNonEqualsHelper(const char *file, int line, const char *unexpected_source, v8::Handle&lt; v8::Value &gt; unexpected, const char *value_source, v8::Handle&lt; v8::Value &gt; value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d29/checks_8cc_source.html#l00078">checks.cc:78</a></div></div>
<div class="ttc" id="namespacev8_1_1internal_html_a5e2ec2be00b3d617582f927ee37878f7a55bf024372af033e86eeb191711b47ca"><div class="ttname"><a href="../../d4/d32/namespacev8_1_1internal.html#a5e2ec2be00b3d617582f927ee37878f7a55bf024372af033e86eeb191711b47ca">v8::internal::NEW_SPACE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dce/v8globals_8h_source.html#l00175">v8globals.h:175</a></div></div>
<div class="ttc" id="classv8_1_1_v8_html_a248c764067ee60c03ee370784c49f353"><div class="ttname"><a href="../../df/d43/classv8_1_1_v8.html#a248c764067ee60c03ee370784c49f353">v8::V8::Initialize</a></div><div class="ttdeci">static bool Initialize()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l04269">api.cc:4269</a></div></div>
<div class="ttc" id="checks_8cc_html_a464402344571c67b7ad8c54387535aab"><div class="ttname"><a href="../../d8/d29/checks_8cc.html#a464402344571c67b7ad8c54387535aab">CheckEqualsHelper</a></div><div class="ttdeci">void CheckEqualsHelper(const char *file, int line, const char *expected_source, v8::Handle&lt; v8::Value &gt; expected, const char *value_source, v8::Handle&lt; v8::Value &gt; value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d29/checks_8cc_source.html#l00062">checks.cc:62</a></div></div>
<div class="ttc" id="classv8_1_1_object_html_aa5f1e3dc29693910853bcb6ae1d14f84"><div class="ttname"><a href="../../db/d85/classv8_1_1_object.html#aa5f1e3dc29693910853bcb6ae1d14f84">v8::Object::New</a></div><div class="ttdeci">static V8EXPORT Local&lt; Object &gt; New()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l04957">api.cc:4957</a></div></div>
<div class="ttc" id="test-heap_8cc_html_a80bf5e37a65269af89bd34d8c2d102ab"><div class="ttname"><a href="../../d0/dae/test-heap_8cc.html#a80bf5e37a65269af89bd34d8c2d102ab">CountNativeContexts</a></div><div class="ttdeci">int CountNativeContexts()</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dae/test-heap_8cc_source.html#l00994">test-heap.cc:994</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_o_s_html_ab8d98b5da29bb3d29c7bdb6f90f551a5"><div class="ttname"><a href="../../de/d32/classv8_1_1internal_1_1_o_s.html#ab8d98b5da29bb3d29c7bdb6f90f551a5">v8::internal::OS::CreateSocket</a></div><div class="ttdeci">static Socket * CreateSocket()</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d34/platform-posix_8cc_source.html#l00545">platform-posix.cc:545</a></div></div>
<div class="ttc" id="classv8_1_1_object_html_aa5e6d5c3ca70b2a1d52415eac4d528f2"><div class="ttname"><a href="../../db/d85/classv8_1_1_object.html#aa5e6d5c3ca70b2a1d52415eac4d528f2">v8::Object::Set</a></div><div class="ttdeci">V8EXPORT bool Set(Handle&lt; Value &gt; key, Handle&lt; Value &gt; value, PropertyAttribute attribs=None)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/api_8cc_source.html#l02765">api.cc:2765</a></div></div>
<div class="ttc" id="classv8_1_1internal_1_1_j_s_function_html_aadcf8f00ff5f932119b67a97c33762da"><div class="ttname"><a href="../../d0/d2c/classv8_1_1internal_1_1_j_s_function.html#aadcf8f00ff5f932119b67a97c33762da">v8::internal::JSFunction::cast</a></div><div class="ttdeci">static JSFunction * cast(Object *obj)</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_13e138d54eb8818da29c3992edef070a.html">test</a></li><li class="navelem"><a class="el" href="../../dir_1e3d32cea81d8a88a96d3906c4607e57.html">cctest</a></li><li class="navelem"><a class="el" href="../../dc/d8c/test-debug_8cc.html">test-debug.cc</a></li>
    <li class="footer">Generated on Sat Jun 7 2014 23:30:12 for v8 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
